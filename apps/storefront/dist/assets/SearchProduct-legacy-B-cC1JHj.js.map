{"version":3,"file":"SearchProduct-legacy-B-cC1JHj.js","sources":["../../src/pages/ShoppingListDetails/components/SearchProduct.tsx","../../src/pages/ShoppingListDetails/context/ShoppingListDetailsContext.tsx","../../../../node_modules/@mui/icons-material/UploadFile.js","../../src/pages/ShoppingListDetails/components/ChooseOptionsDialog.tsx","../../src/pages/ShoppingListDetails/components/ProductListDialog.tsx"],"sourcesContent":["import { ChangeEvent, KeyboardEvent, useState } from 'react';\nimport { useB3Lang } from '@b3/lang';\nimport SearchIcon from '@mui/icons-material/Search';\nimport { Box, InputAdornment, TextField, Typography } from '@mui/material';\n\nimport CustomButton from '@/components/button/CustomButton';\nimport B3Spin from '@/components/spin/B3Spin';\nimport { useBlockPendingAccountViewPrice } from '@/hooks';\nimport { searchB2BProducts, searchBcProducts } from '@/shared/service/b2b';\nimport { useAppSelector } from '@/store';\nimport { snackbar } from '@/utils';\nimport { calculateProductListPrice } from '@/utils/b3Product/b3Product';\nimport { conversionProductsList } from '@/utils/b3Product/shared/config';\n\nimport { ShoppingListProductItem } from '../../../types';\n\nimport ChooseOptionsDialog from './ChooseOptionsDialog';\nimport ProductListDialog from './ProductListDialog';\n\ninterface SearchProductProps {\n  updateList?: () => void;\n  addToList: (products: CustomFieldItems[]) => void;\n  searchDialogTitle?: string;\n  addButtonText?: string;\n  isB2BUser: boolean;\n  type?: string;\n}\n\nexport default function SearchProduct({\n  updateList = () => {},\n  addToList,\n  searchDialogTitle,\n  addButtonText,\n  isB2BUser,\n  type,\n}: SearchProductProps) {\n  const b3Lang = useB3Lang();\n  const companyInfoId = useAppSelector(({ company }) => company.companyInfo.id);\n  const customerGroupId = useAppSelector((state) => state.company.customer.customerGroupId);\n  const companyStatus = useAppSelector(({ company }) => company.companyInfo.status);\n  const salesRepCompanyId = useAppSelector(({ b2bFeatures }) => b2bFeatures.masqueradeCompany.id);\n  const companyId = companyInfoId || salesRepCompanyId;\n  const [isLoading, setIsLoading] = useState(false);\n  const [productListOpen, setProductListOpen] = useState(false);\n  const [isAdded, setIsAdded] = useState(false);\n  const [searchText, setSearchText] = useState('');\n  const [productList, setProductList] = useState<ShoppingListProductItem[]>([]);\n  const [chooseOptionsOpen, setChooseOptionsOpen] = useState(false);\n  const [optionsProduct, setOptionsProduct] = useState<ShoppingListProductItem>();\n\n  const [blockPendingAccountViewPrice] = useBlockPendingAccountViewPrice();\n\n  const handleSearchTextChange = (e: ChangeEvent<HTMLInputElement>) => {\n    setSearchText(e.target.value);\n  };\n\n  const searchProduct = async () => {\n    if (!searchText || isLoading) {\n      return;\n    }\n\n    if (blockPendingAccountViewPrice && companyStatus === 0) {\n      snackbar.info(b3Lang('global.searchProductAddProduct.businessAccountPendingApproval'));\n      return;\n    }\n    const getProducts = isB2BUser ? searchB2BProducts : searchBcProducts;\n\n    setIsLoading(true);\n    try {\n      const { productsSearch } = await getProducts({\n        search: searchText,\n        companyId,\n        customerGroupId,\n        categoryFilter: true,\n      });\n\n      const product = conversionProductsList(productsSearch);\n\n      setProductList(product);\n      setProductListOpen(true);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleSearchTextKeyDown = (e: KeyboardEvent) => {\n    if (e.key === 'Enter') {\n      searchProduct();\n    }\n  };\n\n  const handleSearchButtonClicked = () => {\n    searchProduct();\n  };\n\n  const clearProductInfo = () => {\n    setProductList([]);\n  };\n\n  const handleProductListDialogCancel = () => {\n    setChooseOptionsOpen(false);\n    setProductListOpen(false);\n\n    if (isAdded) {\n      setIsAdded(false);\n      updateList();\n    }\n\n    clearProductInfo();\n  };\n\n  const handleProductQuantityChange = (id: number, newQuantity: number) => {\n    const product = productList.find((product) => product.id === id);\n    if (product) {\n      product.quantity = newQuantity;\n    }\n\n    setProductList([...productList]);\n  };\n\n  const handleAddToListClick = async (products: CustomFieldItems[]) => {\n    try {\n      setIsLoading(true);\n      await calculateProductListPrice(products);\n      await addToList(products);\n\n      updateList();\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleProductListAddToList = async (products: CustomFieldItems[]) => {\n    await handleAddToListClick(products);\n  };\n\n  const handleChangeOptionsClick = (productId: number) => {\n    const product = productList.find((product) => product.id === productId);\n    if (product) {\n      setOptionsProduct({\n        ...product,\n      });\n    }\n    setProductListOpen(false);\n    setChooseOptionsOpen(true);\n  };\n\n  const handleChooseOptionsDialogCancel = () => {\n    setChooseOptionsOpen(false);\n    setProductListOpen(true);\n  };\n\n  const handleChooseOptionsDialogConfirm = async (products: CustomFieldItems[]) => {\n    try {\n      setIsLoading(true);\n      await calculateProductListPrice(products);\n      await handleAddToListClick(products);\n      setChooseOptionsOpen(false);\n      setProductListOpen(true);\n    } catch (error) {\n      setIsLoading(false);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <Box\n      sx={{\n        margin: '24px 0',\n      }}\n    >\n      <Typography>{b3Lang('global.searchProductAddProduct.searchBySkuOrName')}</Typography>\n      <TextField\n        hiddenLabel\n        placeholder={b3Lang(`global.searchProduct.placeholder.${type}`)}\n        variant=\"filled\"\n        fullWidth\n        size=\"small\"\n        value={searchText}\n        onChange={handleSearchTextChange}\n        onKeyDown={handleSearchTextKeyDown}\n        InputProps={{\n          startAdornment: (\n            <InputAdornment position=\"start\">\n              <SearchIcon sx={{w: '32px'}}/>\n            </InputAdornment>\n          ),\n        }}\n        sx={{\n          margin: '12px 0',\n          '& input': {\n            padding: '12px 12px 12px 0',\n          },\n        }}\n      />\n      <CustomButton\n        variant=\"outlined\"\n        fullWidth\n        disabled={isLoading}\n        onClick={handleSearchButtonClicked}\n      >\n        <B3Spin isSpinning={isLoading} tip=\"\" size={16}>\n          <Box\n            sx={{\n              flex: 1,\n              textAlign: 'center',\n            }}\n          >\n            {b3Lang('global.searchProductAddProduct.searchProduct')}\n          </Box>\n        </B3Spin>\n      </CustomButton>\n\n      <ProductListDialog\n        isOpen={productListOpen}\n        isLoading={isLoading}\n        productList={productList}\n        searchText={searchText}\n        type={type}\n        onSearchTextChange={handleSearchTextChange}\n        onSearch={handleSearchButtonClicked}\n        onCancel={handleProductListDialogCancel}\n        onProductQuantityChange={handleProductQuantityChange}\n        onChooseOptionsClick={handleChangeOptionsClick}\n        onAddToListClick={handleProductListAddToList}\n        searchDialogTitle={searchDialogTitle}\n        addButtonText={addButtonText}\n      />\n\n      <ChooseOptionsDialog\n        isOpen={chooseOptionsOpen}\n        isLoading={isLoading}\n        type={type}\n        setIsLoading={setIsLoading}\n        product={optionsProduct}\n        onCancel={handleChooseOptionsDialogCancel}\n        onConfirm={handleChooseOptionsDialogConfirm}\n        addButtonText={addButtonText}\n        isB2BUser={isB2BUser}\n      />\n    </Box>\n  );\n}\n","import { createContext, Dispatch, ReactNode, useMemo, useReducer } from 'react';\n\nexport interface ShoppingListDetailsState {\n  id?: number;\n  isLoading?: boolean;\n}\ninterface ShoppingListDetailsAction {\n  type: string;\n  payload: ShoppingListDetailsState;\n}\nexport interface ShoppingListDetailsContextType {\n  state: ShoppingListDetailsState;\n  dispatch: Dispatch<ShoppingListDetailsAction>;\n}\n\ninterface ShoppingListDetailsProviderProps {\n  children: ReactNode;\n}\n\nconst initState = {\n  id: 0,\n  isLoading: false,\n};\n\nexport const ShoppingListDetailsContext = createContext<ShoppingListDetailsContextType>({\n  state: initState,\n  dispatch: () => {},\n});\n\nconst reducer = (state: ShoppingListDetailsState, action: ShoppingListDetailsAction) => {\n  switch (action.type) {\n    case 'all':\n      return {\n        ...state,\n        ...action.payload,\n      };\n    case 'init':\n      return {\n        ...state,\n        id: action.payload.id,\n      };\n    case 'loading':\n      return {\n        ...state,\n        isLoading: action.payload.isLoading,\n      };\n    default:\n      return state;\n  }\n};\n\nexport function ShoppingListDetailsProvider(props: ShoppingListDetailsProviderProps) {\n  const [state, dispatch] = useReducer(reducer, initState);\n\n  const { children } = props;\n\n  const ShoppingListDetailsValue = useMemo(\n    () => ({\n      state,\n      dispatch,\n    }),\n    [state],\n  );\n\n  return (\n    <ShoppingListDetailsContext.Provider value={ShoppingListDetailsValue}>\n      {children}\n    </ShoppingListDetailsContext.Provider>\n  );\n}\n","\"use strict\";\n\"use client\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = exports.default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm4 18H6V4h7v5h5zM8 15.01l1.41 1.41L11 14.84V19h2v-4.16l1.59 1.59L16 15.01 12.01 11z\"\n}), 'UploadFile');","import {\n  ChangeEvent,\n  Dispatch,\n  KeyboardEvent,\n  SetStateAction,\n  useCallback,\n  useEffect,\n  useRef,\n  useState,\n} from 'react';\nimport { FieldValues, useForm } from 'react-hook-form';\nimport { useB3Lang } from '@b3/lang';\nimport styled from '@emotion/styled';\nimport { Box, Divider, TextField, Typography } from '@mui/material';\nimport isEqual from 'lodash-es/isEqual';\n\nimport { B3CustomForm } from '@/components';\nimport B3Dialog from '@/components/B3Dialog';\nimport B3Spin from '@/components/spin/B3Spin';\nimport { PRODUCT_DEFAULT_IMAGE } from '@/constants';\nimport { searchB2BProducts, searchBcProducts } from '@/shared/service/b2b';\nimport { useAppSelector } from '@/store';\nimport { currencyFormat, snackbar } from '@/utils';\nimport b2bLogger from '@/utils/b3Logger';\nimport {\n  calculateProductListPrice,\n  getBCPrice,\n  getProductInfoDisplayPrice,\n  getVariantInfoDisplayPrice,\n} from '@/utils/b3Product/b3Product';\n\nimport { AllOptionProps, ShoppingListProductItem, SimpleObject, Variant } from '../../../types';\nimport {\n  Base64,\n  getOptionRequestData,\n  getProductOptionsFields,\n} from '../../../utils/b3Product/shared/config';\n\nconst Flex = styled('div')({\n  display: 'flex',\n  wordBreak: 'break-word',\n  gap: '8px',\n  flexWrap: 'wrap',\n  padding: '12px 0 12px',\n  '&:first-of-type': {\n    marginTop: '12px',\n  },\n});\n\ninterface FlexItemProps {\n  padding?: string;\n}\n\nconst FlexItem = styled('div')(({ padding }: FlexItemProps) => ({\n  display: 'flex',\n  flexGrow: 1,\n  flexShrink: 1,\n  alignItems: 'flex-start',\n  width: '100%',\n  padding: padding || '0 0 0 16px',\n}));\n\nconst ProductImage = styled('img')(() => ({\n  width: '60px',\n  height: '60px',\n  borderRadius: '4px',\n  marginTop: '12px',\n  flexShrink: 0,\n}));\n\nconst ProductOptionText = styled('div')(() => ({\n  fontSize: '0.75rem',\n  lineHeight: '1.5',\n  color: '#455A64',\n}));\n\nconst StyleTextField = styled(TextField)(() => ({\n  '& input::-webkit-outer-spin-button, input::-webkit-inner-spin-button': {\n    marginTop: '-8px',\n    marginBottom: '8px',\n  },\n}));\n\ninterface ChooseOptionsDialogProps {\n  isOpen: boolean;\n  product?: ShoppingListProductItem;\n  onCancel: () => void;\n  onConfirm: (products: CustomFieldItems[]) => void;\n  isEdit?: boolean;\n  isLoading: boolean;\n  setIsLoading: Dispatch<SetStateAction<boolean>>;\n  addButtonText?: string;\n  isB2BUser: boolean;\n  type?: string;\n}\n\ninterface ChooseOptionsProductProps extends ShoppingListProductItem {\n  newSelectOptionList: {\n    optionId: string;\n    optionValue: any;\n  }[];\n  productId: number;\n  quantity: number;\n  variantId: number;\n  additionalProducts: CustomFieldItems;\n}\n\nexport default function ChooseOptionsDialog(props: ChooseOptionsDialogProps) {\n  const {\n    isOpen,\n    onCancel,\n    onConfirm,\n    product,\n    isEdit = false,\n    isLoading,\n    setIsLoading,\n    isB2BUser,\n    type,\n    ...restProps\n  } = props;\n\n  const b3Lang = useB3Lang();\n  const { addButtonText = b3Lang('shoppingList.chooseOptionsDialog.addToList') } = restProps;\n\n  const showInclusiveTaxPrice = useAppSelector(({ global }) => global.showInclusiveTaxPrice);\n  const isEnableProduct = useAppSelector(\n    ({ global }) => global.blockPendingQuoteNonPurchasableOOS.isEnableProduct,\n  );\n  const salesRepCompanyId = useAppSelector(({ b2bFeatures }) => b2bFeatures.masqueradeCompany.id);\n  const customerGroupId = useAppSelector((state) => state.company.customer.customerGroupId);\n  const companyInfoId = useAppSelector((state) => state.company.companyInfo.id);\n  const [quantity, setQuantity] = useState<number | string>(1);\n  const [formFields, setFormFields] = useState<CustomFieldItems[]>([]);\n  const [variantInfo, setVariantInfo] = useState<Partial<Variant> | null>(null);\n  const [variantSku, setVariantSku] = useState('');\n  const [currentImage, setCurrentImage] = useState<string>(product?.imageUrl || '');\n  const [isShowPrice, setShowPrice] = useState<boolean>(true);\n  const [additionalProducts, setAdditionalProducts] = useState<CustomFieldItems>({});\n  const [productPriceChangeOptions, setProductPriceChangeOptions] = useState<\n    Partial<AllOptionProps>[]\n  >([]);\n  const [newPrice, setNewPrice] = useState<number>(0);\n  const [chooseOptionsProduct, setChooseOptionsProduct] = useState<ChooseOptionsProductProps[]>([]);\n  const [isRequestLoading, setIsRequestLoading] = useState<boolean>(false);\n\n  useEffect(() => {\n    if (type === 'quote' && product) {\n      if (variantSku) {\n        const newProduct = product as CustomFieldItems;\n        newProduct.quantity = quantity;\n        const isPrice = !!getVariantInfoDisplayPrice(newProduct.base_price, newProduct, {\n          sku: variantSku,\n        });\n        setShowPrice(isPrice);\n      } else {\n        const newProduct = product as CustomFieldItems;\n        newProduct.quantity = quantity;\n        const isPrice = !!getProductInfoDisplayPrice(newProduct.base_price, newProduct);\n        if (!isPrice) {\n          setShowPrice(false);\n        }\n      }\n    } else if ((type === 'shoppingList' || type === 'quickOrder') && product) {\n      setShowPrice(!product?.isPriceHidden);\n    }\n  }, [variantSku, quantity, product, type]);\n\n  const setChooseOptionsForm = async (product: ShoppingListProductItem) => {\n    try {\n      setIsLoading(true);\n\n      const modifiers =\n        product?.modifiers?.filter(\n          (modifier) =>\n            modifier.type === 'product_list_with_images' || modifier.type === 'product_list',\n        ) || [];\n      const productImages: SimpleObject = {};\n      const additionalProductsParams: CustomFieldItems = {};\n      if (modifiers.length > 0) {\n        const productIds = modifiers.reduce((arr: number[], modifier) => {\n          const { option_values: optionValues } = modifier;\n          optionValues.forEach((option) => {\n            if (option?.value_data?.product_id) {\n              arr.push(option.value_data.product_id);\n            }\n          });\n          return arr;\n        }, []);\n\n        if (productIds.length > 0) {\n          const getProducts = isB2BUser ? searchB2BProducts : searchBcProducts;\n\n          const companyId = companyInfoId || salesRepCompanyId;\n          const { productsSearch } = await getProducts({\n            productIds,\n            companyId,\n            customerGroupId,\n          });\n\n          productsSearch.forEach((product: CustomFieldItems) => {\n            productImages[product.id] = product.imageUrl;\n            additionalProductsParams[product.id] = product;\n          });\n        }\n      }\n\n      setAdditionalProducts(additionalProductsParams);\n\n      setQuantity(product.quantity);\n      if (product.variants?.length === 1 && product.variants[0]) {\n        setVariantInfo(product.variants[0]);\n      }\n\n      const productOptionsFields = getProductOptionsFields(product, productImages);\n      setFormFields([...productOptionsFields]);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const getProductPriceOptions = (product: ShoppingListProductItem) => {\n    const newProductPriceChangeOptionLists: Partial<AllOptionProps>[] = [];\n    product.allOptions?.forEach((item) => {\n      if (\n        item.type === 'product_list_with_images' ||\n        item.type === 'product_list' ||\n        item.type === 'checkbox' ||\n        item.type === 'rectangles' ||\n        item.type === 'swatch' ||\n        item.type === 'radio_buttons' ||\n        item.type === 'dropdown'\n      ) {\n        newProductPriceChangeOptionLists.push(item);\n      }\n    });\n\n    setProductPriceChangeOptions(newProductPriceChangeOptionLists);\n  };\n\n  useEffect(() => {\n    if (product) {\n      setChooseOptionsForm(product);\n      setChooseOptionsProduct([]);\n      setNewPrice(0);\n      if (product?.allOptions?.length) {\n        getProductPriceOptions(product);\n      }\n    } else {\n      setQuantity(1);\n      setFormFields([]);\n    }\n    // disabling as we don't need dispatchers here\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [product]);\n\n  const getProductPrice = (product: ShoppingListProductItem) => {\n    const { variants = [] } = product;\n\n    let priceNumber = 0;\n    if (variantSku) {\n      const variantCalculatePrice = variants.find(\n        (variant) => variant.sku === variantSku,\n      )?.bc_calculated_price;\n      priceNumber =\n        (showInclusiveTaxPrice\n          ? variantCalculatePrice?.tax_inclusive\n          : variantCalculatePrice?.tax_exclusive) || 0;\n    } else {\n      const variantCalculatePrice = variants[0]?.bc_calculated_price;\n      priceNumber =\n        parseFloat(\n          (showInclusiveTaxPrice\n            ? variantCalculatePrice?.tax_inclusive\n            : variantCalculatePrice?.tax_exclusive\n          )?.toString(),\n        ) || 0;\n    }\n\n    return priceNumber;\n  };\n\n  const handleProductQuantityChange = (e: ChangeEvent<HTMLInputElement>) => {\n    if (!e.target.value || parseInt(e.target.value, 10) > 0) {\n      setQuantity(e.target.value);\n    }\n  };\n\n  const handleNumberInputKeyDown = (event: KeyboardEvent<HTMLInputElement>) => {\n    if (['KeyE', 'Equal', 'Minus'].indexOf(event.code) > -1) {\n      event.preventDefault();\n    }\n  };\n\n  const handleNumberInputBlur = () => {\n    if (!quantity) {\n      setQuantity(1);\n    }\n\n    if (Number(quantity) > 1000000) {\n      setQuantity(1000000);\n    }\n  };\n\n  const {\n    control,\n    handleSubmit,\n    getValues,\n    formState: { errors },\n    watch,\n    setValue,\n    reset,\n  } = useForm({\n    mode: 'all',\n  });\n\n  const formValues = watch();\n  const cache = useRef(formValues);\n\n  const getProductVariantId = useCallback(\n    async (value: CustomFieldItems, changeName = '') => {\n      const isVariantOptionChange =\n        formFields.find((item: CustomFieldItems) => item.name === changeName)?.isVariantOption ||\n        false;\n\n      if (!isVariantOptionChange || !product || !changeName) {\n        return;\n      }\n\n      const { variants = [] } = product || {};\n\n      const variantInfo =\n        variants.find((variant) => {\n          const { option_values: optionValues = [] } = variant;\n\n          const isSelectVariant = optionValues.reduce((isSelect, option) => {\n            if (\n              value[Base64.encode(`attribute[${option.option_id}]`)].toString() !==\n              (option.id || '').toString()\n            ) {\n              return false;\n            }\n            return isSelect;\n          }, true);\n\n          return isSelectVariant;\n        }) || null;\n\n      setVariantSku(variantInfo ? variantInfo.sku : '');\n      setVariantInfo(variantInfo);\n\n      if (variantInfo && (variantInfo.sku || variantInfo.variant_id)) {\n        const currentVariant = variants.find(\n          (variant) =>\n            variant.sku === variantInfo.sku || variant.variant_id === variantInfo.variant_id,\n        );\n\n        setCurrentImage(currentVariant?.image_url || product.imageUrl || '');\n      }\n    },\n    [formFields, product],\n  );\n\n  useEffect(() => {\n    const subscription = watch((value, { name }) => {\n      getProductVariantId(value, name);\n    });\n\n    if (formFields[0]) {\n      const defaultValues: SimpleObject = formFields.reduce((value: SimpleObject, fields) => {\n        const formFieldValue = value;\n        formFieldValue[fields.name] = fields.default;\n        setValue(fields.name, fields.default);\n        return value;\n      }, {});\n      getProductVariantId(defaultValues, formFields[0].name);\n    }\n\n    return () => subscription.unsubscribe();\n    // disabling as we don't need dispatchers or subscribers in the dep array\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [formFields, getProductVariantId]);\n\n  const validateQuantityNumber = useCallback(() => {\n    const { purchasing_disabled: purchasingDisabled = true } = variantInfo || {};\n\n    if (type !== 'shoppingList' && purchasingDisabled === true && !isEnableProduct) {\n      snackbar.error(b3Lang('shoppingList.chooseOptionsDialog.productNoLongerForSale'));\n      return false;\n    }\n\n    return true;\n    // disabling as b3Lang will render errors\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isEnableProduct, type, variantInfo]);\n\n  const getOptionList = useCallback(\n    (value: FieldValues) => {\n      const optionsData = getOptionRequestData(formFields, {}, value);\n      return Object.keys(optionsData).map((optionId) => ({\n        optionId,\n        optionValue: optionsData[optionId]?.toString(),\n      }));\n    },\n    [formFields],\n  );\n\n  useEffect(() => {\n    if (cache?.current && isEqual(cache?.current, formValues)) {\n      return;\n    }\n\n    cache.current = formValues;\n    if (Object.keys(formValues).length && formFields.length && productPriceChangeOptions.length) {\n      const optionList = getOptionList(formValues);\n      const { variant_id: variantId = '' } = variantInfo || {};\n      if (!product || !product.id || !variantId || !validateQuantityNumber()) {\n        return;\n      }\n\n      const newChooseOptionsProduct = [\n        {\n          ...product,\n          newSelectOptionList: optionList,\n          productId: product?.id,\n          quantity: parseInt(quantity.toString(), 10) || 1,\n          variantId: parseInt(variantId.toString(), 10) || 1,\n          additionalProducts,\n        },\n      ];\n\n      if (chooseOptionsProduct[0]) {\n        let optionChangeFlag = false;\n        const { newSelectOptionList } = chooseOptionsProduct[0];\n        newSelectOptionList.forEach((option) => {\n          const findAttributeId = productPriceChangeOptions.findIndex((item) =>\n            option.optionId.includes(String(item.id)),\n          );\n          optionList.forEach((newOption) => {\n            if (\n              option.optionId === newOption.optionId &&\n              option.optionValue !== newOption.optionValue &&\n              findAttributeId !== -1\n            ) {\n              optionChangeFlag = true;\n            }\n          });\n        });\n        if (optionChangeFlag) {\n          setChooseOptionsProduct(newChooseOptionsProduct);\n        }\n      } else {\n        setChooseOptionsProduct(newChooseOptionsProduct);\n      }\n    }\n  }, [\n    additionalProducts,\n    chooseOptionsProduct,\n    formFields.length,\n    formValues,\n    getOptionList,\n    product,\n    productPriceChangeOptions,\n    quantity,\n    validateQuantityNumber,\n    variantInfo,\n  ]);\n\n  useEffect(() => {\n    const getNewProductPrice = async () => {\n      try {\n        if (chooseOptionsProduct.length) {\n          setIsRequestLoading(true);\n          const products = await calculateProductListPrice(chooseOptionsProduct);\n\n          if (products[0]) {\n            const { basePrice, taxPrice } = products[0];\n            const price = getBCPrice(Number(basePrice), Number(taxPrice));\n            setNewPrice(price);\n          }\n        }\n      } catch (err) {\n        b2bLogger.error(err);\n      } finally {\n        setIsRequestLoading(false);\n      }\n    };\n\n    getNewProductPrice();\n  }, [chooseOptionsProduct]);\n\n  const handleConfirmClicked = () => {\n    handleSubmit((value) => {\n      const optionList = getOptionList(value);\n\n      const { variant_id: variantId = '' } = variantInfo || {};\n\n      if (!product || !product.id || !variantId || !validateQuantityNumber()) {\n        return;\n      }\n\n      onConfirm([\n        {\n          ...product,\n          newSelectOptionList: optionList,\n          productId: product?.id,\n          quantity: parseInt(quantity.toString(), 10) || 1,\n          variantId: parseInt(variantId.toString(), 10) || 1,\n          additionalProducts,\n        },\n      ]);\n    })();\n  };\n\n  const handleCancelClicked = () => {\n    setQuantity(1);\n    onCancel();\n  };\n\n  useEffect(() => {\n    if (!isOpen) {\n      reset();\n    }\n    // disabling as reset does not change between renders\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [isOpen]);\n\n  return (\n    <B3Dialog\n      isOpen={isOpen}\n      rightSizeBtn={isEdit ? b3Lang('shoppingList.chooseOptionsDialog.saveOption') : addButtonText}\n      handleLeftClick={handleCancelClicked}\n      handRightClick={handleConfirmClicked}\n      title={b3Lang('shoppingList.chooseOptionsDialog.chooseOptions')}\n      loading={isLoading || isRequestLoading}\n    >\n      <B3Spin isSpinning={isLoading}>\n        {product && (\n          <Box>\n            <Box\n              sx={{\n                display: 'flex',\n                flexDirection: 'column',\n              }}\n            >\n              <Box\n                sx={{\n                  display: 'flex',\n                }}\n              >\n                <ProductImage src={currentImage || product.imageUrl || PRODUCT_DEFAULT_IMAGE} />\n                <Flex>\n                  <FlexItem padding=\"0\">\n                    <Box\n                      sx={{\n                        marginLeft: '16px',\n                      }}\n                    >\n                      <Typography variant=\"body1\" color=\"#212121\">\n                        {product.name}\n                      </Typography>\n                      <Typography variant=\"body1\" color=\"#616161\">\n                        {variantSku || product.sku}\n                      </Typography>\n                      {(product.product_options || []).map((option) => (\n                        <ProductOptionText\n                          key={`${option.option_id}`}\n                        >{`${option.display_name}: ${option.display_value}`}</ProductOptionText>\n                      ))}\n                    </Box>\n                  </FlexItem>\n\n                  <FlexItem>\n                    <span>{b3Lang('shoppingList.chooseOptionsDialog.price')}</span>\n                    {!isShowPrice\n                      ? ''\n                      : currencyFormat(newPrice * Number(quantity) || getProductPrice(product))}\n                  </FlexItem>\n\n                  <FlexItem>\n                    <StyleTextField\n                      type=\"number\"\n                      variant=\"filled\"\n                      label={b3Lang('shoppingList.chooseOptionsDialog.quantity')}\n                      value={quantity}\n                      onChange={handleProductQuantityChange}\n                      onKeyDown={handleNumberInputKeyDown}\n                      onBlur={handleNumberInputBlur}\n                      size=\"small\"\n                      sx={{\n                        width: '60%',\n                        maxWidth: '100px',\n                      }}\n                    />\n                  </FlexItem>\n                </Flex>\n              </Box>\n\n              <Divider\n                sx={{\n                  margin: '16px 0 24px',\n                }}\n              />\n\n              <B3CustomForm\n                formFields={formFields}\n                errors={errors}\n                control={control}\n                getValues={getValues}\n                setValue={setValue}\n              />\n            </Box>\n          </Box>\n        )}\n      </B3Spin>\n    </B3Dialog>\n  );\n}\n","import { ChangeEvent, KeyboardEvent, useCallback, useContext } from 'react';\nimport { useB3Lang } from '@b3/lang';\nimport SearchIcon from '@mui/icons-material/Search';\nimport { Box, InputAdornment, TextField, Typography } from '@mui/material';\n\nimport { B3ProductList } from '@/components';\nimport B3Dialog from '@/components/B3Dialog';\nimport CustomButton from '@/components/button/CustomButton';\nimport B3Spin from '@/components/spin/B3Spin';\nimport { useMobile } from '@/hooks';\nimport { useAppSelector } from '@/store';\nimport { snackbar } from '@/utils';\n\nimport { ShoppingListProductItem } from '../../../types';\nimport { ShoppingListDetailsContext } from '../context/ShoppingListDetailsContext';\n\ninterface ProductTableActionProps {\n  product: ShoppingListProductItem;\n  onAddToListClick: (id: number) => void;\n  onChooseOptionsClick: (id: number) => void;\n  addButtonText: string;\n}\n\nfunction ProductTableAction(props: ProductTableActionProps) {\n  const {\n    product: { id, allOptions: productOptions },\n    onAddToListClick,\n    onChooseOptionsClick,\n    addButtonText,\n  } = props;\n\n  const {\n    state: { isLoading = false },\n  } = useContext(ShoppingListDetailsContext);\n\n  const [isMobile] = useMobile();\n\n  const b3Lang = useB3Lang();\n\n  return productOptions && productOptions.length > 0 ? (\n    <CustomButton\n      variant=\"outlined\"\n      onClick={() => {\n        onChooseOptionsClick(id);\n      }}\n      disabled={isLoading}\n      fullWidth={isMobile}\n    >\n      {b3Lang('global.searchProduct.chooseOptionsButton')}\n    </CustomButton>\n  ) : (\n    <CustomButton\n      variant=\"outlined\"\n      onClick={() => {\n        onAddToListClick(id);\n      }}\n      disabled={isLoading}\n      fullWidth={isMobile}\n    >\n      {addButtonText}\n    </CustomButton>\n  );\n}\n\ninterface ProductListDialogProps {\n  isOpen: boolean;\n  searchText: string;\n  productList: ShoppingListProductItem[];\n  onCancel: () => void;\n  onSearchTextChange: (e: ChangeEvent<HTMLInputElement>) => void;\n  onSearch: () => void;\n  onProductQuantityChange: (id: number, newQuantity: number) => void;\n  onAddToListClick: (products: CustomFieldItems[]) => void;\n  onChooseOptionsClick: (id: number) => void;\n  isLoading: boolean;\n  searchDialogTitle?: string;\n  addButtonText?: string;\n  type?: string;\n}\n\nconst ProductTable = B3ProductList<ShoppingListProductItem>;\n\nexport default function ProductListDialog(props: ProductListDialogProps) {\n  const b3Lang = useB3Lang();\n  const {\n    isOpen,\n    onCancel,\n    searchText,\n    productList,\n    onSearchTextChange,\n    onSearch,\n    onProductQuantityChange,\n    onAddToListClick,\n    onChooseOptionsClick,\n    isLoading,\n    type,\n    searchDialogTitle = b3Lang('shoppingLists.title'),\n    addButtonText = b3Lang('shoppingLists.addButtonText'),\n  } = props;\n\n  const isEnableProduct = useAppSelector(\n    ({ global }) => global.blockPendingQuoteNonPurchasableOOS.isEnableProduct,\n  );\n\n  const [isMobile] = useMobile();\n\n  const handleCancelClicked = () => {\n    onCancel();\n  };\n\n  const handleSearchKeyDown = (e: KeyboardEvent) => {\n    if (e.key === 'Enter') {\n      onSearch();\n    }\n  };\n\n  const validateQuantityNumber = useCallback(\n    (product: ShoppingListProductItem) => {\n      const { variants = [] } = product || {};\n      const { purchasing_disabled: purchasingDisabled = true } = variants[0] || {};\n\n      if (type !== 'shoppingList' && purchasingDisabled === true && !isEnableProduct) {\n        snackbar.error(b3Lang('shoppingList.chooseOptionsDialog.productNoLongerForSale'));\n        return false;\n      }\n\n      return true;\n    },\n    // ignore b3Lang it's not reactive\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [isEnableProduct, type],\n  );\n\n  const handleAddToList = (id: number) => {\n    const product = productList.find((product) => product.id === id);\n\n    if (product && validateQuantityNumber(product || {})) {\n      let variantId: number | string = product.variantId || 0;\n\n      if (!product.variantId && product.variants?.[0]) {\n        variantId = product.variants[0].variant_id;\n      }\n\n      onAddToListClick([\n        {\n          ...product,\n          newSelectOptionList: [],\n          quantity: parseInt(product.quantity.toString(), 10) || 1,\n          variantId,\n        },\n      ]);\n    }\n  };\n\n  return (\n    <B3Dialog\n      fullWidth\n      isOpen={isOpen}\n      handleLeftClick={handleCancelClicked}\n      title={searchDialogTitle}\n      showRightBtn={false}\n      loading={isLoading}\n      maxWidth=\"md\"\n      leftSizeBtn={b3Lang('shoppingLists.close')}\n    >\n      <B3Spin isSpinning={isLoading}>\n        <Box\n          sx={{\n            minWidth: isMobile ? 'initial' : '100%',\n            flex: 1,\n          }}\n        >\n          <TextField\n            hiddenLabel\n            variant=\"filled\"\n            fullWidth\n            size=\"small\"\n            value={searchText}\n            onChange={onSearchTextChange}\n            onKeyDown={handleSearchKeyDown}\n            error={!productList || productList.length <= 0}\n            InputProps={{\n              startAdornment: (\n                <InputAdornment position=\"start\">\n                  <SearchIcon />\n                </InputAdornment>\n              ),\n            }}\n            sx={{\n              margin: '12px 0',\n              '& input': {\n                padding: '12px 12px 12px 0',\n              },\n            }}\n          />\n\n          {productList && productList.length > 0 ? (\n            <ProductTable\n              products={productList}\n              quantityEditable\n              type={type}\n              textAlign={isMobile ? 'left' : 'right'}\n              canToProduct\n              onProductQuantityChange={onProductQuantityChange}\n              renderAction={(product) => (\n                <ProductTableAction\n                  product={product}\n                  onAddToListClick={handleAddToList}\n                  onChooseOptionsClick={onChooseOptionsClick}\n                  addButtonText={addButtonText}\n                />\n              )}\n              actionWidth=\"180px\"\n            />\n          ) : (\n            <Typography>No products found</Typography>\n          )}\n        </Box>\n      </B3Spin>\n    </B3Dialog>\n  );\n}\n"],"names":["updateList","addToList","searchDialogTitle","addButtonText","isB2BUser","type","b3Lang","useB3Lang","companyInfoId","useAppSelector","company","companyInfo","id","customerGroupId","state","customer","companyStatus","status","salesRepCompanyId","b2bFeatures","masqueradeCompany","companyId","isLoading","setIsLoading","useState","productListOpen","setProductListOpen","isAdded","setIsAdded","searchText","setSearchText","productList","setProductList","chooseOptionsOpen","setChooseOptionsOpen","optionsProduct","setOptionsProduct","blockPendingAccountViewPrice","useBlockPendingAccountViewPrice","handleSearchTextChange","e","target","value","searchProduct","async","snackbar","info","getProducts","searchB2BProducts","searchBcProducts","productsSearch","search","categoryFilter","product","conversionProductsList","handleSearchButtonClicked","handleAddToListClick","calculateProductListPrice","products","jsxs","Box","sx","margin","children","jsx","Typography","TextField","hiddenLabel","placeholder","variant","fullWidth","size","onChange","onKeyDown","key","InputProps","startAdornment","InputAdornment","position","SearchIcon","w","padding","CustomButton","disabled","onClick","B3Spin","isSpinning","tip","flex","textAlign","ProductListDialog","isOpen","onSearchTextChange","onSearch","onCancel","handleProductListDialogCancel","onProductQuantityChange","handleProductQuantityChange","newQuantity","find","quantity","onChooseOptionsClick","productId","onAddToListClick","ChooseOptionsDialog","handleChooseOptionsDialogCancel","onConfirm","error","props","dispatch","useReducer","reducer","initState","ShoppingListDetailsValue","useMemo","ShoppingListDetailsContext","Provider","_interopRequireDefault","require$$0","Object","defineProperty","UploadFile","exports","default","_createSvgIcon","require$$1","_jsxRuntime","require$$2","d","Flex","styled","display","wordBreak","gap","flexWrap","marginTop","FlexItem","flexGrow","flexShrink","alignItems","width","ProductImage","height","borderRadius","ProductOptionText","fontSize","lineHeight","color","StyleTextField","marginBottom","isEdit","restProps","showInclusiveTaxPrice","global","isEnableProduct","blockPendingQuoteNonPurchasableOOS","setQuantity","formFields","setFormFields","variantInfo","setVariantInfo","variantSku","setVariantSku","currentImage","setCurrentImage","imageUrl","isShowPrice","setShowPrice","additionalProducts","setAdditionalProducts","productPriceChangeOptions","setProductPriceChangeOptions","newPrice","setNewPrice","chooseOptionsProduct","setChooseOptionsProduct","isRequestLoading","setIsRequestLoading","useEffect","newProduct","isPrice","getVariantInfoDisplayPrice","base_price","sku","getProductInfoDisplayPrice","isPriceHidden","modifiers","filter","modifier","productImages","additionalProductsParams","length","productIds","reduce","arr","option_values","optionValues","forEach","option","value_data","product_id","push","variants","productOptionsFields","getProductOptionsFields","setChooseOptionsForm","allOptions","newProductPriceChangeOptionLists","item","getProductPriceOptions","control","handleSubmit","getValues","formState","errors","watch","setValue","reset","useForm","mode","formValues","cache","useRef","getProductVariantId","useCallback","changeName","name","isVariantOption","isSelect","Base64","encode","option_id","toString","variant_id","currentVariant","image_url","subscription","defaultValues","fields","unsubscribe","validateQuantityNumber","purchasing_disabled","purchasingDisabled","getOptionList","optionsData","getOptionRequestData","keys","map","optionId","optionValue","current","isEqual","optionList","variantId","newChooseOptionsProduct","newSelectOptionList","parseInt","optionChangeFlag","findAttributeId","findIndex","includes","String","newOption","basePrice","taxPrice","price","getBCPrice","Number","err","b2bLogger","getNewProductPrice","B3Dialog","rightSizeBtn","handleLeftClick","handleCancelClicked","handRightClick","handleConfirmClicked","title","loading","flexDirection","src","PRODUCT_DEFAULT_IMAGE","marginLeft","product_options","display_name","display_value","currencyFormat","priceNumber","variantCalculatePrice","bc_calculated_price","tax_inclusive","tax_exclusive","parseFloat","getProductPrice","label","event","indexOf","code","preventDefault","onBlur","handleNumberInputBlur","maxWidth","Divider","B3CustomForm","createContext","action","payload","ProductTableAction","productOptions","useContext","isMobile","useMobile","ProductTable","B3ProductList","handleAddToList","showRightBtn","leftSizeBtn","minWidth","quantityEditable","canToProduct","renderAction","actionWidth"],"mappings":"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","x_google_ignoreList":[2]}