{"version":3,"file":"index-BgzfJKBs.js","sources":["../../src/pages/InvoicePayment/index.tsx"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { useB3Lang } from '@b3/lang';\nimport { Box } from '@mui/material';\n\nimport { Loading } from '@/components';\nimport B3Dialog from '@/components/B3Dialog';\nimport { getInvoiceDetail } from '@/shared/service/b2b';\nimport { useAppSelector } from '@/store';\nimport { snackbar } from '@/utils';\n\nimport { gotoInvoiceCheckoutUrl } from '../Invoice/utils/payment';\n\nfunction Payment() {\n  const platform = useAppSelector(({ global }) => global.storeInfo.platform);\n  const B2BToken = useAppSelector(({ company }) => company.tokens.B2BToken);\n\n  const [loading, setLoading] = useState<boolean>(false);\n\n  const [open, setOpen] = useState<boolean>(false);\n\n  const params = useParams();\n\n  const navigate = useNavigate();\n\n  const b3Lang = useB3Lang();\n\n  useEffect(() => {\n    const init = async () => {\n      setLoading(true);\n\n      if (!B2BToken) {\n        setOpen(true);\n        setLoading(false);\n        return;\n      }\n\n      if (!params?.id) {\n        snackbar.error(b3Lang('payment.errorInvoiceCantBeBlank'));\n      }\n\n      if (params?.id) {\n        try {\n          const {\n            invoice: {\n              openBalance: { code = '', value = '' },\n            },\n          } = await getInvoiceDetail(Number(params.id));\n\n          if (!code || !value) {\n            snackbar.error(b3Lang('payment.errorOpenBalanceIsIncorrect'));\n          }\n\n          const data = {\n            lineItems: [\n              {\n                invoiceId: Number(params.id),\n                amount: value,\n              },\n            ],\n            currency: code,\n          };\n\n          await gotoInvoiceCheckoutUrl(data, platform, true);\n        } catch (error: unknown) {\n          snackbar.error(\n            (error as CustomFieldItems)?.message || b3Lang('payment.invoiceDoesNotExist'),\n          );\n        } finally {\n          setLoading(false);\n        }\n      }\n    };\n\n    init();\n    // disabling b3Lang due to rendering issues within b3Lang\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [platform, params.id]);\n\n  const handleConfirm = () => {\n    navigate('/login');\n  };\n\n  return (\n    <Box>\n      {loading && <Loading backColor=\"#FFFFFF\" />}\n      <B3Dialog\n        isOpen={open}\n        fullWidth\n        title=\"\"\n        rightSizeBtn=\"ok\"\n        showLeftBtn={false}\n        handRightClick={handleConfirm}\n      >\n        <Box\n          sx={{\n            height: '200px',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            flexDirection: 'column',\n          }}\n        >\n          <Box>\n            <Box\n              sx={{\n                mb: '10px',\n              }}\n            >\n              {b3Lang('payment.firstLoginToPay')}\n            </Box>\n            <Box>{b3Lang('payment.clickToLandingPage')}</Box>\n          </Box>\n        </Box>\n      </B3Dialog>\n    </Box>\n  );\n}\n\nexport default Payment;\n"],"names":["Payment","platform","useAppSelector","global","B2BToken","company","loading","setLoading","useState","open","setOpen","params","useParams","navigate","useNavigate","b3Lang","useB3Lang","useEffect","snackbar","code","value","getInvoiceDetail","data","gotoInvoiceCheckoutUrl","error","handleConfirm","Box","jsx","Loading","B3Dialog"],"mappings":"grBAaA,SAASA,GAAU,CACX,MAAAC,EAAWC,EAAe,CAAC,CAAE,OAAAC,KAAaA,EAAO,UAAU,QAAQ,EACnEC,EAAWF,EAAe,CAAC,CAAE,QAAAG,KAAcA,EAAQ,OAAO,QAAQ,EAElE,CAACC,EAASC,CAAU,EAAIC,EAAAA,SAAkB,EAAK,EAE/C,CAACC,EAAMC,CAAO,EAAIF,EAAAA,SAAkB,EAAK,EAEzCG,EAASC,EAAU,EAEnBC,EAAWC,EAAY,EAEvBC,EAASC,EAAU,EAEzBC,EAAAA,UAAU,IAAM,EACD,SAAY,CAGvB,GAFAV,EAAW,EAAI,EAEX,CAACH,EAAU,CACbM,EAAQ,EAAI,EACZH,EAAW,EAAK,EAChB,MAAA,CAOF,GAJKI,GAAA,MAAAA,EAAQ,IACFO,EAAA,MAAMH,EAAO,iCAAiC,CAAC,EAGtDJ,GAAA,MAAAA,EAAQ,GACN,GAAA,CACI,KAAA,CACJ,QAAS,CACP,YAAa,CAAE,KAAAQ,EAAO,GAAI,MAAAC,EAAQ,EAAG,CAAA,GAErC,MAAMC,EAAiB,OAAOV,EAAO,EAAE,CAAC,GAExC,CAACQ,GAAQ,CAACC,IACHF,EAAA,MAAMH,EAAO,qCAAqC,CAAC,EAG9D,MAAMO,EAAO,CACX,UAAW,CACT,CACE,UAAW,OAAOX,EAAO,EAAE,EAC3B,OAAQS,CAAA,CAEZ,EACA,SAAUD,CACZ,EAEM,MAAAI,EAAuBD,EAAMrB,EAAU,EAAI,QAC1CuB,EAAgB,CACdN,EAAA,OACNM,GAAA,YAAAA,EAA4B,UAAWT,EAAO,6BAA6B,CAC9E,CAAA,QACA,CACAR,EAAW,EAAK,CAAA,CAGtB,GAEK,CAGJ,EAAA,CAACN,EAAUU,EAAO,EAAE,CAAC,EAExB,MAAMc,EAAgB,IAAM,CAC1BZ,EAAS,QAAQ,CACnB,EAEA,cACGa,EACE,CAAA,SAAA,CAAWpB,GAAAqB,EAAAA,IAACC,EAAQ,CAAA,UAAU,SAAU,CAAA,EACzCD,EAAA,IAACE,EAAA,CACC,OAAQpB,EACR,UAAS,GACT,MAAM,GACN,aAAa,KACb,YAAa,GACb,eAAgBgB,EAEhB,SAAAE,EAAA,IAACD,EAAA,CACC,GAAI,CACF,OAAQ,QACR,QAAS,OACT,WAAY,SACZ,eAAgB,SAChB,cAAe,QACjB,EAEA,gBAACA,EACC,CAAA,SAAA,CAAAC,EAAA,IAACD,EAAA,CACC,GAAI,CACF,GAAI,MACN,EAEC,WAAO,yBAAyB,CAAA,CACnC,EACCC,EAAAA,IAAAD,EAAA,CAAK,SAAOX,EAAA,4BAA4B,CAAE,CAAA,CAAA,CAC7C,CAAA,CAAA,CAAA,CACF,CAAA,CACF,EACF,CAEJ"}