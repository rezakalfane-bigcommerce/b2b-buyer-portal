{"version":3,"file":"index-CiAJJogM.js","sources":["../../src/pages/Invoice/utils/pdf.ts","../../src/pages/Invoice/components/B3Pulldown.tsx","../../src/pages/Invoice/components/InvoiceFooter.tsx","../../src/pages/Invoice/components/InvoiceStatus.tsx","../../src/pages/Invoice/components/PaymentsHistory.tsx","../../src/pages/Invoice/utils/config.ts","../../src/pages/Invoice/components/PaymentSuccess.tsx","../../src/pages/Invoice/components/PrintTemplate.tsx","../../src/pages/Invoice/InvoiceItemCard.tsx","../../src/pages/Invoice/index.tsx"],"sourcesContent":["import { invoiceDownloadPDF } from '@/shared/service/b2b';\n\nconst analyzePDFUrl = (url: string): Promise<string> =>\n  new Promise((resolve, reject) => {\n    fetch(url)\n      .then((res) => res.blob())\n      .then((response) => {\n        const blob = new Blob([response], { type: 'application/pdf' });\n\n        const invoicePDFUrl = window.URL.createObjectURL(blob);\n\n        resolve(invoicePDFUrl);\n      })\n      .catch((e) => {\n        reject(e);\n      });\n  });\n\nexport const getInvoiceDownloadPDFUrl = async (invoiceId: string, isPayNow = false) => {\n  const {\n    invoicePdf: { url },\n  } = await invoiceDownloadPDF(Number(invoiceId), isPayNow);\n\n  return url;\n};\n\nexport const handlePrintPDF = async (invoiceId: string, isPayNow = false): Promise<string> => {\n  let url = '';\n  try {\n    url = await getInvoiceDownloadPDFUrl(invoiceId, isPayNow);\n    const pdfUrl = await analyzePDFUrl(url);\n\n    return pdfUrl;\n  } catch (error) {\n    return url;\n  }\n};\n\nexport default handlePrintPDF;\n","import { useEffect, useRef, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useB3Lang } from '@b3/lang';\nimport MoreHorizIcon from '@mui/icons-material/MoreHoriz';\nimport { IconButton, Menu, MenuItem } from '@mui/material';\nimport { styled } from '@mui/material/styles';\n\nimport { rolePermissionSelector, useAppSelector } from '@/store';\nimport { InvoiceList } from '@/types/invoice';\nimport { b2bPermissionsMap, snackbar, verifyLevelPermission } from '@/utils';\n\nimport { gotoInvoiceCheckoutUrl } from '../utils/payment';\nimport { getInvoiceDownloadPDFUrl, handlePrintPDF } from '../utils/pdf';\n\nconst StyledMenu = styled(Menu)(() => ({\n  '& .MuiPaper-elevation': {\n    boxShadow:\n      '0px 1px 0px -1px rgba(0, 0, 0, 0.1), 0px 1px 6px rgba(0, 0, 0, 0.07), 0px 1px 4px rgba(0, 0, 0, 0.06)',\n    borderRadius: '4px',\n  },\n}));\n\ninterface B3PulldownProps {\n  row: InvoiceList;\n  setIsRequestLoading: (bool: boolean) => void;\n  setInvoiceId: (id: string) => void;\n  handleOpenHistoryModal: (bool: boolean) => void;\n  isCurrentCompany: boolean;\n  invoicePay: boolean;\n}\n\nfunction B3Pulldown({\n  row,\n  setIsRequestLoading,\n  setInvoiceId,\n  handleOpenHistoryModal,\n  isCurrentCompany,\n  invoicePay,\n}: B3PulldownProps) {\n  const platform = useAppSelector(({ global }) => global.storeInfo.platform);\n  const ref = useRef<HTMLButtonElement | null>(null);\n  const [isOpen, setIsOpen] = useState(false);\n  const [isPay, setIsPay] = useState<boolean>(true);\n\n  const navigate = useNavigate();\n\n  const b3Lang = useB3Lang();\n\n  const { invoicePayPermission, purchasabilityPermission } = useAppSelector(rolePermissionSelector);\n  const { getOrderPermission: getOrderPermissionCode } = b2bPermissionsMap;\n\n  const [isCanViewOrder, setIsCanViewOrder] = useState<boolean>(false);\n\n  const close = () => {\n    setIsOpen(false);\n  };\n\n  const handleMoreActionsClick = () => {\n    const { id } = row;\n    setInvoiceId(id);\n    setIsOpen(true);\n  };\n\n  const handleViewInvoice = async (isPayNow: boolean) => {\n    const { id } = row;\n\n    close();\n\n    setIsRequestLoading(true);\n\n    const pdfUrl = await handlePrintPDF(id, isPayNow);\n\n    setIsRequestLoading(false);\n\n    if (!pdfUrl) {\n      snackbar.error('pdf url resolution error');\n      return;\n    }\n\n    const { href } = window.location;\n    if (!href.includes('invoice')) {\n      return;\n    }\n\n    window.open(pdfUrl, '_blank', 'fullscreen=yes');\n  };\n\n  const handleViewOrder = () => {\n    const { orderNumber } = row;\n    close();\n    navigate(`/orderDetail/${orderNumber}`);\n  };\n\n  const handlePay = async () => {\n    close();\n\n    const { openBalance, originalBalance, id } = row;\n\n    const params = {\n      lineItems: [\n        {\n          invoiceId: Number(id),\n          amount: openBalance.value === '.' ? '0' : `${Number(openBalance.value)}`,\n        },\n      ],\n      currency: openBalance?.code || originalBalance.code,\n    };\n\n    if (openBalance.value === '.' || Number(openBalance.value) === 0) {\n      snackbar.error('The payment amount entered has an invalid value.', {\n        isClose: true,\n      });\n\n      return;\n    }\n\n    await gotoInvoiceCheckoutUrl(params, platform, false);\n  };\n\n  const viewPaymentHistory = async () => {\n    close();\n    handleOpenHistoryModal(true);\n  };\n\n  const handleDownloadPDF = async () => {\n    const { id } = row;\n\n    close();\n    setIsRequestLoading(true);\n    const url = await getInvoiceDownloadPDFUrl(id);\n\n    setIsRequestLoading(false);\n\n    const a = document.createElement('a');\n    a.href = url;\n    a.target = '_blank';\n    a.download = 'file.pdf';\n    a.click();\n  };\n\n  useEffect(() => {\n    const { openBalance, orderUserId, companyInfo } = row;\n    const payPermissions =\n      Number(openBalance.value) > 0 && invoicePayPermission && purchasabilityPermission;\n\n    setIsPay(payPermissions);\n    const isPayInvoice = isCurrentCompany ? payPermissions : payPermissions && invoicePay;\n    setIsPay(isPayInvoice);\n\n    const viewOrderPermission = verifyLevelPermission({\n      code: getOrderPermissionCode,\n      companyId: Number(companyInfo.companyId),\n      userId: Number(orderUserId),\n    });\n\n    setIsCanViewOrder(viewOrderPermission);\n    // disabling as we only need to run this once and values at starting render are good enough\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  return (\n    <>\n      <IconButton onClick={handleMoreActionsClick} ref={ref}>\n        <MoreHorizIcon />\n      </IconButton>\n      <StyledMenu\n        id=\"basic-menu\"\n        anchorEl={ref.current}\n        open={isOpen}\n        onClose={close}\n        MenuListProps={{\n          'aria-labelledby': 'basic-button',\n        }}\n        anchorOrigin={{\n          vertical: 'bottom',\n          horizontal: 'right',\n        }}\n        transformOrigin={{\n          vertical: 'top',\n          horizontal: 'right',\n        }}\n      >\n        <MenuItem\n          key=\"View-invoice\"\n          sx={{\n            color: 'primary.main',\n          }}\n          onClick={() =>\n            handleViewInvoice(row.status !== 2 && invoicePayPermission && purchasabilityPermission)\n          }\n        >\n          {b3Lang('invoice.actions.viewInvoice')}\n        </MenuItem>\n        {isCanViewOrder && (\n          <MenuItem\n            key=\"View-Order\"\n            sx={{\n              color: 'primary.main',\n            }}\n            onClick={handleViewOrder}\n          >\n            {b3Lang('invoice.actions.viewOrder')}\n          </MenuItem>\n        )}\n\n        {row.status !== 0 && (\n          <MenuItem\n            key=\"View-payment-history\"\n            sx={{\n              color: 'primary.main',\n            }}\n            onClick={viewPaymentHistory}\n          >\n            {b3Lang('invoice.actions.viewPaymentHistory')}\n          </MenuItem>\n        )}\n        {isPay && (\n          <MenuItem\n            key=\"Pay\"\n            sx={{\n              color: 'primary.main',\n            }}\n            onClick={handlePay}\n          >\n            {b3Lang('invoice.actions.pay')}\n          </MenuItem>\n        )}\n        <MenuItem\n          key=\"Print\"\n          sx={{\n            color: 'primary.main',\n          }}\n          onClick={() =>\n            handleViewInvoice(row.status !== 2 && invoicePayPermission && purchasabilityPermission)\n          }\n        >\n          {b3Lang('invoice.actions.print')}\n        </MenuItem>\n        <MenuItem\n          key=\"Download\"\n          sx={{\n            color: 'primary.main',\n          }}\n          onClick={() => handleDownloadPDF()}\n        >\n          {b3Lang('invoice.actions.download')}\n        </MenuItem>\n      </StyledMenu>\n    </>\n  );\n}\n\nexport default B3Pulldown;\n","import { useEffect, useState } from 'react';\nimport { useB3Lang } from '@b3/lang';\nimport { Box, Button, Grid, Typography } from '@mui/material';\n\nimport { useMobile } from '@/hooks';\nimport { useAppSelector } from '@/store';\nimport { BcCartData, BcCartDataLineItem, InvoiceListNode } from '@/types/invoice';\nimport { handleGetCorrespondingCurrencyToken, snackbar } from '@/utils';\n\nimport { formattingNumericValues, gotoInvoiceCheckoutUrl } from '../utils/payment';\n\ninterface InvoiceFooterProps {\n  selectedPay: CustomFieldItems;\n  decimalPlaces: number;\n}\n\nfunction InvoiceFooter(props: InvoiceFooterProps) {\n  const platform = useAppSelector(({ global }) => global.storeInfo.platform);\n  const b3Lang = useB3Lang();\n  const [isMobile] = useMobile();\n  const [selectedAccount, setSelectedAccount] = useState<number | string>(0);\n  const [currentToken, setCurrentToken] = useState<string>('$');\n\n  const isAgenting = useAppSelector(({ b2bFeatures }) => b2bFeatures.masqueradeCompany.isAgenting);\n\n  const containerStyle = isMobile\n    ? {\n        alignItems: 'flex-start',\n        flexDirection: 'column',\n      }\n    : {\n        alignItems: 'center',\n      };\n\n  const { selectedPay, decimalPlaces } = props;\n\n  const handlePay = async () => {\n    const lineItems: BcCartDataLineItem[] = [];\n    let currency = 'SGD';\n\n    if (selectedPay.length > 0) {\n      selectedPay.forEach((item: InvoiceListNode) => {\n        const {\n          node: { id, openBalance, originalBalance },\n        } = item;\n\n        const currentValue =\n          formattingNumericValues(Number(openBalance.originValue), decimalPlaces) ===\n          openBalance.value\n            ? Number(openBalance.originValue)\n            : Number(openBalance.value);\n        lineItems.push({\n          invoiceId: Number(id),\n          amount: openBalance.value === '.' ? '0' : `${Number(currentValue)}`,\n        });\n\n        currency = openBalance?.code || originalBalance.code;\n      });\n\n      const badItem = lineItems.find(\n        (item: CustomFieldItems) => item.amount === '.' || Number(item.amount) === 0,\n      );\n      if (badItem) {\n        snackbar.error(b3Lang('invoice.footer.invalidNameError'), {\n          isClose: true,\n        });\n\n        return;\n      }\n\n      const params: BcCartData = {\n        lineItems,\n        currency,\n      };\n\n      await gotoInvoiceCheckoutUrl(params, platform, false);\n    }\n  };\n\n  useEffect(() => {\n    if (selectedPay.length > 0) {\n      const handleStatisticsInvoiceAmount = (checkedArr: CustomFieldItems) => {\n        let amount = 0;\n\n        checkedArr.forEach((item: InvoiceListNode) => {\n          const {\n            node: { openBalance },\n          } = item;\n          amount += openBalance.value === '.' ? 0 : Number(openBalance.value);\n        });\n\n        setSelectedAccount(formattingNumericValues(amount, decimalPlaces));\n      };\n      const {\n        node: { openBalance },\n      } = selectedPay[0];\n\n      const token = handleGetCorrespondingCurrencyToken(openBalance.code);\n      setCurrentToken(token);\n      handleStatisticsInvoiceAmount(selectedPay);\n    }\n  }, [decimalPlaces, selectedPay]);\n\n  return (\n    <Grid\n      sx={{\n        position: 'fixed',\n        bottom: isMobile && isAgenting ? '52px' : 0,\n        left: 0,\n        backgroundColor: '#fff',\n        width: '100%',\n        padding: isMobile ? '0 0 1rem 0' : '0 40px 1rem 40px',\n        height: isMobile ? '8rem' : 'auto',\n        marginLeft: 0,\n        display: 'flex',\n        flexWrap: 'nowrap',\n        zIndex: '999',\n      }}\n      container\n      spacing={2}\n    >\n      <Grid\n        item\n        sx={{\n          display: isMobile ? 'none' : 'block',\n          width: '290px',\n          paddingLeft: '20px',\n        }}\n      />\n      <Grid\n        item\n        sx={\n          isMobile\n            ? {\n                flexBasis: '100%',\n              }\n            : {\n                flexBasis: '690px',\n                flexGrow: 1,\n              }\n        }\n      >\n        <Box\n          sx={{\n            width: '100%',\n            pr: '20px',\n            display: 'flex',\n            zIndex: '999',\n            justifyContent: 'space-between',\n            ...containerStyle,\n          }}\n        >\n          <Typography\n            sx={{\n              color: '#000000',\n              fontSize: '16px',\n              fontWeight: '400',\n            }}\n          >\n            {b3Lang('invoice.footer.invoiceSelected', {\n              invoices: selectedPay.length,\n            })}\n          </Typography>\n          <Box\n            sx={{\n              display: 'flex',\n              alignItems: 'center',\n              flexWrap: isMobile ? 'wrap' : 'nowrap',\n              width: isMobile ? '100%' : 'auto',\n            }}\n          >\n            <Typography\n              variant=\"h6\"\n              sx={{\n                fontSize: '16px',\n                fontWeight: '700',\n                color: '#000000',\n              }}\n            >\n              {b3Lang('invoice.footer.totalPayment', {\n                total: `${currentToken}${selectedAccount}`,\n              })}\n            </Typography>\n            <Box\n              sx={{\n                display: 'flex',\n                alignItems: 'center',\n                marginTop: isMobile ? '0.5rem' : 0,\n                width: isMobile ? '100%' : 'auto',\n              }}\n            >\n              <Button\n                variant=\"contained\"\n                sx={{\n                  marginLeft: isMobile ? 0 : '1rem',\n                  width: isMobile ? '100%' : 'auto',\n                }}\n                onClick={() => {\n                  handlePay();\n                }}\n              >\n                {b3Lang('invoice.footer.payInvoices')}\n              </Button>\n            </Box>\n          </Box>\n        </Box>\n      </Grid>\n      <Grid\n        item\n        sx={\n          isMobile\n            ? {\n                flexBasis: '100%',\n                display: isMobile ? 'none' : 'block',\n              }\n            : {\n                flexBasis: '0',\n                display: isMobile ? 'none' : 'block',\n              }\n        }\n      />\n    </Grid>\n  );\n}\n\nexport default InvoiceFooter;\n","import { B3Tag } from '@/components';\n\ninterface StatusProps {\n  code: number;\n}\n\ninterface InvoiceStatusProps {\n  [key: string]: {\n    [key: string]: string;\n  };\n}\n\nexport default function InvoiceStatus(props: StatusProps) {\n  const { code } = props;\n\n  const getInvoiceStatus = (code: number) => {\n    const invoiceStatus: InvoiceStatusProps = {\n      0: {\n        textColor: '#000000',\n        name: 'Open',\n        color: '#F1C224',\n      },\n      1: {\n        textColor: '#FFFFFF',\n        name: 'Partially paid',\n        color: '#516FAE',\n      },\n      2: {\n        textColor: '#000000',\n        name: 'Paid',\n        color: '#C4DD6C',\n      },\n      3: {\n        textColor: '#FFFFFF',\n        name: 'Overdue',\n        color: '#D32F2F',\n      },\n    };\n\n    const statusInfo = invoiceStatus[code] || {};\n\n    return statusInfo;\n  };\n\n  const status = getInvoiceStatus(code);\n\n  return status.name ? (\n    <B3Tag color={status.color} textColor={status.textColor}>\n      {status.name}\n    </B3Tag>\n  ) : null;\n}\n","import { useEffect, useState } from 'react';\nimport { useB3Lang } from '@b3/lang';\nimport { Box, Card, CardContent, Typography } from '@mui/material';\n\nimport { B3NoData } from '@/components';\nimport B3Dialog from '@/components/B3Dialog';\nimport B3Spin from '@/components/spin/B3Spin';\nimport { useMobile } from '@/hooks';\nimport { getInvoicePaymentHistory } from '@/shared/service/b2b';\nimport { displayFormat, handleGetCorrespondingCurrency } from '@/utils';\n\ninterface PaymentsHistoryProps {\n  open: boolean;\n  setOpen: (bool: boolean) => void;\n  currentInvoiceId: string;\n}\n\ninterface PaymentsHistoryList {\n  node: InvoiceData;\n}\n\ninterface InvoiceData {\n  id: string;\n  paymentType: string;\n  invoiceId: number;\n  amount: {\n    code: string;\n    value: string;\n  };\n  transactionType: string;\n  referenceNumber: string;\n  createdAt: number;\n}\n\nfunction Title({ title }: { title: string }) {\n  return (\n    <Typography\n      sx={{\n        fontWeight: 'bold',\n        pr: '5px',\n      }}\n    >\n      {title}:\n    </Typography>\n  );\n}\n\nfunction HistoryList({ list }: { list: PaymentsHistoryList[] }) {\n  return (\n    <>\n      {list.map((item: PaymentsHistoryList) => {\n        const {\n          node: { createdAt, amount, paymentType, transactionType, referenceNumber, id },\n        } = item;\n\n        return (\n          <Card\n            key={id}\n            sx={{\n              mb: '10px',\n            }}\n          >\n            <CardContent\n              sx={{\n                color: '#313440',\n                wordBreak: 'break-word',\n              }}\n            >\n              <Box\n                sx={{\n                  display: 'flex',\n                }}\n              >\n                <Title title=\"Date received\" />\n                <Typography variant=\"body1\">{`${displayFormat(Number(createdAt))}`}</Typography>\n              </Box>\n              <Box\n                sx={{\n                  display: 'flex',\n                }}\n              >\n                <Title title=\"Amount\" />\n                <Typography variant=\"body1\">\n                  {handleGetCorrespondingCurrency(amount.code, Number(amount?.value || 0))}\n                </Typography>\n              </Box>\n              <Box\n                sx={{\n                  display: 'flex',\n                }}\n              >\n                <Title title=\"Transaction type\" />\n                <Typography variant=\"body1\">{transactionType}</Typography>\n              </Box>\n              <Box\n                sx={{\n                  display: 'flex',\n                }}\n              >\n                <Title title=\"Payment type\" />\n                <Typography variant=\"body1\">{paymentType}</Typography>\n              </Box>\n              <Box\n                sx={{\n                  display: 'flex',\n                }}\n              >\n                <Title title=\"Reference\" />\n                <Typography variant=\"body1\">{referenceNumber || '–'}</Typography>\n              </Box>\n            </CardContent>\n          </Card>\n        );\n      })}\n    </>\n  );\n}\n\nfunction PaymentsHistory({ open, setOpen, currentInvoiceId }: PaymentsHistoryProps) {\n  const b3Lang = useB3Lang();\n  const [isMobile] = useMobile();\n  const [loading, setLoading] = useState<boolean>(false);\n\n  const [list, setList] = useState<PaymentsHistoryList[] | []>([]);\n\n  useEffect(() => {\n    const init = async () => {\n      setLoading(true);\n      const {\n        allReceiptLines: { edges = [] },\n      } = await getInvoicePaymentHistory(Number(currentInvoiceId));\n\n      setList(edges);\n      setLoading(false);\n    };\n\n    if (open && currentInvoiceId) {\n      init();\n    }\n  }, [open, currentInvoiceId]);\n\n  return (\n    <B3Dialog\n      isOpen={open}\n      leftSizeBtn=\"\"\n      rightSizeBtn=\"ok\"\n      title={b3Lang('invoice.paymentHistory.title')}\n      showLeftBtn={false}\n      handRightClick={() => setOpen(false)}\n    >\n      <Box\n        sx={{\n          width: isMobile ? '100%' : '384px',\n          maxHeight: '600px',\n        }}\n      >\n        <B3Spin isSpinning={loading}>\n          <Box\n            sx={{\n              display: 'flex',\n              flexDirection: 'column',\n              flex: 1,\n            }}\n          >\n            {list.length ? <HistoryList list={list} /> : <B3NoData />}\n          </Box>\n        </B3Spin>\n      </Box>\n    </B3Dialog>\n  );\n}\n\nexport default PaymentsHistory;\n","// NORMAL:   ;  DETAIL:  ; CHECKOUT:  ;\nconst InvoiceListType = {\n  NORMAL: 'normal',\n  DETAIL: 'detail',\n  CHECKOUT: 'checkout',\n};\n\n// invoice status\n// (0, \"open\"), (1, \"partial paid\"), (2, \"Paid\")\nexport const invoiceStatus = [\n  {\n    key: 'open',\n    value: 0,\n    label: 'Open',\n  },\n  {\n    key: 'partialPaid',\n    value: 1,\n    label: 'Partially paid',\n  },\n  {\n    key: 'paid',\n    value: 2,\n    label: 'Paid',\n  },\n  {\n    key: 'overdue',\n    value: 3,\n    label: 'Overdue',\n  },\n];\n// (3, \"Overdue\")-【Display status when invoice exceeds due date. For front-end display only】\nexport const extraStatus = [\n  {\n    key: 'overdue',\n    value: 3,\n    label: 'Overdue',\n  },\n];\n\nexport const filterFormConfig = [\n  {\n    name: 'status',\n    label: 'Status',\n    required: false,\n    default: '',\n    fieldType: 'dropdown',\n    xs: 12,\n    variant: 'filled',\n    size: 'small',\n    options: invoiceStatus,\n  },\n];\n\nexport const filterFormConfigsTranslationVariables: { [key: string]: string } = {\n  status: 'invoice.filterStatus.title',\n  open: 'invoice.filterStatus.open',\n  partialPaid: 'invoice.filterStatus.partiallyPaid',\n  paid: 'invoice.filterStatus.paid',\n  overdue: 'invoice.filterStatus.overdue',\n};\n\nexport const defaultSortKey = 'id';\n\nexport const sortIdArr: { [key: string]: string } = {\n  id: 'invoiceNumber',\n  orderNumber: 'orderNumber',\n  createdAt: 'createdAt',\n  updatedAt: 'dueDate',\n  originalBalance: 'originalBalanceAmount',\n  openBalance: 'openBalanceAmount',\n  status: 'status',\n};\n\nexport const exportOrderByArr: { [key: string]: string } = {\n  invoiceNumber: 'invoice_number',\n  orderNumber: 'order_number',\n  createdAt: 'created_at',\n  dueDate: 'due_date',\n  originalBalanceAmount: 'original_balance_amount',\n  openBalanceAmount: 'open_balance_amount',\n};\nexport default InvoiceListType;\n","import { useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useB3Lang } from '@b3/lang';\nimport { Box, Button, Typography } from '@mui/material';\n\nimport { B3NoData } from '@/components';\nimport B3Dialog from '@/components/B3Dialog';\nimport B3Spin from '@/components/spin/B3Spin';\nimport { useMobile } from '@/hooks';\nimport { getInvoicePaymentInfo } from '@/shared/service/b2b';\nimport { InvoiceSuccessData, ReceiptLineSet } from '@/types/invoice';\nimport { displayFormat, handleGetCorrespondingCurrency } from '@/utils';\n\nimport InvoiceListType from '../utils/config';\n\ninterface PaymentSuccessKeysProps {\n  key: string;\n  label: string;\n  type: string;\n  isRow: boolean;\n  idLang: string;\n}\n\nfunction Title({ title, withColon = true }: { title: string; withColon?: boolean }) {\n  return (\n    <Typography\n      sx={{\n        fontWeight: 'bold',\n        pr: '5px',\n      }}\n    >\n      {withColon ? `${title}:` : title}\n    </Typography>\n  );\n}\n\ninterface RowProps {\n  isRow?: boolean;\n  type: string;\n  value: string | number;\n  label: string;\n  code: string;\n}\nfunction Row({ isRow = true, type = '', value, label, code }: RowProps) {\n  const getNewVal = (): string | number | Date => {\n    if (type === 'time') {\n      return displayFormat(Number(value)) || '';\n    }\n    if (type === 'currency') {\n      const val = Number(value || 0);\n      const accountValue = handleGetCorrespondingCurrency(code, val);\n      return accountValue;\n    }\n    if (type === 'paymentType') {\n      let val = `${value}`.trim();\n\n      if (value) {\n        val = val.slice(0, 1).toUpperCase() + val.slice(1).toLowerCase();\n      }\n\n      return val;\n    }\n    return value || '–';\n  };\n\n  return (\n    <Box\n      sx={{\n        display: 'flex',\n        flexDirection: isRow ? 'row' : 'column',\n      }}\n    >\n      <Title title={label} />\n      <Typography variant=\"body1\">{`${getNewVal()}`}</Typography>\n    </Box>\n  );\n}\n\nfunction PaymentSuccessList({ list }: { list: InvoiceSuccessData }) {\n  const {\n    receiptLineSet: { edges = [] },\n    details,\n  } = list;\n\n  const comment = details?.paymentDetails?.comment || '';\n\n  const b3Lang = useB3Lang();\n\n  const paymentSuccessKeys = [\n    {\n      key: 'paymentId',\n      label: 'Payment#',\n      type: '',\n      isRow: true,\n      idLang: 'payment.paymentNumber',\n    },\n    {\n      key: 'createdAt',\n      label: 'Payment received on',\n      type: 'time',\n      isRow: true,\n      idLang: 'payment.paymentReceivedOn',\n    },\n    {\n      key: 'transactionType',\n      label: 'Transaction type',\n      type: '',\n      isRow: true,\n      idLang: 'payment.transactionType',\n    },\n    {\n      key: 'paymentType',\n      label: 'Payment type',\n      type: 'paymentType',\n      isRow: true,\n      idLang: 'payment.paymentType',\n    },\n    {\n      key: 'totalAmount',\n      label: 'Payment total',\n      type: 'currency',\n      isRow: true,\n      idLang: 'payment.paymentTotal',\n    },\n    {\n      key: 'referenceNumber',\n      label: 'Reference',\n      type: '',\n      isRow: true,\n      idLang: 'payment.reference',\n    },\n  ];\n\n  return (\n    <Box>\n      {paymentSuccessKeys.map((item: PaymentSuccessKeysProps) => (\n        <Row\n          isRow={!!item.isRow}\n          type={item.type}\n          value={(list as CustomFieldItems)[item.key]}\n          code={(list as CustomFieldItems)?.totalCode || 'SGD'}\n          label={b3Lang(item.idLang)}\n        />\n      ))}\n      <Box\n        sx={{\n          display: 'flex',\n          flexDirection: 'column',\n          mb: '30px',\n        }}\n      >\n        <Title title={b3Lang('payment.paymentComment')} />\n        <Typography\n          sx={{\n            maxHeight: '50px',\n          }}\n        >\n          {comment}\n        </Typography>\n      </Box>\n\n      <Box\n        sx={{\n          display: 'flex',\n          flexDirection: 'column',\n        }}\n      >\n        <Title title={b3Lang('payment.invoicesPaid')} withColon={false} />\n        <Typography variant=\"body1\">{b3Lang('payment.paymentTowardsInvoices')} </Typography>\n      </Box>\n\n      <Box>\n        <Box\n          sx={{\n            borderBottom: '1px solid #D9DCE9',\n            padding: '20px 15px',\n            display: 'flex',\n            justifyContent: 'space-between',\n            fontWeight: 500,\n          }}\n        >\n          <Typography\n            sx={{\n              fontSize: '14px',\n              fontWeight: '500',\n              color: '#000000',\n            }}\n          >\n            {b3Lang('payment.invoiceNumber')}\n          </Typography>\n          <Typography\n            sx={{\n              fontSize: '14px',\n              fontWeight: '500',\n              color: '#000000',\n            }}\n          >\n            {b3Lang('payment.amountPaid')}\n          </Typography>\n        </Box>\n        {edges.map((item: ReceiptLineSet) => {\n          const {\n            invoiceNumber,\n            amount: { value, code },\n          } = item.node;\n          const val = Number(value || 0);\n\n          const accountValue = handleGetCorrespondingCurrency(code, val);\n          return (\n            <Box\n              sx={{\n                borderBottom: '1px solid #D9DCE9',\n                padding: '20px 15px',\n                display: 'flex',\n                justifyContent: 'space-between',\n              }}\n            >\n              <Typography>{invoiceNumber}</Typography>\n              <Typography>{accountValue}</Typography>\n            </Box>\n          );\n        })}\n      </Box>\n    </Box>\n  );\n}\n\ninterface PaymentSuccessProps {\n  receiptId: number | number;\n  type: string;\n}\n\nfunction PaymentSuccess({ receiptId, type }: PaymentSuccessProps) {\n  const [isMobile] = useMobile();\n  const [loading, setLoading] = useState<boolean>(false);\n\n  const [open, setOpen] = useState<boolean>(false);\n\n  const [detailData, setDetailData] = useState<InvoiceSuccessData | null>(null);\n\n  const navigate = useNavigate();\n\n  const b3Lang = useB3Lang();\n\n  useEffect(() => {\n    const init = async () => {\n      setLoading(true);\n      const { receipt } = await getInvoicePaymentInfo(Number(receiptId));\n\n      setDetailData(receipt);\n      setOpen(true);\n      setLoading(false);\n    };\n\n    if (type === InvoiceListType.CHECKOUT && receiptId) {\n      init();\n    }\n  }, [receiptId, type]);\n\n  const handleCloseClick = () => {\n    setOpen(false);\n    navigate('/invoice');\n  };\n  const customActions = () => (\n    <Button onClick={handleCloseClick} variant=\"text\">\n      {b3Lang('payment.okButton')}\n    </Button>\n  );\n\n  return (\n    <B3Dialog\n      isOpen={open}\n      leftSizeBtn=\"\"\n      customActions={customActions}\n      title={b3Lang('payment.paymentSuccess')}\n      showLeftBtn={false}\n    >\n      <Box\n        sx={{\n          width: isMobile ? '100%' : '384px',\n          maxHeight: '600px',\n        }}\n      >\n        <B3Spin isSpinning={loading}>\n          <Box\n            sx={{\n              display: 'flex',\n              flexDirection: 'column',\n              flex: 1,\n            }}\n          >\n            {detailData ? <PaymentSuccessList list={detailData} /> : <B3NoData />}\n          </Box>\n        </B3Spin>\n      </Box>\n    </B3Dialog>\n  );\n}\n\nexport default PaymentSuccess;\n","import { SyntheticEvent, useEffect, useRef, useState } from 'react';\nimport { Resizable } from 'react-resizable';\nimport { Box } from '@mui/material';\n// cspell:disable-next-line\nimport PDFObject from 'pdfobject';\n\nimport B3Spin from '@/components/spin/B3Spin';\nimport { snackbar } from '@/utils';\n\nimport { handlePrintPDF } from '../utils/pdf';\n\ninterface RowList {\n  id: string;\n  createdAt: number;\n  updatedAt: number;\n}\n\nconst templateMinHeight = 300;\n\ninterface PrintTemplateProps {\n  row: RowList;\n}\n\nfunction PrintTemplate({ row }: PrintTemplateProps) {\n  const container = useRef<HTMLInputElement | null>(null);\n\n  const dom = useRef<HTMLInputElement | null>(null);\n\n  const [loading, setLoading] = useState<boolean>(false);\n\n  const [height, setHeight] = useState<number>(templateMinHeight);\n\n  const onFirstBoxResize = (\n    _: SyntheticEvent<Element, Event>,\n    { size }: { size: { height: number } },\n  ) => {\n    setHeight(size.height);\n  };\n\n  useEffect(() => {\n    const viewPrint = async () => {\n      setLoading(true);\n      const { id: invoiceId } = row;\n\n      const invoicePDFUrl = await handlePrintPDF(invoiceId);\n\n      if (!invoicePDFUrl) {\n        snackbar.error('pdf url resolution error');\n        return;\n      }\n\n      if (!container?.current) return;\n\n      PDFObject.embed(invoicePDFUrl, container.current);\n\n      setLoading(false);\n    };\n\n    viewPrint();\n\n    return () => {\n      container.current = null;\n    };\n  }, [row]);\n\n  return (\n    <B3Spin isSpinning={loading}>\n      <Box\n        ref={dom}\n        sx={{\n          display: 'flex',\n          flexWrap: 'wrap',\n          width: '100%',\n          '& .box': {\n            display: 'flex',\n            flexDirection: 'column',\n            overflow: 'hidden',\n            position: 'relative',\n            width: '100%',\n            '& .react-resizable': {\n              position: 'relative',\n            },\n            '& .react-resizable-handle': {\n              position: 'absolute',\n              width: '100%',\n              height: '30px',\n              backgroundRepeat: 'no-repeat',\n              backgroundOrigin: 'content-box',\n              boxSizing: 'border-box',\n            },\n            '& .react-resizable-handle-s': {\n              cursor: 'ns-resize',\n              bottom: 0,\n            },\n          },\n        }}\n      >\n        <Resizable\n          className=\"box\"\n          height={height}\n          minConstraints={[dom?.current?.offsetWidth || 0, 0]}\n          width={dom.current?.offsetWidth || 0}\n          onResize={onFirstBoxResize}\n          resizeHandles={['s']}\n        >\n          <div style={{ width: '100%', height: `${height}px` }}>\n            <div ref={container} style={{ height: '100%', width: '100%' }} />\n          </div>\n        </Resizable>\n      </Box>\n    </B3Spin>\n  );\n}\n\nexport default PrintTemplate;\n","import { ReactElement } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { useB3Lang } from '@b3/lang';\nimport styled from '@emotion/styled';\nimport { Box, Card, CardContent, InputAdornment, TextField, Typography } from '@mui/material';\n\nimport { TableColumnItem } from '@/components/table/B3Table';\nimport { InvoiceList, InvoiceListNode } from '@/types/invoice';\nimport { currencyFormat, displayFormat } from '@/utils';\n\nimport B3Pulldown from './components/B3Pulldown';\nimport InvoiceStatus from './components/InvoiceStatus';\n\nexport interface InvoiceItemCardProps {\n  item: any;\n  checkBox?: (disable: boolean) => ReactElement;\n  handleSetSelectedInvoiceAccount: (value: string, id: string) => void;\n  handleViewInvoice: (id: string, status: string | number, invoiceCompanyId: string) => void;\n  setIsRequestLoading: (bool: boolean) => void;\n  setInvoiceId: (id: string) => void;\n  handleOpenHistoryModal: (bool: boolean) => void;\n  selectedPay: CustomFieldItems | InvoiceListNode[];\n  handleGetCorrespondingCurrency: (code: string) => string;\n  addBottom: boolean;\n  isCurrentCompany: boolean;\n  invoicePay: boolean;\n}\n\nconst StyleCheckoutContainer = styled(Box)(() => ({\n  '& > span': {\n    padding: '0 9px 0 0',\n  },\n}));\n\nexport function InvoiceItemCard(props: InvoiceItemCardProps) {\n  const currentDate = new Date().getTime();\n  const {\n    item,\n    checkBox,\n    handleSetSelectedInvoiceAccount,\n    handleViewInvoice,\n    setIsRequestLoading,\n    setInvoiceId,\n    handleOpenHistoryModal,\n    selectedPay = [],\n    handleGetCorrespondingCurrency,\n    addBottom,\n    isCurrentCompany,\n    invoicePay,\n  } = props;\n  const b3Lang = useB3Lang();\n  const navigate = useNavigate();\n\n  const { id, status, dueDate, openBalance, companyInfo } = item;\n  const currentCode = openBalance.code || 'USD';\n  const currentCurrencyToken = handleGetCorrespondingCurrency(currentCode);\n\n  let statusCode = item.status;\n  if (status === 0 && currentDate > dueDate * 1000) {\n    statusCode = 3;\n  }\n\n  const columnAllItems: TableColumnItem<InvoiceList>[] = [\n    {\n      key: 'orderNumber',\n      title: b3Lang('invoice.invoiceItemCardHeader.order'),\n      render: () => (\n        <Box\n          sx={{\n            color: '#000000',\n            cursor: 'pointer',\n            textDecoration: 'underline',\n          }}\n          onClick={() => {\n            navigate(`/orderDetail/${item.orderNumber}`);\n          }}\n        >\n          {item?.orderNumber || '-'}\n        </Box>\n      ),\n    },\n    {\n      key: 'createdAt',\n      title: b3Lang('invoice.invoiceItemCardHeader.invoiceDate'),\n      render: () => `${item.createdAt ? displayFormat(Number(item.createdAt)) : '–'}`,\n    },\n    {\n      key: 'updatedAt',\n      title: b3Lang('invoice.invoiceItemCardHeader.dueDate'),\n      render: () => {\n        const { dueDate, status } = item;\n        const isOverdue = currentDate > dueDate * 1000 && status !== 2;\n\n        return (\n          <Typography\n            sx={{\n              color: isOverdue ? '#D32F2F' : 'rgba(0, 0, 0, 0.87)',\n              fontSize: '14px',\n            }}\n          >\n            {`${item.dueDate ? displayFormat(Number(item.dueDate)) : '–'}`}\n          </Typography>\n        );\n      },\n    },\n    {\n      key: 'originalBalance',\n      title: b3Lang('invoice.invoiceItemCardHeader.invoiceTotal'),\n      render: () => {\n        const { originalBalance } = item;\n        const originalAmount = Number(originalBalance.value);\n\n        return currencyFormat(originalAmount || 0);\n      },\n    },\n    {\n      key: 'openBalance',\n      title: b3Lang('invoice.invoiceItemCardHeader.amountDue'),\n      render: () => {\n        const { openBalance } = item;\n\n        const openAmount = Number(openBalance.value);\n\n        return currencyFormat(openAmount || 0);\n      },\n    },\n    {\n      key: 'openBalanceToPay',\n      title: b3Lang('invoice.invoiceItemCardHeader.amountToPay'),\n      render: () => {\n        const { openBalance, id } = item;\n        let valuePrice = openBalance.value;\n        let disabled = true;\n\n        if (selectedPay.length > 0) {\n          const currentSelected = selectedPay.find((item: InvoiceListNode) => {\n            const {\n              node: { id: selectedId },\n            } = item;\n\n            return Number(selectedId) === Number(id);\n          });\n\n          if (currentSelected) {\n            const {\n              node: { openBalance: selectedOpenBalance },\n            } = currentSelected;\n\n            disabled = false;\n            valuePrice = selectedOpenBalance.value;\n\n            if (Number(openBalance.value) === 0) {\n              disabled = true;\n            }\n          }\n        }\n\n        return (\n          <TextField\n            disabled={disabled}\n            variant=\"filled\"\n            value={valuePrice}\n            InputProps={{\n              startAdornment: (\n                <InputAdornment\n                  position=\"start\"\n                  sx={{ padding: '8px 0', marginTop: '0 !important' }}\n                >\n                  {currentCurrencyToken || '$'}\n                </InputAdornment>\n              ),\n            }}\n            sx={{\n              '& input': {\n                paddingTop: '8px',\n              },\n            }}\n            onChange={(e: CustomFieldItems) => {\n              const val = e.target?.value;\n              handleSetSelectedInvoiceAccount(val, id);\n            }}\n            type=\"number\"\n          />\n        );\n      },\n    },\n  ];\n\n  return (\n    <Card\n      sx={{\n        marginBottom: selectedPay.length > 0 && addBottom ? '5rem' : 0,\n      }}\n    >\n      <CardContent\n        sx={{\n          color: 'rgba(0, 0, 0, 0.6)',\n        }}\n      >\n        <Box\n          sx={{\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'space-between',\n          }}\n        >\n          <Box\n            sx={{\n              display: 'flex',\n              alignItems: 'center',\n              mb: '0.5rem',\n            }}\n          >\n            <StyleCheckoutContainer>\n              {checkBox && checkBox(!!item?.disableCurrentCheckbox)}\n            </StyleCheckoutContainer>\n            <Typography\n              variant=\"h6\"\n              sx={{\n                color: 'rgba(0, 0, 0, 0.87)',\n              }}\n            >\n              <Box\n                sx={{\n                  color: '#000000',\n                  cursor: 'pointer',\n                  textDecoration: 'underline',\n                }}\n                onClick={() => {\n                  handleViewInvoice(id, status, companyInfo.companyId);\n                }}\n              >\n                {id || '-'}\n              </Box>\n            </Typography>\n          </Box>\n          <Box sx={{ mb: '0.5rem' }}>\n            <B3Pulldown\n              row={item}\n              setInvoiceId={setInvoiceId}\n              handleOpenHistoryModal={handleOpenHistoryModal}\n              setIsRequestLoading={setIsRequestLoading}\n              isCurrentCompany={isCurrentCompany}\n              invoicePay={invoicePay}\n            />\n          </Box>\n        </Box>\n        <Box sx={{ mb: '1rem' }}>\n          <InvoiceStatus code={statusCode} />\n        </Box>\n\n        {columnAllItems.map((list: CustomFieldItems) => (\n          <Box\n            key={list.key}\n            sx={{\n              display: 'flex',\n              alignItems: 'center',\n              mt: '4px',\n            }}\n          >\n            <Typography\n              sx={{\n                fontWeight: 'bold',\n                color: 'rgba(0, 0, 0, 0.87)',\n                mr: '5px',\n                whiteSpace: 'nowrap',\n              }}\n            >\n              {`${list.title}:`}\n            </Typography>\n            <Box\n              sx={{\n                color: 'black',\n                wordBreak: 'break-all',\n              }}\n            >\n              {list?.render ? list.render() : item[list.key]}\n            </Box>\n          </Box>\n        ))}\n      </CardContent>\n    </Card>\n  );\n}\n","import { useContext, useEffect, useRef, useState } from 'react';\nimport { useLocation, useNavigate } from 'react-router-dom';\nimport { useB3Lang } from '@b3/lang';\nimport { Box, Button, InputAdornment, TextField, Typography } from '@mui/material';\nimport cloneDeep from 'lodash-es/cloneDeep';\n\nimport { B2BAutoCompleteCheckbox } from '@/components';\nimport B3Spin from '@/components/spin/B3Spin';\nimport { B3PaginationTable, GetRequestList } from '@/components/table/B3PaginationTable';\nimport { TableColumnItem } from '@/components/table/B3Table';\nimport { permissionLevels } from '@/constants';\nimport { useMobile, useSort } from '@/hooks';\nimport { GlobalContext } from '@/shared/global';\nimport { exportInvoicesAsCSV, getInvoiceList, getInvoiceStats } from '@/shared/service/b2b';\nimport { rolePermissionSelector, useAppSelector } from '@/store';\nimport { CustomerRole } from '@/types';\nimport { InvoiceList, InvoiceListNode } from '@/types/invoice';\nimport {\n  b2bPermissionsMap,\n  currencyFormat,\n  currencyFormatInfo,\n  displayFormat,\n  getUTCTimestamp,\n  handleGetCorrespondingCurrencyToken,\n  snackbar,\n  validatePermissionWithComparisonType,\n} from '@/utils';\nimport b2bLogger from '@/utils/b3Logger';\n\nimport B3Filter from '../../components/filter/B3Filter';\n\nimport B3Pulldown from './components/B3Pulldown';\nimport InvoiceFooter from './components/InvoiceFooter';\nimport InvoiceStatus from './components/InvoiceStatus';\nimport PaymentsHistory from './components/PaymentsHistory';\nimport PaymentSuccess from './components/PaymentSuccess';\nimport PrintTemplate from './components/PrintTemplate';\nimport InvoiceListType, {\n  defaultSortKey,\n  exportOrderByArr,\n  filterFormConfig,\n  filterFormConfigsTranslationVariables,\n  sortIdArr,\n} from './utils/config';\nimport { formattingNumericValues } from './utils/payment';\nimport { handlePrintPDF } from './utils/pdf';\nimport { InvoiceItemCard } from './InvoiceItemCard';\n\nexport interface FilterSearchProps {\n  [key: string]: string | number | number[] | null;\n  q: string;\n  startValue: number | string;\n  endValue: number | string;\n  companyIds: number[];\n}\n\ninterface PaginationTableRefProps extends HTMLInputElement {\n  getList: () => void;\n  getCacheList: () => void;\n  setCacheAllList: (items?: InvoiceList[]) => void;\n  setList: (items?: InvoiceListNode[]) => void;\n  getSelectedValue: () => void;\n}\n\nconst initFilter = {\n  q: '',\n  first: 10,\n  offset: 0,\n  orderBy: `-${sortIdArr[defaultSortKey]}`,\n  companyIds: [],\n};\n\nfunction useData() {\n  const role = useAppSelector(({ company }) => company.customer.role);\n  const isAgenting = useAppSelector(({ b2bFeatures }) => b2bFeatures.masqueradeCompany.isAgenting);\n\n  const companyInfoId = useAppSelector(({ company }) => company.companyInfo.id);\n  const { selectCompanyHierarchyId, isEnabledCompanyHierarchy } = useAppSelector(\n    ({ company }) => company.companyHierarchyInfo,\n  );\n  const salesRepCompanyId = useAppSelector(({ b2bFeatures }) => b2bFeatures.masqueradeCompany.id);\n\n  const { invoicePayPermission, purchasabilityPermission } = useAppSelector(rolePermissionSelector);\n  const currentCompanyId =\n    role === CustomerRole.SUPER_ADMIN && isAgenting\n      ? Number(salesRepCompanyId)\n      : Number(companyInfoId);\n\n  const { invoice: invoiceSubViewPermission } = useAppSelector(\n    ({ company }) => company.pagesSubsidiariesPermission,\n  );\n\n  return {\n    isAgenting,\n    selectCompanyHierarchyId,\n    isEnabledCompanyHierarchy,\n    invoicePayPermission,\n    purchasabilityPermission,\n    currentCompanyId,\n    invoiceSubViewPermission,\n  };\n}\n\nfunction Invoice() {\n  const currentDate = new Date().getTime();\n  const b3Lang = useB3Lang();\n\n  const {\n    isAgenting,\n    selectCompanyHierarchyId,\n    isEnabledCompanyHierarchy,\n    invoicePayPermission,\n    purchasabilityPermission,\n    currentCompanyId,\n    invoiceSubViewPermission,\n  } = useData();\n\n  const navigate = useNavigate();\n  const [isMobile] = useMobile();\n  const paginationTableRef = useRef<PaginationTableRefProps | null>(null);\n\n  const { decimal_places: decimalPlaces = 2 } = currencyFormatInfo();\n\n  const [isRequestLoading, setIsRequestLoading] = useState<boolean>(false);\n  const [isOpenHistory, setIsOpenHistory] = useState<boolean>(false);\n  const [currentInvoiceId, setCurrentInvoiceId] = useState<string>('');\n  const [receiptId, setReceiptId] = useState<string>('');\n  const [type, setType] = useState<string>('');\n  const [unpaidAmount, setUnpaidAmount] = useState<number>(0);\n  const [overdueAmount, setOverdueAmount] = useState<number>(0);\n  const [checkedArr, setCheckedArr] = useState<CustomFieldItems | InvoiceListNode[]>([]);\n  const [selectedPay, setSelectedPay] = useState<CustomFieldItems | InvoiceListNode[]>([]);\n  const [list, setList] = useState<InvoiceListNode[]>([]);\n\n  const [filterData, setFilterData] = useState<Partial<FilterSearchProps>>({});\n\n  const [exportCsvText, setExportCsvText] = useState<string>(b3Lang('invoice.exportCsvText'));\n\n  const [filterChangeFlag, setFilterChangeFlag] = useState(false);\n  const [filterLists, setFilterLists] = useState<InvoiceListNode[]>([]);\n  const [selectAllPay, setSelectAllPay] = useState<boolean>(invoicePayPermission);\n\n  const invoiceSubPayPermission = validatePermissionWithComparisonType({\n    level: permissionLevels.COMPANY_SUBSIDIARIES,\n    code: b2bPermissionsMap.invoicePayPermission,\n  });\n\n  const {\n    state: { bcLanguage },\n  } = useContext(GlobalContext);\n\n  const [handleSetOrderBy, order, orderBy] = useSort(\n    sortIdArr,\n    defaultSortKey,\n    filterData,\n    setFilterData,\n  );\n\n  const location = useLocation();\n\n  const isFiltering = (filterData: Partial<FilterSearchProps>) =>\n    Object.keys(filterData).some(\n      (key) => key !== 'first' && key !== 'offset' && key !== 'orderBy' && filterData[key],\n    );\n\n  const cacheFilterLists = (edges: InvoiceListNode[]) => {\n    if (filterChangeFlag) {\n      setFilterLists(edges);\n      setFilterChangeFlag(false);\n      return;\n    }\n\n    if (!filterLists.length) setFilterLists(edges);\n\n    const copyCacheFilterList = [...filterLists];\n\n    edges.forEach((item: InvoiceListNode) => {\n      const option = item?.node || item;\n      const isExist = filterLists.some((cache: InvoiceListNode) => {\n        const cacheOption = cache.node;\n        return cacheOption.id === option.id;\n      });\n\n      if (!isExist) {\n        copyCacheFilterList.push(item);\n      }\n    });\n\n    setFilterLists(copyCacheFilterList);\n  };\n\n  const handleStatisticsInvoiceAmount = async () => {\n    try {\n      setIsRequestLoading(true);\n      const { invoiceStats } = await getInvoiceStats(\n        filterData?.status ? Number(filterData.status) : 0,\n        Number(decimalPlaces),\n        filterData?.companyIds || [],\n      );\n\n      if (invoiceStats) {\n        const { overDueBalance, totalBalance } = invoiceStats;\n        setUnpaidAmount(Number(formattingNumericValues(Number(totalBalance), decimalPlaces)));\n        setOverdueAmount(Number(formattingNumericValues(Number(overDueBalance), decimalPlaces)));\n      }\n    } catch (err) {\n      b2bLogger.error(err);\n    } finally {\n      setIsRequestLoading(false);\n    }\n  };\n\n  const handleChange = (key: string, value: string) => {\n    if (key === 'search') {\n      setFilterData({\n        ...filterData,\n        q: value,\n      });\n      setFilterChangeFlag(true);\n      setType(InvoiceListType.NORMAL);\n    }\n  };\n\n  const handleFilterChange = (value: Partial<FilterSearchProps>) => {\n    const startValue = value?.startValue\n      ? getUTCTimestamp(new Date(value?.startValue).getTime() / 1000)\n      : '';\n\n    const endValue = value?.endValue\n      ? getUTCTimestamp(new Date(value?.endValue).getTime() / 1000, true)\n      : '';\n\n    const status = value?.status === 3 ? 0 : value?.status;\n\n    const search: Partial<FilterSearchProps> = {\n      status: `${status}` || '',\n      beginDateAt: startValue,\n      endDateAt: endValue,\n      beginDueDateAt: value?.status === 0 ? parseInt(`${currentDate / 1000}`, 10) : '',\n      endDueDateAt: value?.status === 3 ? parseInt(`${currentDate / 1000}`, 10) : '',\n    };\n\n    setFilterData({\n      ...filterData,\n      ...search,\n    });\n    setFilterChangeFlag(true);\n    setType(InvoiceListType.NORMAL);\n  };\n\n  const getSelectCheckbox = (selectCheckbox: Array<string | number>) => {\n    if (selectCheckbox.length > 0) {\n      const productList = paginationTableRef.current?.getCacheList() || [];\n\n      const checkedItems = selectCheckbox.map((item: number | string) => {\n        const newItems = productList.find((product: InvoiceListNode) => {\n          const { node } = product;\n\n          return Number(node.id) === Number(item);\n        });\n\n        return newItems;\n      });\n\n      const newEnableItems = checkedItems.filter(\n        (item: InvoiceListNode | undefined) => item && !item.node.disableCurrentCheckbox,\n      );\n      setCheckedArr([...newEnableItems]);\n    } else {\n      setCheckedArr([]);\n    }\n  };\n\n  const handleViewInvoice = async (\n    id: string,\n    status: string | number,\n    invoiceCompanyId: string,\n  ) => {\n    try {\n      const invoicePay =\n        Number(invoiceCompanyId) === Number(currentCompanyId)\n          ? invoicePayPermission\n          : invoiceSubPayPermission;\n      setIsRequestLoading(true);\n      const isPayNow = purchasabilityPermission && invoicePay && status !== 2;\n      const pdfUrl = await handlePrintPDF(id, isPayNow);\n\n      if (!pdfUrl) {\n        snackbar.error(b3Lang('invoice.pdfUrlResolutionError'));\n        return;\n      }\n\n      const { href } = window.location;\n      if (!href.includes('invoice')) {\n        return;\n      }\n\n      window.open(pdfUrl, '_blank', 'fullscreen=yes');\n    } catch (err) {\n      b2bLogger.error(err);\n    } finally {\n      setIsRequestLoading(false);\n    }\n  };\n\n  const handleSetSelectedInvoiceAccount = (newPrice: number | string, invoiceId: string) => {\n    const currentOriginInvoice = checkedArr.find((invoice: InvoiceListNode) => {\n      const {\n        node: { id },\n      } = invoice;\n\n      return Number(id) === Number(invoiceId);\n    });\n\n    if (selectedPay.length > 0) {\n      const newInvoices = selectedPay.map((selectedItem: InvoiceListNode) => {\n        const {\n          node: { id, openBalance },\n        } = selectedItem;\n        const {\n          node: { openBalance: currentOriginOpenBalance },\n        } = currentOriginInvoice;\n\n        if (Number(id) === Number(invoiceId)) {\n          openBalance.value =\n            Number(currentOriginOpenBalance.value) < Number(newPrice)\n              ? currentOriginOpenBalance.value\n              : newPrice;\n        }\n\n        return selectedItem;\n      });\n\n      setSelectedPay(newInvoices);\n    }\n  };\n\n  const handleExportInvoiceAsCSV = async () => {\n    try {\n      setIsRequestLoading(true);\n      const filtering = filterData ? isFiltering(filterData) : false;\n      const currentCheckedArr = filtering\n        ? filterLists.filter((item: InvoiceListNode) =>\n            checkedArr.some((item2: InvoiceListNode) => item?.node?.id === item2?.node?.id),\n          )\n        : checkedArr;\n\n      const invoiceNumber = currentCheckedArr.map((item: InvoiceListNode) => item.node.id);\n      const invoiceStatus = filterData?.status ? [Number(filterData.status)] : [];\n\n      let orderByFiled = '-invoice_number';\n      if (filterData?.orderBy) {\n        const orderByStr = String(filterData.orderBy);\n        orderByFiled = orderByStr.includes('-')\n          ? `-${exportOrderByArr[orderByStr.split('-')[1]]}`\n          : exportOrderByArr[orderByStr];\n      }\n\n      const invoiceFilterData = {\n        search: filterData?.q || '',\n        idIn: `${invoiceNumber || ''}`,\n        orderNumber: '',\n        beginDateAt: filterData?.beginDateAt || null,\n        endDateAt: filterData?.endDateAt || null,\n        status: invoiceStatus,\n        orderBy: orderByFiled,\n        companyIds: filterData?.companyIds || [],\n      };\n\n      const { invoicesExport } = await exportInvoicesAsCSV({\n        invoiceFilterData,\n        lang: bcLanguage || 'en',\n      });\n\n      if (invoicesExport?.url) {\n        window.open(invoicesExport?.url, '_blank');\n      }\n    } catch (err) {\n      b2bLogger.error(err);\n    } finally {\n      setIsRequestLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    const newInitFilter = {\n      ...initFilter,\n      companyIds: [Number(selectCompanyHierarchyId) || Number(currentCompanyId)],\n    };\n    if (location?.search) {\n      const params = new URLSearchParams(location.search);\n      const getInvoiceId = params.get('invoiceId') || '';\n      const getReceiptId = params.get('receiptId') || '';\n\n      if (getInvoiceId) {\n        setFilterData({\n          ...newInitFilter,\n          q: getInvoiceId,\n        });\n        setType(InvoiceListType.DETAIL);\n      }\n\n      if (getReceiptId) {\n        // open Successful page\n        setType(InvoiceListType.CHECKOUT);\n        setFilterData({\n          ...newInitFilter,\n        });\n        setReceiptId(getReceiptId);\n      }\n    } else {\n      setType(InvoiceListType.NORMAL);\n      setFilterData({\n        ...newInitFilter,\n      });\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [location, selectCompanyHierarchyId]);\n\n  const handleSelectCompanies = (company: number[]) => {\n    const newCompanyIds = company.includes(-1) ? [] : company;\n    setFilterData({\n      ...filterData,\n      companyIds: newCompanyIds,\n    });\n\n    setSelectAllPay(\n      company.includes(currentCompanyId) || company.includes(-1)\n        ? invoicePayPermission\n        : invoiceSubPayPermission,\n    );\n  };\n\n  useEffect(() => {\n    const selectedInvoice =\n      checkedArr.filter((item: InvoiceListNode) => {\n        const {\n          node: { openBalance },\n        } = item;\n\n        return Number(openBalance.value) !== 0;\n      }) || [];\n\n    if (selectedInvoice.length > 0) {\n      if (selectedPay.length === 0) {\n        setSelectedPay(cloneDeep(selectedInvoice));\n      } else {\n        const newArr = selectedInvoice.map((checkedItem: InvoiceListNode) => {\n          const {\n            node: { id, openBalance },\n          } = checkedItem;\n\n          const currentSelectedItem = selectedPay.find((item: InvoiceListNode) => {\n            const {\n              node: { id: selectedId },\n            } = item;\n\n            return Number(id) === Number(selectedId);\n          });\n\n          if (currentSelectedItem) {\n            const {\n              node: { openBalance: currentOpenBalance },\n            } = currentSelectedItem;\n\n            openBalance.value = currentOpenBalance.value;\n          }\n\n          return checkedItem;\n        });\n\n        setSelectedPay(cloneDeep(newArr));\n      }\n    } else {\n      setSelectedPay([]);\n    }\n    // ignore selectedPay cause it will trigger an useEffect loop\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [checkedArr]);\n\n  const fetchList: GetRequestList<Partial<FilterSearchProps>, InvoiceList> = async (params) => {\n    const {\n      invoices: { edges, totalCount },\n    } = await getInvoiceList(params);\n\n    const invoicesList: InvoiceListNode[] = edges;\n\n    if (type === InvoiceListType.DETAIL && invoicesList.length) {\n      invoicesList.forEach((invoice: InvoiceListNode) => {\n        const item = invoice;\n        item.node.isCollapse = true;\n      });\n    }\n\n    invoicesList.forEach((invoiceNode: InvoiceListNode) => {\n      const {\n        node: { openBalance },\n      } = invoiceNode;\n      const item = invoiceNode;\n      item.node.disableCurrentCheckbox = false;\n\n      openBalance.originValue = `${Number(openBalance.value)}`;\n      openBalance.value = formattingNumericValues(Number(openBalance.value), decimalPlaces);\n\n      item.node.disableCurrentCheckbox = Number(openBalance.value) === 0;\n\n      const { companyInfo } = item.node;\n      if (Number(companyInfo.companyId) !== Number(currentCompanyId)) {\n        item.node.disableCurrentCheckbox =\n          !invoiceSubPayPermission || Number(openBalance.value) === 0;\n      }\n    });\n    setList(invoicesList);\n    handleStatisticsInvoiceAmount();\n\n    if (filterData && isFiltering(filterData) && invoicesList.length) {\n      cacheFilterLists(invoicesList);\n    } else {\n      setFilterLists([]);\n    }\n\n    return {\n      edges: invoicesList,\n      totalCount,\n    };\n  };\n\n  const handleSetSelectedInvoiceAccountNumber = (val: string, id: string) => {\n    let result = val;\n    if (val.includes('.')) {\n      const wholeDecimalNumber = val.split('.');\n      const movePoint =\n        decimalPlaces === 0 ? 0 : wholeDecimalNumber[1].length - Number(decimalPlaces);\n      if (wholeDecimalNumber[1] && movePoint > 0) {\n        const newVal = wholeDecimalNumber[0] + wholeDecimalNumber[1];\n        result = `${newVal.slice(0, -decimalPlaces)}.${newVal.slice(-decimalPlaces)}`;\n      }\n      if (wholeDecimalNumber[1] && movePoint === 0) {\n        result = formattingNumericValues(Number(val), decimalPlaces);\n      }\n    } else if (result.length > 1) {\n      result = `${val.slice(0, 1)}.${val.slice(-1)}`;\n      if (Number(decimalPlaces) === 0) result = val;\n    } else {\n      result = val;\n    }\n\n    handleSetSelectedInvoiceAccount(result, id);\n  };\n\n  const columnAllItems: TableColumnItem<InvoiceList>[] = [\n    {\n      key: 'id',\n      title: b3Lang('invoice.headers.invoice'),\n      isSortable: true,\n      render: (item: InvoiceList) => (\n        <Box\n          sx={{\n            color: '#000000',\n            cursor: 'pointer',\n            ':hover': {\n              textDecoration: 'underline',\n            },\n          }}\n          onClick={() => {\n            const companyInfo = item?.companyInfo || {};\n            handleViewInvoice(item.id, item.status, companyInfo?.companyId);\n          }}\n        >\n          {item?.invoiceNumber ? item?.invoiceNumber : item?.id}\n        </Box>\n      ),\n      width: '8%',\n    },\n    {\n      key: 'companyInfo',\n      title: b3Lang('invoice.headers.companyName'),\n      isSortable: false,\n      render: (item: InvoiceList) => {\n        const { companyName } = item?.companyInfo || {};\n\n        return <Box>{companyName}</Box>;\n      },\n      width: '15%',\n    },\n    {\n      key: 'orderNumber',\n      title: b3Lang('invoice.headers.order'),\n      isSortable: true,\n      render: (item: InvoiceList) => (\n        <Box\n          sx={{\n            color: '#000000',\n            cursor: 'pointer',\n            ':hover': {\n              textDecoration: 'underline',\n            },\n          }}\n          onClick={() => {\n            navigate(`/orderDetail/${item.orderNumber}`);\n          }}\n        >\n          {item?.orderNumber || '-'}\n        </Box>\n      ),\n      width: '12%',\n    },\n    {\n      key: 'createdAt',\n      title: b3Lang('invoice.headers.invoiceDate'),\n      isSortable: true,\n      render: (item: InvoiceList) =>\n        `${item.createdAt ? displayFormat(Number(item.createdAt)) : '–'}`,\n      width: '15%',\n    },\n    {\n      key: 'updatedAt',\n      title: b3Lang('invoice.headers.dueDate'),\n      isSortable: true,\n      render: (item: InvoiceList) => {\n        const { dueDate, status } = item;\n        const isOverdue = currentDate > dueDate * 1000 && status !== 2;\n\n        return (\n          <Typography\n            sx={{\n              color: isOverdue ? '#D32F2F' : 'rgba(0, 0, 0, 0.87)',\n              fontSize: '14px',\n            }}\n          >\n            {`${item.dueDate ? displayFormat(Number(item.dueDate)) : '–'}`}\n          </Typography>\n        );\n      },\n      width: '15%',\n    },\n    {\n      key: 'originalBalance',\n      title: b3Lang('invoice.headers.invoiceTotal'),\n      isSortable: true,\n      render: (item: InvoiceList) => {\n        const { originalBalance } = item;\n        const originalAmount = formattingNumericValues(\n          Number(originalBalance.value),\n          decimalPlaces,\n        );\n\n        const token = handleGetCorrespondingCurrencyToken(originalBalance.code);\n\n        return `${token}${originalAmount || 0}`;\n      },\n      width: '10%',\n    },\n    {\n      key: 'openBalance',\n      title: b3Lang('invoice.headers.amountDue'),\n      isSortable: true,\n      render: (item: InvoiceList) => {\n        const { openBalance } = item;\n\n        const openAmount = formattingNumericValues(Number(openBalance.value), decimalPlaces);\n        const token = handleGetCorrespondingCurrencyToken(openBalance.code);\n\n        return `${token}${openAmount || 0}`;\n      },\n      width: '10%',\n    },\n    {\n      key: 'openBalanceToPay',\n      title: b3Lang('invoice.headers.amountToPay'),\n      render: (item: InvoiceList) => {\n        const { openBalance, id } = item;\n        const currentCode = openBalance.code || 'USD';\n        let valuePrice = openBalance.value;\n        let disabled = true;\n\n        if (selectedPay.length > 0) {\n          const currentSelected = selectedPay.find((item: InvoiceListNode) => {\n            const {\n              node: { id: selectedId },\n            } = item;\n\n            return Number(selectedId) === Number(id);\n          });\n\n          if (currentSelected) {\n            const {\n              node: { openBalance: selectedOpenBalance },\n            } = currentSelected;\n\n            disabled = false;\n            valuePrice = selectedOpenBalance.value;\n\n            if (Number(openBalance.value) === 0) {\n              disabled = true;\n            }\n          }\n        }\n\n        return (\n          <TextField\n            disabled={disabled}\n            variant=\"filled\"\n            value={valuePrice || ''}\n            InputProps={{\n              startAdornment: (\n                <InputAdornment\n                  position=\"start\"\n                  sx={{ padding: '8px 0', marginTop: '0 !important' }}\n                >\n                  {handleGetCorrespondingCurrencyToken(currentCode)}\n                </InputAdornment>\n              ),\n            }}\n            sx={{\n              '& input': {\n                paddingTop: '8px',\n              },\n              '& input[type=\"number\"]::-webkit-inner-spin-button, & input[type=\"number\"]::-webkit-outer-spin-button':\n                {\n                  WebkitAppearance: 'none',\n                  margin: 0,\n                },\n            }}\n            onChange={(e: CustomFieldItems) => {\n              const val = e.target?.value;\n              handleSetSelectedInvoiceAccountNumber(val, id);\n            }}\n            type=\"number\"\n          />\n        );\n      },\n      width: '15%',\n    },\n    {\n      key: 'status',\n      title: b3Lang('invoice.headers.status'),\n      isSortable: true,\n      render: (item: InvoiceList) => {\n        const { status, dueDate } = item;\n        let code = item.status;\n\n        // (3, \"Overdue\")-【Display status when invoice exceeds due date. For front-end display only】\n        if (status === 0 && currentDate > dueDate * 1000) {\n          code = 3;\n        }\n\n        return <InvoiceStatus code={code} />;\n      },\n    },\n    {\n      key: 'companyName',\n      title: b3Lang('invoice.headers.action'),\n      render: (row: InvoiceList) => {\n        const { id, companyInfo } = row;\n        let actionRow = row;\n        if (selectedPay.length > 0) {\n          const currentSelected = selectedPay.find((item: InvoiceListNode) => {\n            const {\n              node: { id: selectedId },\n            } = item;\n\n            return Number(selectedId) === Number(id);\n          });\n\n          if (currentSelected) {\n            actionRow = currentSelected.node;\n          }\n        }\n\n        return (\n          <B3Pulldown\n            row={actionRow}\n            setInvoiceId={setCurrentInvoiceId}\n            handleOpenHistoryModal={setIsOpenHistory}\n            setIsRequestLoading={setIsRequestLoading}\n            isCurrentCompany={Number(currentCompanyId) === Number(companyInfo.companyId)}\n            invoicePay={\n              Number(currentCompanyId) === Number(companyInfo.companyId)\n                ? invoicePayPermission\n                : invoiceSubPayPermission\n            }\n          />\n        );\n      },\n      width: '10%',\n    },\n  ];\n\n  useEffect(() => {\n    let exportCsvTexts = b3Lang('invoice.exportCsvText');\n\n    const filtering = filterData ? isFiltering(filterData) : false;\n    const currentCheckedArr = filtering\n      ? filterLists.filter((item: InvoiceListNode) =>\n          checkedArr.some((item2: InvoiceListNode) => item?.node?.id === item2?.node?.id),\n        )\n      : checkedArr;\n\n    if (filtering) {\n      exportCsvTexts =\n        currentCheckedArr.length > 0\n          ? b3Lang('invoice.exportSelectedAsCsv')\n          : b3Lang('invoice.exportFilteredAsCsv');\n    } else {\n      exportCsvTexts =\n        currentCheckedArr.length > 0\n          ? b3Lang('invoice.exportSelectedAsCsv')\n          : b3Lang('invoice.exportCsvText');\n    }\n\n    setExportCsvText(exportCsvTexts);\n    // disabling because of b3lang rendering errors\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [checkedArr, filterData, filterLists]);\n\n  const translatedFilterFormConfigs = filterFormConfig.map((element) => {\n    const config = element;\n    if (element.name === 'status') {\n      config.label = b3Lang(filterFormConfigsTranslationVariables.status);\n    }\n\n    config.options = element.options.map((option) => {\n      const elementOption = option;\n      elementOption.label = b3Lang(filterFormConfigsTranslationVariables[option.key]);\n\n      return option;\n    });\n\n    return element;\n  });\n\n  return (\n    <B3Spin isSpinning={isRequestLoading}>\n      <Box\n        sx={{\n          overflowX: 'auto',\n          display: 'flex',\n          flexDirection: 'column',\n          flex: 1,\n          position: 'relative',\n        }}\n      >\n        <Box\n          sx={{\n            display: 'flex',\n            justifyContent: 'space-between',\n            alignItems: isMobile ? 'flex-start' : 'center',\n            flexDirection: isMobile ? 'column' : 'row',\n          }}\n        >\n          <Box\n            sx={{\n              display: 'flex',\n              justifyContent: 'space-between',\n              alignItems: isMobile ? 'flex-start' : 'center',\n              flexDirection: isMobile ? 'column' : 'row',\n              width: isMobile ? '100%' : 'auto',\n\n              '& > div': {\n                width: isMobile ? '100%' : 'auto',\n              },\n            }}\n          >\n            {isEnabledCompanyHierarchy && invoiceSubViewPermission && (\n              <Box\n                sx={{\n                  mr: isMobile ? 0 : '10px',\n                  mb: '30px',\n                }}\n              >\n                <B2BAutoCompleteCheckbox handleChangeCompanyIds={handleSelectCompanies} />\n              </Box>\n            )}\n            <B3Filter\n              filterMoreInfo={translatedFilterFormConfigs}\n              handleChange={handleChange}\n              handleFilterChange={handleFilterChange}\n              startPicker={{\n                isEnabled: true,\n                label: b3Lang('invoice.filter.from'),\n                defaultValue:\n                  typeof filterData?.beginDateAt === 'number'\n                    ? Number(filterData.beginDateAt) * 1000\n                    : '',\n                pickerKey: 'start',\n              }}\n              endPicker={{\n                isEnabled: true,\n                label: b3Lang('invoice.filter.to'),\n                defaultValue:\n                  typeof filterData?.endDateAt === 'number'\n                    ? Number(filterData.endDateAt) * 1000\n                    : '',\n                pickerKey: 'end',\n              }}\n              searchValue={filterData?.q || ''}\n              pcContainerWidth=\"36rem\"\n              pcSearchContainerWidth=\"80%\"\n            />\n          </Box>\n          <Box\n            sx={{\n              display: 'flex',\n              marginBottom: '30px',\n              flexDirection: document.body.clientWidth <= 465 ? 'column' : 'row',\n            }}\n          >\n            <Typography\n              sx={{\n                fontSize: '24px',\n                color: '#000000',\n              }}\n            >\n              {b3Lang('invoice.openUnpaid', {\n                unpaid: currencyFormat(unpaidAmount),\n              })}\n            </Typography>\n            {document.body.clientWidth >= 465 && (\n              <Typography\n                sx={{\n                  fontSize: '24px',\n                  margin: '0 8px',\n                }}\n              >\n                |\n              </Typography>\n            )}\n            <Typography\n              sx={{\n                fontSize: '24px',\n                color: '#D32F2F',\n              }}\n            >\n              {b3Lang('invoice.overdueAmount', {\n                overdue: currencyFormat(overdueAmount),\n              })}\n            </Typography>\n          </Box>\n        </Box>\n        <B3PaginationTable\n          ref={paginationTableRef}\n          columnItems={columnAllItems}\n          rowsPerPageOptions={[10, 20, 30]}\n          getRequestList={fetchList}\n          searchParams={filterData}\n          isCustomRender={false}\n          requestLoading={setIsRequestLoading}\n          tableKey=\"id\"\n          showCheckbox={selectAllPay && purchasabilityPermission}\n          showSelectAllCheckbox={!isMobile && selectAllPay && purchasabilityPermission}\n          disableCheckbox={false}\n          applyAllDisableCheckbox={false}\n          getSelectCheckbox={getSelectCheckbox}\n          CollapseComponent={PrintTemplate}\n          sortDirection={order}\n          orderBy={orderBy}\n          sortByFn={handleSetOrderBy}\n          isSelectOtherPageCheckbox\n          hover\n          isAutoRefresh={false}\n          renderItem={(row, index, checkBox) => (\n            <InvoiceItemCard\n              item={row}\n              checkBox={checkBox}\n              handleSetSelectedInvoiceAccount={handleSetSelectedInvoiceAccountNumber}\n              handleViewInvoice={handleViewInvoice}\n              setIsRequestLoading={setIsRequestLoading}\n              setInvoiceId={setCurrentInvoiceId}\n              handleOpenHistoryModal={setIsOpenHistory}\n              selectedPay={selectedPay}\n              handleGetCorrespondingCurrency={handleGetCorrespondingCurrencyToken}\n              addBottom={list.length - 1 === index}\n              isCurrentCompany={Number(currentCompanyId) === Number(row.companyInfo.companyId)}\n              invoicePay={\n                Number(currentCompanyId) === Number(row.companyInfo.companyId)\n                  ? invoicePayPermission\n                  : invoiceSubPayPermission\n              }\n            />\n          )}\n        />\n        {list.length > 0 && !isMobile && (\n          <Box\n            sx={{\n              position: 'absolute',\n              bottom: '8px',\n              left: '20px',\n            }}\n          >\n            <Button variant=\"text\" onClick={handleExportInvoiceAsCSV}>\n              {exportCsvText}\n            </Button>\n          </Box>\n        )}\n      </Box>\n      {selectedPay.length > 0 &&\n        (((invoicePayPermission || invoiceSubPayPermission) && purchasabilityPermission) ||\n          isAgenting) && <InvoiceFooter selectedPay={selectedPay} decimalPlaces={decimalPlaces} />}\n      <PaymentsHistory\n        open={isOpenHistory}\n        currentInvoiceId={currentInvoiceId}\n        setOpen={setIsOpenHistory}\n      />\n      <PaymentSuccess receiptId={Number(receiptId)} type={type} />\n    </B3Spin>\n  );\n}\n\nexport default Invoice;\n"],"names":["analyzePDFUrl","url","resolve","reject","res","response","blob","invoicePDFUrl","e","getInvoiceDownloadPDFUrl","invoiceId","isPayNow","invoiceDownloadPDF","handlePrintPDF","error","StyledMenu","styled","Menu","B3Pulldown","row","setIsRequestLoading","setInvoiceId","handleOpenHistoryModal","isCurrentCompany","invoicePay","platform","useAppSelector","global","ref","useRef","isOpen","setIsOpen","useState","isPay","setIsPay","navigate","useNavigate","b3Lang","useB3Lang","invoicePayPermission","purchasabilityPermission","rolePermissionSelector","getOrderPermissionCode","b2bPermissionsMap","isCanViewOrder","setIsCanViewOrder","close","handleMoreActionsClick","id","handleViewInvoice","pdfUrl","snackbar","href","handleViewOrder","orderNumber","handlePay","openBalance","originalBalance","params","gotoInvoiceCheckoutUrl","viewPaymentHistory","handleDownloadPDF","a","useEffect","orderUserId","companyInfo","payPermissions","viewOrderPermission","verifyLevelPermission","jsxs","Fragment","jsx","IconButton","MoreHorizIcon","MenuItem","InvoiceFooter","props","isMobile","useMobile","selectedAccount","setSelectedAccount","currentToken","setCurrentToken","isAgenting","b2bFeatures","containerStyle","selectedPay","decimalPlaces","lineItems","currency","item","currentValue","formattingNumericValues","handleStatisticsInvoiceAmount","checkedArr","amount","token","handleGetCorrespondingCurrencyToken","Grid","Box","Typography","Button","InvoiceStatus","code","status","B3Tag","Title","title","HistoryList","list","createdAt","paymentType","transactionType","referenceNumber","Card","CardContent","displayFormat","handleGetCorrespondingCurrency","PaymentsHistory","open","setOpen","currentInvoiceId","loading","setLoading","setList","edges","getInvoicePaymentHistory","B3Dialog","B3Spin","B3NoData","InvoiceListType","invoiceStatus","filterFormConfig","filterFormConfigsTranslationVariables","defaultSortKey","sortIdArr","exportOrderByArr","withColon","Row","isRow","type","value","label","getNewVal","val","PaymentSuccessList","details","comment","_a","paymentSuccessKeys","invoiceNumber","accountValue","PaymentSuccess","receiptId","detailData","setDetailData","init","receipt","getInvoicePaymentInfo","handleCloseClick","customActions","templateMinHeight","PrintTemplate","container","dom","height","setHeight","onFirstBoxResize","_","size","PDFObject","Resizable","_b","StyleCheckoutContainer","InvoiceItemCard","currentDate","checkBox","handleSetSelectedInvoiceAccount","addBottom","dueDate","currentCode","currentCurrencyToken","statusCode","columnAllItems","isOverdue","originalAmount","currencyFormat","openAmount","valuePrice","disabled","currentSelected","selectedId","selectedOpenBalance","TextField","InputAdornment","initFilter","useData","role","company","companyInfoId","selectCompanyHierarchyId","isEnabledCompanyHierarchy","salesRepCompanyId","currentCompanyId","CustomerRole","invoiceSubViewPermission","Invoice","paginationTableRef","currencyFormatInfo","isRequestLoading","isOpenHistory","setIsOpenHistory","setCurrentInvoiceId","setReceiptId","setType","unpaidAmount","setUnpaidAmount","overdueAmount","setOverdueAmount","setCheckedArr","setSelectedPay","filterData","setFilterData","exportCsvText","setExportCsvText","filterChangeFlag","setFilterChangeFlag","filterLists","setFilterLists","selectAllPay","setSelectAllPay","invoiceSubPayPermission","validatePermissionWithComparisonType","permissionLevels","bcLanguage","useContext","GlobalContext","handleSetOrderBy","order","orderBy","useSort","location","useLocation","isFiltering","key","cacheFilterLists","copyCacheFilterList","option","cache","invoiceStats","getInvoiceStats","overDueBalance","totalBalance","err","b2bLogger","handleChange","handleFilterChange","startValue","getUTCTimestamp","endValue","search","getSelectCheckbox","selectCheckbox","productList","newEnableItems","product","node","invoiceCompanyId","newPrice","currentOriginInvoice","invoice","newInvoices","selectedItem","currentOriginOpenBalance","handleExportInvoiceAsCSV","item2","orderByFiled","orderByStr","invoiceFilterData","invoicesExport","exportInvoicesAsCSV","newInitFilter","getInvoiceId","getReceiptId","handleSelectCompanies","newCompanyIds","selectedInvoice","cloneDeep","newArr","checkedItem","currentSelectedItem","currentOpenBalance","fetchList","totalCount","getInvoiceList","invoicesList","invoiceNode","handleSetSelectedInvoiceAccountNumber","result","wholeDecimalNumber","movePoint","newVal","companyName","actionRow","exportCsvTexts","filtering","currentCheckedArr","translatedFilterFormConfigs","element","config","elementOption","B2BAutoCompleteCheckbox","B3Filter","B3PaginationTable","index"],"mappings":"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"}