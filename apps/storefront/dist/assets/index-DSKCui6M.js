import{j as t,K as Ie,ad as ne,B as g,T as F,ag as Kt,G as pt,a0 as Yt,w as Rt,W as ve,X as Te,s as Ot,f as _t,y as Ae}from"./mui-DDntJqep.js";import{r as c}from"./reactVendor-BTcQ-GDs.js";import{u as jt}from"./lang-o717ABxZ.js";import{a as vt,cb as we,u as et,ad as kt,b8 as Ne,b6 as $t,aO as Be,aP as Oe,af as D,c3 as De,a0 as Dt,aY as oe,ab as Jt,ac as re,bn as Gt,aN as Qt,aw as It,bp as Xt,cc as ae,aS as ce,e as le,a1 as de,G as pe,x as qe,a_ as ue,a$ as he,b0 as ge,b2 as Ee,b3 as Fe,b4 as me,b5 as Re,aQ as Qe,aR as Ve,bw as Ue,b1 as Me,bx as $e,cd as ze,C as He,am as zt,ce as _e,ar as Ht,k as Je,bg as Et,ak as Ge,aZ as We,cf as Zt,cg as te,aj as Ke,t as Ye,ch as Xe,c5 as Ze,c6 as ts,ag as es,ci as ss,cj as is,ck as ns,cl as os}from"./react-setup-BZUAuJbV.js";import"./load-functions-KyGF85Ss.js";import{b as rs}from"./base-BCVDEF8S.js";import{d as as}from"./useB2BCallback-DOyIFx1A.js";import{a as xe,S as cs,d as ls,C as ds,b as ps}from"./SearchProduct-DYcfuS_r.js";import{u as us}from"./useBlockPendingAccountViewPrice-CRiD_yUB.js";import{Q as hs}from"./QuickAdd-Ch-h1jvv.js";import{s as Bt}from"./B3LinkTipContent-B_1mlBLe.js";import{b as Ft}from"./b3TriggerCartNumber-_CGqvuUF.js";import{e as Vt,d as gs,A as ms,h as fe,E as Se}from"./muiIcon-CopSbzbS.js";import{S as xs}from"./ShoppingStatus-BVDXi2KL.js";import{u as be,c as fs}from"./router-DEI8QtBD.js";import{f as Ss}from"./lodashEs-DKEtmQJE.js";import{b as Le}from"./b2bGetVariantImageByVariantInfo-BskJ2qQo.js";import{u as bs}from"./useSort-CwDaxthI.js";import{B as Ls}from"./B3FilterSearch-DJY7cQ6l.js";import"./intl-CKipw3rV.js";import"./eCache-BdHG5F0B.js";import"./redux-D7_Lh1Zo.js";import"./toolkit-C5fVsw89.js";import"../index.DCYrHh9G.js";import"./global-D7Yn0gGb.js";import"./dateFns-CHpGt2JZ.js";import"./dropzone-CFnPmSOi.js";import"./form-hNmOEDBo.js";import"./B3CustomForm-DbCZxrBC.js";function ys(f){const[n]=vt(),{disabled:i=!1,label:s=n?"Qty":"",value:o="",maxQuantity:p=0,minQuantity:m=0,isStock:b="0",stock:O=0,hiddenLabel:x=!n,onChange:q=()=>{},sx:J={width:n?"110px":"72px","& .MuiFormHelperText-root":{marginLeft:"0",marginRight:"0"}}}=f,[Q,E]=c.useState(""),k=c.useCallback(S=>{const l=parseInt("".concat(S),10)||0;let a="";return b==="1"&&O===0?a="Out of stock":b==="1"&&l>O?a="".concat(O," in stock"):m!==0&&l<m?a="Min is ".concat(m):p!==0&&l>p&&(a="Max is ".concat(p)),E(a),a},[b,p,m,O]),L=S=>{q(S,!!Q)},y=()=>{const S=parseInt("".concat(o),10)||0;q(S,!k(S))};return c.useEffect(()=>{k(o)},[k,o]),t.jsx(we,{size:"small",type:"number",variant:"filled",disabled:i,hiddenLabel:x,label:s,value:o,error:!!Q,helperText:Q,inputProps:{inputMode:"numeric",pattern:"[0-9]*"},onChange:S=>{L(S.target.value)},onBlur:()=>{y()},sx:J})}function Cs(f){const{state:{id:n}}=c.useContext(xe),i=et(({company:l})=>l.companyInfo.status),{updateList:s,isB2BUser:o,type:p=""}=f,m=jt(),[b,O]=c.useState(!1),[x,q]=c.useState(!1),[J]=us(),Q=o?Be:Oe,E=async l=>{try{if(!as("on-add-to-shopping-list",l))throw new Error;const a=l.map(r=>({optionList:$t(r.newSelectOptionList,r),productId:r.id,quantity:r.quantity,variantId:r.variantId})),w=await Q({shoppingListId:n,items:a});return D.success(m("shoppingList.addToShoppingList.productsAdded"),{isClose:!0}),w}catch(a){a.message.length>0&&D.error(a.message,{isClose:!0})}return!0},k=async l=>{const a=l.map(r=>({optionList:$t(r.newSelectOptionList||r.optionList,(r==null?void 0:r.products)||r)||[],productId:parseInt(r.productId,10)||0,quantity:r.quantity,variantId:parseInt(r.variantId,10)||0})),w=await Q({shoppingListId:n,items:a});return D.success(m("shoppingList.addToShoppingList.productsAdded"),{isClose:!0}),w},L=l=>{const a=[],w=[],r=[];return l.forEach(u=>{const{products:h,qty:$}=u,{option:d,purchasingDisabled:T,variantSku:V,variantId:G,productId:nt,modifiers:rt}=h,z=De(rt);if(T&&p!=="shoppingList"){a.push(V);return}if(z.filter(N=>!N.isVerified).length>0){r.push(V);return}const Y=d.map(N=>({optionId:"attribute[".concat(N.option_id,"]"),optionValue:N.id.toString()}));z.forEach(N=>{const{type:ot}=N;if(ot==="date"){const{defaultValue:X}=N;Object.keys(X).forEach(H=>{Y.push({optionId:"attribute[".concat(N.option_id,"][").concat(H,"]"),optionValue:"".concat(N.defaultValue[H])})})}else Y.push({optionId:"attribute[".concat(N.option_id,"]"),optionValue:"".concat(N.defaultValue)})}),w.push({productId:parseInt(nt,10)||0,variantId:parseInt(G,10)||0,quantity:Number($),optionList:Y,products:u.products})}),{notPurchaseSku:a,productItems:w,notAddAble:r}},y=async l=>{q(!0);try{const{validProduct:a}=l,{notPurchaseSku:w,productItems:r,notAddAble:u}=L(a);r.length>0&&(await k(r),s()),u.length>0&&p!=="shoppingList"&&D.error(m("shoppingList.addToShoppingList.skuNotAddable",{notAddAble:u.join(", ")}),{isClose:!0}),w.length>0&&p!=="shoppingList"&&D.error(m("shoppingList.addToShoppingList.skuNotPurchasable",{notPurchaseSku:w.join(", ")}),{isClose:!0}),O(!1)}finally{q(!1)}},S=()=>{J&&i===0?D.info("Your business account is pending approval. This feature is currently disabled."):O(!0)};return t.jsx(Ie,{sx:{marginBottom:"50px"},children:t.jsx(ne,{children:t.jsxs(g,{children:[t.jsx(F,{variant:"h5",children:m("shoppingList.addToShoppingList.addToList")}),t.jsx(cs,{updateList:s,addToList:E,isB2BUser:o,type:"shoppingList"}),t.jsx(Kt,{}),t.jsx(hs,{type:"shoppingList",updateList:s,quickAddToList:k}),t.jsx(Kt,{}),t.jsx(g,{sx:{margin:"20px 0 0"},children:t.jsxs(kt,{variant:"text",onClick:()=>S(),children:[t.jsx(ls,{sx:{marginRight:"8px"}}),m("shoppingList.addToShoppingList.bulkUploadCsv")]})}),t.jsx(Ne,{isOpen:b,setIsOpen:O,handleAddToList:y,isLoading:x,withModifiers:!0})]})})})}const ee=Rt("div")(({isHeader:f,isMobile:n})=>({display:"flex",wordBreak:"break-word",padding:"8px 0 0",gap:"8px",flexWrap:n?"wrap":"initial",...f?{borderBottom:"1px solid #D9DCE9",paddingBottom:"8px",alignItems:"center"}:{alignItems:"flex-start"},...n?{borderTop:"1px solid #D9DCE9",padding:"12px 0 12px","&:first-of-type":{marginTop:"12px"}}:{}})),yt=Rt(g)(({width:f,padding:n="0",flexBasis:i,flexDirection:s="row",alignItems:o,textAlignLocation:p})=>({display:"flex",justifyContent:p==="right"?"flex-end":"flex-start",flexDirection:s,flexGrow:f?0:1,flexShrink:f?0:1,alignItems:o||"flex-start",flexBasis:i,width:f,padding:n})),Nt=Rt("div")(()=>({fontSize:"0.875rem",lineHeight:"1.5",color:"#263238"})),Ps=Rt("img")(()=>({width:"60px",borderRadius:"4px",flexShrink:0})),js={default:{width:"15%"},delete:{width:"30px"}},ks={default:{width:"100%",padding:"0 0 0 76px"},delete:{width:"100%",padding:"0 0 0 76px",display:"flex",flexDirection:"row-reverse"}};function Is(f){const{shoppingListInfo:n,products:i,successProducts:s,allowJuniorPlaceOrder:o,setValidateFailureProducts:p,setValidateSuccessProducts:m,textAlign:b="left"}=f,{submitShoppingListPermission:O}=et(Dt),x=jt(),[q,J]=c.useState(!1),[Q,E]=c.useState(!1),[k]=vt(),{decimal_places:L=2}=et(oe);c.useEffect(()=>{i.length>0?J(!0):J(!1)},[i]);const y=k?ks:js,S=async(u,h,$)=>{const d=[...i];d[u].node.quantity=Number(h),d[u].isValid=$;const T=await Xt(d[u].node,Number(h));T&&(d[u].node=T,p(d))},l=()=>{J(!1),p([]),m([])},a=u=>{const h=[...i];h.splice(u,1),p(h)},w=async()=>{if(!i.every(h=>h.isValid)){D.error(x("shoppingList.reAddToCart.fillCorrectQuantity"));return}try{E(!0);const h=ae(i),$=await ce(h);$.errors||(l(),o&&O&&(n==null?void 0:n.status)===0?window.location.href=le:(D.success("",{jsx:Bt({message:x("shoppingList.reAddToCart.productsAdded"),link:de,linkText:x("shoppingList.reAddToCart.viewCart"),isOutLink:!0,isCustomEvent:!0}),isClose:!0}),Ft())),$.errors&&D.error($.message,{isClose:!0}),Ft()}finally{E(!1)}},r=async()=>{const u=i.filter(d=>d.isStock==="0"||d.stock!==0),h=[];u.forEach(d=>{var N;const T=d,{node:{quantity:V},minQuantity:G=0,maxQuantity:nt=0,isStock:rt,stock:z}=d,W=parseInt("".concat(V),10)||0;G!==0&&W<G?T.node.quantity=G:nt!==0&&W>nt&&(T.node.quantity=nt),rt!=="0"&&z&&(V?Number(V):0)>z&&(T.node.quantity=z),T.isValid=!0;const Y=(N=d==null?void 0:d.node)!=null&&N.quantity?Number(d.node.quantity):0;h.push(Xt(d.node,Y))}),(await Promise.all(h)).forEach((d,T)=>{u[T].node=d}),p(u)};return t.jsx(Jt,{isOpen:q,handleLeftClick:l,handRightClick:w,title:x(o?"shoppingList.reAddToCart.proceedToCheckout":"shoppingList.reAddToCart.addToCart"),rightSizeBtn:x(o?"shoppingList.reAddToCart.proceedToCheckout":"shoppingList.reAddToCart.addToCart"),maxWidth:"xl",children:t.jsxs(pt,{children:[t.jsx(g,{sx:{m:"0 0 1rem 0"},children:t.jsx(Yt,{variant:"filled",severity:"success",children:o?x("shoppingList.reAddToCart.productsCanCheckout",{successProducts:s}):x("shoppingList.reAddToCart.productsAddedToCart",{successProducts:s})})}),t.jsx(g,{sx:{m:"1rem 0"},children:t.jsx(Yt,{variant:"filled",severity:"error",children:o?x("shoppingList.reAddToCart.productsCantCheckout",{quantity:i.length}):x("shoppingList.reAddToCart.productsNotAddedToCart",{quantity:i.length})})}),t.jsxs(re,{isSpinning:Q,size:16,isFlex:!1,children:[t.jsxs(g,{sx:{display:"flex",justifyContent:"space-between",margin:"0.5rem 0 1rem 0"},children:[t.jsx(g,{sx:{fontSize:"24px"},children:x("shoppingList.reAddToCart.productCount",{quantity:i.length})}),t.jsx(kt,{onClick:()=>r(),children:x("shoppingList.reAddToCart.adjustQuantity")})]}),i.length>0?t.jsxs(g,{children:[!k&&t.jsxs(ee,{isHeader:!0,isMobile:k,children:[t.jsx(yt,{children:t.jsx(Nt,{children:x("shoppingList.reAddToCart.product")})}),t.jsx(yt,{...y.default,textAlignLocation:b,children:t.jsx(Nt,{children:x("shoppingList.reAddToCart.price")})}),t.jsx(yt,{sx:{justifyContent:"center"},...y.default,textAlignLocation:b,children:t.jsx(Nt,{children:x("shoppingList.reAddToCart.quantity")})}),t.jsx(yt,{...y.default,textAlignLocation:b,children:t.jsx(Nt,{children:x("shoppingList.reAddToCart.total")})}),t.jsx(yt,{...y.delete,children:t.jsx(Nt,{children:" "})})]}),i.map((u,h)=>{const{isStock:$,maxQuantity:d,minQuantity:T,stock:V}=u,{quantity:G=1,primaryImage:nt,productName:rt,variantSku:z,optionList:W,productsSearch:Y,basePrice:N}=u.node,ot=Number(N),X=(ot*(G?Number(G):0)).toFixed(L),H={...Y,selectOptions:W},ct=Gt(H,{}),C=JSON.parse(W),st=ct.filter(R=>R.valueText);return t.jsxs(ee,{isMobile:k,children:[t.jsxs(yt,{children:[t.jsx(Ps,{src:nt||Qt}),t.jsxs(g,{sx:{marginLeft:"16px"},children:[t.jsx(F,{variant:"body1",color:"#212121",children:rt}),t.jsx(F,{variant:"body1",color:"#616161",children:z}),C.length>0&&st.length>0&&st.map(R=>t.jsx(F,{sx:{fontSize:"0.75rem",lineHeight:"1.5",color:"#455A64"},children:"".concat(R.valueLabel,": ").concat(R.valueText)},R.valueLabel))]})]}),t.jsxs(yt,{...y.default,textAlignLocation:b,children:[k&&t.jsx("span",{children:"Price: "}),It(ot)]}),t.jsx(yt,{...y.default,textAlignLocation:b,children:t.jsx(ys,{isStock:$,maxQuantity:d,minQuantity:T,stock:V,value:G,onChange:(R,K)=>{S(h,R,K)}})}),t.jsxs(yt,{...y.default,textAlignLocation:b,children:[k&&t.jsx("div",{children:"Total: "}),It(X)]}),t.jsx(yt,{...y.delete,children:t.jsx(Vt,{sx:{cursor:"pointer",color:"rgba(0, 0, 0, 0.54)"},onClick:()=>{a(h)}})})]},z)})]}):null]})]})})}function vs(f){const n=jt(),[i]=vt(),{open:s,handleCancelClick:o,handleDeleteProductClick:p}=f;return t.jsx(Jt,{isOpen:s,title:n("shoppingList.deleteItems.subtotal"),leftSizeBtn:n("shoppingList.deleteItems.cancel"),rightSizeBtn:n("shoppingList.deleteItems.delete"),handleLeftClick:o,handRightClick:p,rightStyleBtn:{color:"#D32F2F"},children:t.jsx(g,{sx:{display:"flex",justifyContent:i?"center%":"start",width:i?"100%":"450px",height:"100%"},children:n("shoppingList.deleteItems.confirmDelete")})})}function Ts(f){const[n]=vt(),i=jt(),{state:{productQuoteEnabled:s=!1}}=c.useContext(pe),o=et(({b2bFeatures:C})=>C.masqueradeCompany.isAgenting),p=et(({company:C})=>C.companyInfo.id),m=et(({company:C})=>C.customer.customerGroupId),{shoppingListCreateActionsPermission:b,purchasabilityPermission:O,submitShoppingListPermission:x}=et(Dt),q=c.useRef(null),[J,Q]=c.useState(!1),E=qe.get("cartId"),k=n?{alignItems:"flex-start",flexDirection:"column"}:{alignItems:"center"},{shoppingListInfo:L,allowJuniorPlaceOrder:y,checkedArr:S,selectedSubTotal:l,setLoading:a,setDeleteOpen:w,setValidateFailureProducts:r,setValidateSuccessProducts:u,isB2BUser:h,customColor:$,isCanEditShoppingList:d,role:T}=f,V=h?b:!0,G=h?O:!0,nt=h?x:Number(T)===2,rt=()=>{S.length===0?D.error(i("shoppingList.footer.selectOneItem")):Q(!0)},z=()=>{Q(!1)},W=C=>{const st=[],R=[];return S.forEach(K=>{const{node:A}=K,U=C.find(M=>M.variantSku===A.variantSku)||{};if(U){let M=!0;U.isStock==="1"&&(A!=null&&A.quantity?Number(A.quantity):0)>U.stock&&(M=!1),U.minQuantity!==0&&(A!=null&&A.quantity?Number(A.quantity):0)<U.minQuantity&&(M=!1),U.maxQuantity!==0&&(A!=null&&A.quantity?Number(A.quantity):0)>U.maxQuantity&&(M=!1),M?R.push({node:A}):st.push({node:{...A},stock:U.stock,isStock:U.isStock,maxQuantity:U.maxQuantity,minQuantity:U.minQuantity})}}),{validateFailureArr:st,validateSuccessArr:R}},Y=async()=>{if(S.length===0){D.error(i("shoppingList.footer.selectOneItem"));return}z(),a(!0);try{const C=[];let st="";if(S.forEach(M=>{const{node:gt}=M;gt.productsSearch.availability==="disabled"&&(st+="".concat(gt.variantSku,",")),C.push(gt.variantSku)}),st){D.error(i("shoppingList.footer.unavailableProducts",{skus:st.slice(0,-1)}),{isClose:!0});return}if(C.length===0){D.error(i(y?"shoppingList.footer.selectItemsToCheckout":"shoppingList.footer.selectItemsToAddToCart"),{isClose:!0});return}const K=await(h?Qe:Ve)({skus:C}),{validateFailureArr:A,validateSuccessArr:U}=W((K==null?void 0:K.variantSku)||[]);if(U.length!==0){const M=ae(U),gt=Ue(E),Lt=await Me();let at=null;y&&Lt.length?(await $e(gt),at=await ze(Lt,M)):(at=await ce(M),Ft()),at&&at.errors?D.error(at.errors[0].message,{isClose:!0}):A.length===0&&(y&&nt&&(L==null?void 0:L.status)===0?window.location.href=le:(D.success("",{jsx:Bt({message:i("shoppingList.footer.productsAddedToCart"),link:de,linkText:i("shoppingList.footer.viewCart"),isOutLink:!0,isCustomEvent:!0}),isClose:!0}),Ft()))}r(A),u(U)}finally{a(!1)}},N=C=>(C==null?void 0:C.length)===0?[]:C.map(({option_id:R,option_value:K})=>({optionId:R,optionValue:K})),ot=async()=>{if(S.length===0){D.error(i("shoppingList.footer.selectOneItem"));return}a(!0),z();try{const C=S.filter(mt=>{const{node:{variantSku:lt}}=mt;return lt!==""&&lt!==null&&lt!==void 0}),st=S.filter(mt=>{const{node:{variantSku:lt}}=mt;return!lt});if(st.length>0&&D.error(i("shoppingList.footer.cantAddProductsNoSku"),{isClose:!0}),st.length===S.length)return;const R=[];C.forEach(mt=>{const{node:lt}=mt;R.includes(Number(lt.productId))||R.push(Number(lt.productId))});const K=h?ue:he,{productsSearch:A}=await K({productIds:R,companyId:p,customerGroupId:m}),U=ge(A);let M=!1,gt="",Lt=!0;const at=[];if(C.forEach(mt=>{const{node:{basePrice:lt,optionList:wt,variantSku:Tt,productId:P,productName:j,quantity:Z,variantId:dt,tax:_}}=mt,ft=N(JSON.parse(wt)),Ct=U.find(At=>Number(At.id)===Number(P)),xt=Ct==null?void 0:Ct.variants.find(At=>At.sku===Tt);xt||(gt=i("shoppingList.footer.notFoundSku",{sku:Tt}),Lt=!1);const Ut={node:{id:Ee(),variantSku:(xt==null?void 0:xt.sku)||Tt,variantId:dt,productsSearch:Ct,primaryImage:(xt==null?void 0:xt.image_url)||Qt,productName:j,quantity:Number(Z)||1,optionList:JSON.stringify(ft),productId:P,basePrice:lt,tax:_}};at.push(Ut),M=!0}),M=Fe(at),!Lt){D.error("",{jsx:Bt({message:gt,link:"",linkText:"",isOutLink:!1}),isClose:!0});return}M?(await me(at,"2"),Re(at),D.success("",{jsx:Bt({message:i("shoppingList.footer.productsAddedToQuote"),link:"/quoteDraft",linkText:i("shoppingList.footer.viewQuote"),isOutLink:!1}),isClose:!0})):D.error("",{jsx:Bt({message:i("shoppingList.footer.productsLimit"),link:"/quoteDraft",linkText:i("shoppingList.footer.viewQuote"),isOutLink:!1}),isClose:!0})}catch(C){rs.error(C)}finally{a(!1)}},X={adSelectedToCart:{name:i("shoppingList.footer.addToCart"),key:"add-selected-to-cart",handleClick:Y,isDisabled:!1},proceedToCheckout:{name:i("shoppingList.footer.proceedToCheckout"),key:"add-select-to-checkout",handleClick:Y,isDisabled:!1},addSelectedToQuote:{name:i("shoppingList.footer.addToQuote"),key:"add-selected-to-quote",handleClick:ot,isDisabled:!1}},ct=(L==null?void 0:L.status)===0||!h?!G&&h?s?[X.addSelectedToQuote]:[]:nt?y&&s?[X.proceedToCheckout,X.addSelectedToQuote]:y?[X.proceedToCheckout]:s?[X.addSelectedToQuote]:[]:s?[X.adSelectedToCart,X.addSelectedToQuote]:[X.adSelectedToCart]:[];return t.jsxs(pt,{sx:{position:"fixed",bottom:n&&o?"52px":52,left:0,backgroundColor:"#fff",width:"100%",padding:n?"0 0 1rem 0":"0 40px 1rem 40px",height:n?"8rem":"auto",marginLeft:0,display:"flex",flexWrap:"nowrap",zIndex:"999"},container:!0,spacing:2,children:[t.jsx(pt,{item:!0,sx:{display:n?"none":"block",width:"290px",paddingLeft:"20px"}}),t.jsx(pt,{item:!0,sx:n?{flexBasis:"100%"}:{flexBasis:"690px",flexGrow:1},children:t.jsxs(g,{sx:{width:"100%",pr:"20px",display:"flex",zIndex:"999",justifyContent:"space-between",...k},children:[t.jsx(F,{sx:{color:"#000000",fontSize:"16px",fontWeight:"400"},children:i("shoppingList.footer.selectedProducts",{quantity:S.length})}),t.jsxs(g,{sx:{display:"flex",alignItems:"center",flexWrap:n?"wrap":"nowrap"},children:[t.jsx(F,{variant:"h6",sx:{fontSize:"16px",fontWeight:"700",color:"#000000"},children:i("shoppingList.footer.subtotal",{subtotal:It(l)})}),t.jsxs(g,{sx:{display:"flex",alignItems:"center",marginTop:n?"0.5rem":0,width:n?"100%":"auto"},children:[!y&&d&&V&&t.jsx(kt,{sx:{padding:"5px",border:"1px solid ".concat($||"#1976d2"),margin:n?"0 1rem 0 0":"0 1rem",minWidth:"auto"},disabled:(L==null?void 0:L.status)===40,children:t.jsx(Vt,{color:"primary",sx:{color:$},onClick:()=>{w(!0)}})}),ct.length?t.jsxs(g,{sx:{display:"flex",alignItems:"center",marginTop:n?"0.5rem":0,marginLeft:n?0:"20px",width:n?"100%":"auto"},children:[ct.length===1&&ct[0]&&t.jsx(kt,{variant:"contained",onClick:ct[0].handleClick,sx:{marginRight:n?"1rem":0,width:n?"100%":"auto"},children:ct[0].name}),ct.length===2&&t.jsxs(t.Fragment,{children:[t.jsx(kt,{variant:"contained",onClick:rt,ref:q,sx:{marginRight:n?"1rem":0,width:n?"100%":"auto"},endIcon:t.jsx(gs,{}),children:i("shoppingList.footer.addSelectedTo")}),t.jsx(ve,{id:"basic-menu",anchorEl:q.current,open:J,onClose:z,MenuListProps:{"aria-labelledby":"basic-button"},children:ct.length>1&&ct.map(C=>t.jsx(Te,{onClick:()=>{C.handleClick()},children:C.name},C.key))})]})]}):null]})]})]})}),t.jsx(pt,{item:!0,sx:n?{flexBasis:"100%",display:n?"none":"block"}:{flexBasis:"340px",display:n?"none":"block"}})]})}const As=Ot("div")(()=>({display:"flex",alignItems:"center"}));function ws(f){var r;const n=jt(),[i]=vt(),{shoppingListInfo:s,customerInfo:o,handleUpdateShoppingList:p,goToShoppingLists:m,isB2BUser:b,setOpenPage:O,openAPPParams:x,customColor:q}=f,{state:{portalStyle:{backgroundColor:J="#FEF9F5"}}}=c.useContext(He),Q=be(),{selectCompanyHierarchyId:E}=et(({company:u})=>u.companyHierarchyInfo),{submitShoppingListPermission:k,approveShoppingListPermission:L}=et(Dt),y=c.useMemo(()=>{if(b){const u=(s==null?void 0:s.companyInfo)||{},{submitShoppingListPermission:h,approveShoppingListPermission:$}=zt,d=_e({code:h,userId:Number((o==null?void 0:o.userId)||0),selectId:Number(E)}),T=Ht({code:$,companyId:Number((u==null?void 0:u.companyId)||0),userId:Number((o==null?void 0:o.userId)||0)});return{submitShoppingListPermission:d,approveShoppingListPermission:T}}return{submitShoppingListPermission:k,approveShoppingListPermission:L}},[o,b,k,L,s==null?void 0:s.companyInfo,E]),S=((r=s==null?void 0:s.products)==null?void 0:r.edges.length)===0,{submitShoppingListPermission:l,approveShoppingListPermission:a}=y,w=u=>i?{}:{xs:u};return t.jsxs(t.Fragment,{children:[t.jsx(g,{sx:{marginBottom:"16px",width:"fit-content"},children:t.jsxs(g,{sx:{color:"#1976d2",cursor:"pointer",display:"flex",alignItems:"center"},onClick:()=>{x.shoppingListBtn!=="add"?m():(Q("/"),O({isOpen:!1,openUrl:""}))},children:[t.jsx(ms,{fontSize:"small",sx:{fontSize:"12px",marginRight:"0.5rem",color:q}}),t.jsx(g,{sx:{margin:0,color:q,m:"0"},children:x.shoppingListBtn!=="add"?n("shoppingList.header.backToShoppingLists"):n("shoppingList.header.backToProduct")})]})}),t.jsxs(pt,{container:!0,spacing:2,sx:{display:"flex",justifyContent:"space-between",flexDirection:i?"column":"row",mb:i?"16px":""},children:[t.jsxs(pt,{item:!0,...w(8),sx:{color:Je(J)},children:[t.jsxs(g,{sx:{display:"flex",alignItems:i?"start":"center",flexDirection:i?"column":"row"},children:[t.jsx(F,{variant:"h4",sx:{marginRight:"1rem",wordBreak:"break-all"},children:"".concat((s==null?void 0:s.name)||"")}),b&&(l||a&&(s==null?void 0:s.approvedFlag))&&t.jsx(F,{sx:{m:i?"10px 0":"0"},children:s&&t.jsx(xs,{status:s==null?void 0:s.status})})]}),t.jsxs(g,{children:[t.jsx(F,{sx:{width:"100%",wordBreak:"break-all"},children:s==null?void 0:s.description}),b&&t.jsxs(As,{children:[t.jsx(F,{variant:"subtitle2",sx:{marginRight:"0.5rem"},children:n("shoppingList.header.createdBy")}),t.jsx("span",{children:"".concat((o==null?void 0:o.firstName)||""," ").concat((o==null?void 0:o.lastName)||"")})]})]})]}),t.jsxs(pt,{item:!0,sx:{textAlign:i?"none":"end"},...w(4),children:[l&&(s==null?void 0:s.status)===30&&t.jsx(kt,{variant:"outlined",disabled:S,onClick:()=>{p(40)},children:n("shoppingList.header.submitForApproval")}),a&&(s==null?void 0:s.status)===40&&t.jsxs(g,{children:[t.jsx(kt,{variant:"outlined",sx:{marginRight:"1rem"},onClick:()=>{p(20)},children:n("shoppingList.header.reject")}),a&&t.jsx(kt,{variant:"outlined",onClick:()=>{p(0)},children:n("shoppingList.header.approve")})]})]})]})]})}function Ns(f){const n=jt(),[i]=vt(),{open:s,notes:o,setNotes:p,handleCancelAddNotesClick:m,handleAddItemNotesClick:b}=f;return t.jsx(Jt,{isOpen:s,title:n("shoppingList.addItemNotes.title"),leftSizeBtn:n("shoppingList.addItemNotes.cancel"),rightSizeBtn:n("shoppingList.addItemNotes.save"),handleLeftClick:m,handRightClick:b,isShowBordered:!1,children:t.jsx(g,{sx:{display:"flex",justifyContent:i?"center%":"start",width:i?"100%":"450px",height:"100%"},children:t.jsx(_t,{multiline:!0,rows:6,defaultValue:o,onChange:O=>p(O.target.value),variant:"filled",fullWidth:!0,placeholder:n("shoppingList.addItemNotes.placeholder")})})})}const Bs=Ot("img")(()=>({maxWidth:"60px",height:"auto",marginRight:"0.5rem"}));function Os(f){const n=jt(),{item:i,onEdit:s,onDelete:o,checkBox:p,handleUpdateProductQty:m,handleUpdateShoppingListItem:b,isReadForApprove:O,len:x,itemIndex:q,setDeleteOpen:J,setAddNoteOpen:Q,setAddNoteItemId:E,setNotes:k,showPrice:L,b2bAndBcShoppingListActionsPermissions:y}=f,{basePrice:S,quantity:l,itemId:a,variantId:w,primaryImage:r,productName:u,variantSku:h,productsSearch:$,productUrl:d,taxPrice:T=0,productNote:V}=i,G=Et(Number(S),Number(T)),nt=G*Number(l),rt={...i.productsSearch,selectOptions:i.optionList},z=Gt(rt,{}),W=JSON.parse(i.optionList),Y=z.filter(H=>H.valueText),N=W.length>0&&!O&&y,ot=rt.variants||[],X=Le(ot,{variantId:w,variantSku:h})||r;return t.jsx(g,{sx:{borderTop:"1px solid #D9DCE9",borderBottom:q===x-1?"1px solid #D9DCE9":""},children:t.jsxs(ne,{sx:{color:"#313440",display:"flex",pl:0},children:[t.jsx(g,{children:p&&p()}),t.jsx(g,{children:t.jsx(Bs,{src:X||Qt,alt:"Product-img",loading:"lazy"})}),t.jsxs(g,{sx:{flex:1},children:[t.jsx(F,{variant:"body1",color:"#212121",onClick:()=>{const{location:{origin:H}}=window;window.location.href="".concat(H).concat(d)},sx:{cursor:"pointer"},children:u}),t.jsx(F,{variant:"body1",color:"#616161",children:h}),t.jsx(g,{sx:{margin:"0 0 0.5rem 0"},children:W.length>0&&Y.length>0&&t.jsx(g,{children:Y.map(H=>t.jsx(F,{sx:{fontSize:"0.75rem",lineHeight:"1.5",color:"#455A64"},children:"".concat(H.valueLabel,": ").concat(H.valueText)},H.valueLabel))})}),V&&V.trim().length>0&&t.jsx(F,{sx:{fontSize:"0.75rem",color:"#ED6C02",marginTop:"0.3rem",marginBottom:"0.3rem"},children:V}),t.jsx(F,{sx:{color:"#212121",fontSize:"14px"},children:n("shoppingList.shoppingDetailCard.price",{price:L(It(G),i)})}),t.jsx(_t,{size:"small",type:"number",variant:"filled",label:n("shoppingList.shoppingDetailCard.quantity"),disabled:y?O:!0,inputProps:{inputMode:"numeric",pattern:"[0-9]*"},value:l,sx:{margin:"0.5rem 0",width:"60%",maxWidth:"100px","& label":{zIndex:0,fontSize:"14px"},"& input":{fontSize:"14px"}},onChange:H=>{m(i.id,H.target.value)},onBlur:()=>{b(a)}}),t.jsx(F,{sx:{color:"#212121",fontSize:"14px"},children:n("shoppingList.shoppingDetailCard.total",{total:L(It(nt),i)})}),t.jsxs(g,{sx:{marginTop:"11px",textAlign:"end"},id:"shoppingList-actionList-mobile",children:[y&&t.jsx(fe,{sx:{marginRight:"0.5rem",cursor:"pointer",color:"rgba(0, 0, 0, 0.54)"},onClick:()=>{Q(!0),E(Number(a)),V&&k(V)}}),N&&t.jsx(Se,{sx:{marginRight:N?"0.5rem":"",marginLeft:N?"0.3rem":"",cursor:"pointer",color:"rgba(0, 0, 0, 0.54)"},onClick:()=>{s({...$,selectOptions:W,quantity:l},w,a)}}),y&&!O&&t.jsx(Vt,{sx:{marginLeft:"0.3rem",cursor:"pointer",color:"rgba(0, 0, 0, 0.54)"},onClick:()=>{J(!0),o(Number(a))}})]})]})]})},i.id)}const Ds=Ot("div")(()=>({backgroundColor:"#FFFFFF",padding:"1rem",borderRadius:"4px",boxShadow:"0px 2px 1px -1px rgba(0, 0, 0, 0.2), 0px 1px 1px rgba(0, 0, 0, 0.14), 0px 1px 3px rgba(0, 0, 0, 0.12)","& tbody":{"& tr":{"& td":{verticalAlign:"top"},"& td: first-of-type":{paddingTop:"25px"}},"& tr: hover":{"& #shoppingList-actionList":{opacity:1}}}})),qs=Ot("img")(()=>({maxWidth:"60px",height:"auto",marginRight:"0.5rem"})),Es=Ot(_t)(()=>({"& input":{paddingTop:"12px",paddingRight:"6px"}})),se="updatedAt",ie={Product:"productName",updatedAt:"updatedAt",Qty:"quantity"};function Fs(f,n){var Wt;const[i]=vt(),s=jt(),{shoppingListInfo:o,isRequestLoading:p,setIsRequestLoading:m,shoppingListId:b,getShoppingListDetails:O,setCheckedArr:x,isReadForApprove:q,setDeleteItemId:J,setDeleteOpen:Q,isJuniorApprove:E,isB2BUser:k,allowJuniorPlaceOrder:L,productQuoteEnabled:y,isCanEditShoppingList:S,role:l}=f,a=et(({global:e})=>e.showInclusiveTaxPrice),{shoppingListCreateActionsPermission:w,submitShoppingListPermission:r}=et(Dt),u=k?w&&S:!0,h=k?u:!0,$=k?r:Number(l)===2,d=c.useRef(null),[T,V]=c.useState(!1),[G,nt]=c.useState(null),[rt,z]=c.useState(null),[W,Y]=c.useState({orderBy:"-".concat(ie[se])}),[N,ot]=c.useState(!0),[X,H]=c.useState([]),[ct,C]=c.useState(0),[st,R]=c.useState(!1),[K,A]=c.useState(""),[U,M]=c.useState(""),[gt,Lt]=c.useState(!1),[at,mt]=c.useState(!1),[lt,wt,Tt]=bs(ie,se,W,Y),P=(e,I)=>{var tt,qt,Pt;if(Number(I)<0)return;const B=X.find(ht=>{const{node:bt}=ht;return bt.id===e}),v=((tt=B==null?void 0:B.node)==null?void 0:tt.quantity)||"";ot(Number(v)===Number(I));const ut=((qt=d.current)==null?void 0:qt.getList())||[],it=ut==null?void 0:ut.map(ht=>{const{node:bt}=ht;return(bt==null?void 0:bt.id)===e&&(bt.quantity="".concat(Number(I)),bt.disableCurrentCheckbox=Number(I)===0),ht}),St=it.filter(ht=>Number(ht.node.quantity)===0);Lt(St.length===it.length),(Pt=d.current)==null||Pt.setList([...it])},j=()=>{var e;(e=d.current)==null||e.refresh()};c.useImperativeHandle(n,()=>({initSearch:j,getList:()=>{var e;return(e=d.current)==null?void 0:e.getList()},setList:()=>{var e;return(e=d.current)==null?void 0:e.setList()},getSelectedValue:()=>{var e;return(e=d.current)==null?void 0:e.getSelectedValue()}}));const Z=async e=>{Y({...W,search:e})},dt=()=>{z(""),V(!1)},_=(e,I,B)=>{z(B),nt(e),V(!0)},ft=async e=>{m(!0);const I=k?Zt:te;try{const B=$t(e[0].newSelectOptionList,e[0]),v={itemId:rt,shoppingListId:b,itemData:{variantId:e[0].variantId,quantity:e[0].quantity,optionList:B||[]}};await I(v),V(!1),z(""),D.success(s("shoppingList.table.productUpdated")),j()}finally{m(!1)}},Ct=async e=>{var Pt;const B=(((Pt=d.current)==null?void 0:Pt.getList())||[]).find(ht=>{const{node:bt}=ht;return bt.itemId===e});let v;B&&(v=B.node);const it=JSON.parse((v==null?void 0:v.optionList)||"[]").map(ht=>({optionId:ht.option_id,optionValue:ht.option_value})),St={variantId:v==null?void 0:v.variantId,quantity:v!=null&&v.quantity?Number(v.quantity):0,optionList:it||[],productNote:U};await(k?Zt:te)({itemId:e,shoppingListId:b,itemData:St})},xt=async e=>{if(!N){m(!0);try{await Ct(e),D.success(s("shoppingList.table.quantityUpdated")),ot(!0),j()}finally{m(!1)}}},Ut=e=>{var I;if(e.length>0){const B=((I=d.current)==null?void 0:I.getList())||[],v=[];e.forEach(ut=>{const it=B.find(St=>{const{node:tt}=St;return tt.id===ut});it&&v.push(it)}),x([...v])}else x([])},At=()=>{R(!1),A(""),M("")},ye=async()=>{m(!0);try{At(),await Ct(K),D.success(s("shoppingList.table.productNotesUpdated")),j()}finally{m(!1)}};c.useEffect(()=>{if(o){const{products:{edges:e},grandTotal:I,totalTax:B}=o,v=a?Number(I):Number(I)-Number(B)||0,ut=e.some(it=>{var St,tt;return(St=it==null?void 0:it.node)!=null&&St.productsSearch&&((tt=it.node.productsSearch)==null?void 0:tt.isPriceHidden)||!1});mt(ut),H(Ss(e)),C(v)}},[o,a]),c.useEffect(()=>{if(o){const{products:{edges:e}}=o,I=e.filter(B=>B.node.quantity===0);Lt(I.length===e.length)}},[o]);const Mt=(e,I)=>{const{productsSearch:{isPriceHidden:B}}=I;return B?"":We({price:e,productInfo:I,showText:B?"":e,forcedSkip:!0})},Ce=[{key:"Product",title:s("shoppingList.table.product"),render:e=>{const I={...e.productsSearch,selectOptions:e.optionList},B=Gt(I,{}),v=JSON.parse(e.optionList),ut=B.filter(tt=>tt.valueText),it=I.variants||[],St=Le(it,{variantId:e.variantId,variantSku:e.variantSku})||e.primaryImage;return t.jsxs(g,{sx:{display:"flex",alignItems:"flex-start"},children:[t.jsx(qs,{src:St||Qt,alt:"Product-img",loading:"lazy"}),t.jsxs(g,{children:[t.jsx(F,{variant:"body1",color:"#212121",onClick:()=>{const{location:{origin:tt}}=window;window.location.href="".concat(tt).concat(e.productUrl)},sx:{cursor:"pointer"},children:e.productName}),t.jsx(F,{variant:"body1",color:"#616161",children:e.variantSku}),v.length>0&&ut.length>0&&t.jsx(g,{children:ut.map(tt=>t.jsx(F,{sx:{fontSize:"0.75rem",lineHeight:"1.5",color:"#455A64"},children:"".concat(tt.valueLabel,": ").concat(tt.valueText)},tt.valueLabel))}),(e==null?void 0:e.productNote)&&(e==null?void 0:e.productNote.trim().length)>0&&t.jsx(F,{sx:{fontSize:"0.75rem",color:"#ED6C02",marginTop:"0.3rem"},children:e.productNote})]})]})},width:"45%",isSortable:!0},{key:"Price",title:s("shoppingList.table.price"),render:e=>{const{basePrice:I,taxPrice:B=0}=e,v=Et(Number(I),Number(B));return t.jsx(F,{sx:{padding:"12px 0"},children:Mt(It(v),e)})},width:"15%",style:{textAlign:"right"}},{key:"Qty",title:s("shoppingList.table.quantity"),render:e=>t.jsx(Es,{size:"small",type:"number",variant:"filled",sx:{width:"72px"},disabled:h?q||E:!0,value:e.quantity,inputProps:{inputMode:"numeric",pattern:"[0-9]*"},onChange:I=>{P(e.id,I.target.value)},onBlur:()=>{xt(e.itemId)}}),width:"15%",style:{textAlign:"right"},isSortable:!0},{key:"Total",title:s("shoppingList.table.total"),render:e=>{const{basePrice:I,quantity:B,itemId:v,productsSearch:{options:ut},taxPrice:it=0}=e,tt=Et(Number(I),Number(it))*Number(B),Pt=(ut||JSON.parse(e.optionList)).length>0&&!q&&!E&&h;return t.jsxs(g,{children:[t.jsx(F,{sx:{padding:"12px 0"},children:Mt(It(tt),e)}),t.jsx(g,{sx:{marginTop:"1rem",opacity:0,textAlign:i?"end":"start",display:"flex",justifyContent:"flex-end"},id:"shoppingList-actionList",children:u&&t.jsxs(t.Fragment,{children:[t.jsx(pt,{item:!0,sx:{marginRight:"0.5rem",minWidth:"32px"},children:t.jsx(fe,{sx:{cursor:"pointer",color:"rgba(0, 0, 0, 0.54)"},onClick:()=>{R(!0),A(Number(v)),e.productNote&&M(e.productNote)}})}),t.jsx(pt,{item:!0,sx:{marginRight:Pt?"0.5rem":"",marginLeft:Pt?"0.3rem":""},children:Pt&&t.jsx(Se,{sx:{cursor:"pointer",color:"rgba(0, 0, 0, 0.54)"},onClick:()=>{const{productsSearch:ht,variantId:bt,itemId:Pe,optionList:je,quantity:ke}=e;_({...ht,selectOptions:je,quantity:ke},bt,Pe)}})}),t.jsx(pt,{item:!0,sx:{marginLeft:"0.3rem"},children:h&&!q&&!E&&t.jsx(Vt,{sx:{cursor:"pointer",color:"rgba(0, 0, 0, 0.54)"},onClick:()=>{Q(!0),J(Number(v))}})})]})})]})},width:"15%",style:{textAlign:"right"}}];return t.jsxs(Ds,{children:[t.jsxs(g,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",margin:"0 0 1rem 0"},children:[t.jsx(F,{sx:{fontSize:"24px"},children:s("shoppingList.table.totalProductCount",{quantity:((Wt=o==null?void 0:o.products)==null?void 0:Wt.totalCount)||0})}),t.jsx(F,{sx:{fontSize:"24px"},children:at?"":It(ct||0)})]}),t.jsx(g,{sx:{marginBottom:"5px"},children:t.jsx(Ls,{searchBGColor:"rgba(0, 0, 0, 0.06)",handleChange:e=>{Z(e)}})}),t.jsx(Ge,{ref:d,columnItems:Ce,rowsPerPageOptions:[10,20,50],getRequestList:O,searchParams:W,isCustomRender:!1,showCheckbox:!0,showSelectAllCheckbox:!0,applyAllDisableCheckbox:!1,disableCheckbox:gt||($?!(L||y):(q||E)&&h),hover:!0,labelRowsPerPage:s("shoppingList.table.itemsPerPage"),showBorder:!1,requestLoading:m,getSelectCheckbox:Ut,itemIsMobileSpacing:0,noDataText:s("shoppingList.table.noProductsFound"),sortDirection:wt,orderBy:Tt,sortByFn:lt,pageType:"shoppingListDetailsTable",renderItem:(e,I,B)=>{var v;return t.jsx(Os,{len:((v=o==null?void 0:o.products)==null?void 0:v.edges.length)||0,item:e,itemIndex:I,showPrice:Mt,onEdit:_,onDelete:J,checkBox:B,setDeleteOpen:Q,setAddNoteOpen:R,setAddNoteItemId:A,setNotes:M,handleUpdateProductQty:P,handleUpdateShoppingListItem:xt,isReadForApprove:q||E,b2bAndBcShoppingListActionsPermissions:h})}}),t.jsx(ds,{isOpen:T,isLoading:p,setIsLoading:m,product:G,type:"shoppingList",onCancel:dt,onConfirm:ft,isEdit:!0,isB2BUser:k}),t.jsx(Ns,{open:st,notes:U,setNotes:M,handleCancelAddNotesClick:At,handleAddItemNotesClick:ye})]})}const Rs=c.forwardRef(Fs),Qs=f=>{if(f.length>0){let n=0;return f.forEach(i=>{const{node:{quantity:s,basePrice:o,taxPrice:p}}=i,m=Et(Number(o),Number(p));n+=m*Number(s)}),1e3*n/1e3}return 0};function Vs(){const{id:f=""}=fs(),{state:{openAPPParams:n,productQuoteEnabled:i=!1}}=c.useContext(pe),s=et(Ye),{currency_code:o}=et(oe),p=et(({company:l})=>l.customer.role),m=et(({company:l})=>l.companyInfo.id),b=et(({company:l})=>l.customer.customerGroupId),O=et(({b2bFeatures:l})=>l.masqueradeCompany.isAgenting),q=Ae().palette.primary.main,{shoppingListCreateActionsPermission:J,purchasabilityPermission:Q,submitShoppingListPermission:E}=et(Dt);return{id:f,openAPPParams:n,productQuoteEnabled:i,isB2BUser:s,role:p,isAgenting:O,primaryColor:q,shoppingListCreateActionsPermission:J,submitShoppingListPermission:E,isCanAddToCart:s?Q:!0,getProducts:async l=>{const a={productIds:l,currencyCode:o,companyId:m,customerGroupId:b},{productsSearch:w}=s?await ue(a):await he(a);return ge(w)},getShoppingList:l=>{const a={...l,id:f};return s?ns(a):os(a)},deleteShoppingListItem:l=>{const a={itemId:l,shoppingListId:f};return s?ss(a):is(a)}}}function Us({setOpenPage:f}){const{id:n,openAPPParams:i,productQuoteEnabled:s,isB2BUser:o,role:p,isAgenting:m,primaryColor:b,shoppingListCreateActionsPermission:O,submitShoppingListPermission:x,isCanAddToCart:q,getProducts:J,getShoppingList:Q,deleteShoppingListItem:E}=Vs(),k=be(),[L]=vt(),{dispatch:y}=c.useContext(xe),S=jt(),l=c.useRef(null),[a,w]=c.useState([]),[r,u]=c.useState(null),[h,$]=c.useState(null),[d,T]=c.useState(!1),[V,G]=c.useState(!1),[nt,rt]=c.useState(""),[z,W]=c.useState([]),[Y,N]=c.useState([]),[ot,X]=c.useState(!1),[H,ct]=c.useState(!0),C=o?O&&H:!0,st=c.useMemo(()=>{if(o&&r){const{companyInfo:P,customerInfo:j}=r,{submitShoppingListPermission:Z}=zt;return Ht({code:Z,companyId:Number((P==null?void 0:P.companyId)||0),userId:Number((j==null?void 0:j.userId)||0)})}return x},[x,o,r]),R=o?st:p===Ke.JUNIOR_BUYER,K=(r==null?void 0:r.status)===0&&R,A=(r==null?void 0:r.status)===40||(r==null?void 0:r.status)===20,U=()=>{k("/shoppingLists")};c.useEffect(()=>{y({type:"init",payload:{id:parseInt(n,10)||0}})},[n]);const M=async P=>{if(P.length>0)try{const j=[];P.forEach(dt=>{const{node:_}=dt;j.includes(_.productId)||j.push(_.productId)});const Z=await J(j);return P.forEach(dt=>{const{node:_}=dt,ft=Z.find(Ct=>{const{id:xt}=Ct;return _.productId===xt});_.productsSearch=ft||{},_.productName=(ft==null?void 0:ft.name)||_.productName,_.productUrl=(ft==null?void 0:ft.productUrl)||_.productUrl,_.disableCurrentCheckbox=!1,_.quantity===0&&(_.disableCurrentCheckbox=!0)}),P}catch(j){D.error(j)}return[]},gt=async P=>{const j=await Q(P),{products:{edges:Z,totalCount:dt}}=j,_=await M(Z);return await me(_,"2"),o&&$(j.customerInfo),u(j),_?{edges:_,totalCount:dt}:{edges:[],totalCount:0}},Lt=async P=>{var j;T(!0);try{const Z={id:Number(n),name:(r==null?void 0:r.name)||"",description:(r==null?void 0:r.description)||""};o?await Ze({...Z,status:P}):await ts({...Z,channelId:es}),D.success(S("shoppingList.shoppingListStatusUpdated"),{isClose:!0}),(j=l.current)==null||j.initSearch()}finally{T(!1)}},at=()=>{var P;(P=l.current)==null||P.initSearch()},mt=()=>{G(!1),rt("")},lt=async(P="")=>{T(!0);try{if(P){if(await E(P),a.length>0){const j=a.filter(Z=>{const{itemId:dt}=Z.node;return P!==dt});w([...j])}}else{if(a.length===0)return;a.forEach(async j=>{const{node:Z}=j;await E(Z.itemId)}),w([])}D.success(S("shoppingList.productRemoved"))}finally{T(!1),at()}},wt=async()=>{await lt(Number(nt)),await mt()},Tt=async()=>{const{storeConfigSwitchStatus:{isEnabled:P}}=await Xe();X(P==="1"&&q)};return c.useEffect(()=>{K&&Tt()},[K]),c.useEffect(()=>{if(o&&r){const{companyInfo:P,customerInfo:j}=r,{shoppingListCreateActionsPermission:Z}=zt,dt=Ht({code:Z,companyId:Number((P==null?void 0:P.companyId)||0),userId:Number((j==null?void 0:j.userId)||0)});ct(dt)}},[r,o]),t.jsxs(t.Fragment,{children:[t.jsxs(g,{sx:{display:"flex",flexDirection:"column",flex:1},children:[t.jsx(ws,{isB2BUser:o,shoppingListInfo:r,customerInfo:h,role:p,goToShoppingLists:U,handleUpdateShoppingList:Lt,setOpenPage:f,isAgenting:m,openAPPParams:i,customColor:b}),t.jsxs(pt,{container:!0,spacing:2,sx:{marginTop:"0",overflow:"auto",flexWrap:L?"wrap":"nowrap",paddingBottom:"20px",marginBottom:L?"6rem":0},children:[t.jsx(g,{sx:L?{flexBasis:"100%",pl:"16px"}:{flexBasis:"690px",flexGrow:1,ml:"16px",pt:"16px"},children:t.jsx(re,{isSpinning:d,spinningHeight:"auto",children:t.jsx(pt,{item:!0,sx:L?{flexBasis:"100%"}:{flexBasis:"690px",flexGrow:1},children:t.jsx(Rs,{ref:l,isReadForApprove:A,isJuniorApprove:K,allowJuniorPlaceOrder:ot,setCheckedArr:w,shoppingListInfo:r,isRequestLoading:d,setIsRequestLoading:T,shoppingListId:n,getShoppingListDetails:gt,setDeleteOpen:G,setDeleteItemId:rt,isB2BUser:o,productQuoteEnabled:s,isCanEditShoppingList:H,role:p})})})}),t.jsx(pt,{item:!0,sx:L?{flexBasis:"100%"}:{flexBasis:"340px"},children:C&&!A&&!K&&t.jsx(Cs,{updateList:at,type:"shoppingList",isB2BUser:o})})]}),!A&&(ot||s||!K)&&t.jsx(Ts,{shoppingListInfo:r,allowJuniorPlaceOrder:ot,checkedArr:a,selectedSubTotal:Qs(a),setLoading:T,setDeleteOpen:G,setValidateFailureProducts:N,setValidateSuccessProducts:W,isB2BUser:o,customColor:b,isCanEditShoppingList:H,role:p})]}),t.jsx(Is,{shoppingListInfo:r,role:p,products:Y,successProducts:z.length,allowJuniorPlaceOrder:ot,setValidateFailureProducts:N,setValidateSuccessProducts:W,textAlign:L?"left":"right"}),t.jsx(vs,{open:V,handleCancelClick:mt,handleDeleteProductClick:wt})]})}function fi({setOpenPage:f}){return t.jsx(ps,{children:t.jsx(Us,{setOpenPage:f})})}export{fi as default};
//# sourceMappingURL=index-DSKCui6M.js.map
