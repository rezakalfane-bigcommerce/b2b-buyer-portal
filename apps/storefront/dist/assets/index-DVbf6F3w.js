import{j as e,K as et,ad as We,ag as ct,B as v,y as At,T as L,w as bt,G as Ne,s as Ge,f as gt,v as Ft,x as zt,ah as _t}from"./mui-BOgrCzfx.js";import{r as c}from"./reactVendor-BTcQ-GDs.js";import{d as Ot}from"./useB2BCallback-DOyIFx1A.js";import{u as ue}from"./lang-D1hDrxfH.js";import{G as tt,al as Vt,u as H,ad as Le,b8 as Rt,af as le,a_ as lt,b4 as Ze,a$ as Ut,b0 as $t,aN as nt,b2 as ut,b3 as Ht,b5 as yt,aj as Wt,bj as Gt,a as Me,bk as Mt,ah as dt,t as Ct,ab as St,a5 as Jt,bl as Kt,bg as $e,aw as Be,bm as Re,aX as Yt,bn as st,aZ as He,i as Nt,bh as jt,bo as Xt,bp as Zt,bq as mt,br as en,aY as tn,C as nn,bs as sn,am as pt,ac as an,k as on,bt as Ke,bu as rn,ay as cn,ag as ln,aH as un,bv as ft,bw as dn,bx as mn,by as pn,bz as fn,bA as xn}from"./react-setup-Ceu1rkpw.js";import"./load-functions-BIyT0cKp.js";import{b as qt}from"./base-BCVDEF8S.js";import{a as hn,u as vt}from"./form-hNmOEDBo.js";import{d as bn,c as gn}from"./config-CnSUmAoB.js";import{Q as yn,i as Cn,j as Sn,k as Nn,l as jn}from"./QuoteStatus-oMK2ye3h.js";import{S as qn,d as vn,C as Tn}from"./SearchProduct-DceO2DGe.js";import{B as In,Q as Pn,C as Ye,a as kn,b as Dn,g as Ln}from"./getQuoteExtraFields-Ccx33uFE.js";import{u as Bn}from"./useBlockPendingAccountViewPrice-DKNMhpaL.js";import{Q as wn}from"./QuickAdd-tJ8Y8i4v.js";import{t as En,f as De,k as Qn,u as An,l as Fn}from"./lodashEs-DKEtmQJE.js";import{B as Tt}from"./B3CustomForm-DysrR7vP.js";import{v as zn}from"./validatorRules-ByvbDKs6.js";import{B as _n}from"./B3FilterSearch-OtVT6Fm0.js";import{E as It,e as Pt,A as On}from"./muiIcon-dPEugcco.js";import{u as Vn}from"./router-DEI8QtBD.js";import"./intl-CKipw3rV.js";import"./eCache-BdHG5F0B.js";import"./redux-D7_Lh1Zo.js";import"./toolkit-C5fVsw89.js";import"../index.Dxi-ailt.js";import"./global-D7Yn0gGb.js";import"./dateFns-DCN-lSH3.js";import"./dropzone-BroiqFaF.js";const Rn=()=>{const{state:{countriesList:r},dispatch:n}=c.useContext(tt);c.useEffect(()=>{(async()=>{if(r&&!r.length){const{countries:l}=await Vt();n({type:"common",payload:{countriesList:l}})}})()},[r])},Un=({setAddress:r,setValue:n,getValues:i,control:l,addresses:C})=>{const{state:{countriesList:h}}=c.useContext(tt),m=hn({control:l,name:"country"});c.useEffect(()=>{const S=C.findIndex(N=>N.name==="country");h!=null&&h.length&&S!==-1&&r(C.map((N,B)=>S===B?{...N,options:h}:N))},[h]),c.useEffect(()=>{var k;if(!m||!(h!=null&&h.length))return;const S=((k=h.find(P=>P.countryCode===m))==null?void 0:k.states)||[],N=C.findIndex(P=>P.name==="state");N!==-1&&r(C.map((P,x)=>N===x?S.length>0?{...P,fieldType:"dropdown",options:S,required:!0}:{...P,fieldType:"text",options:[],required:!1}:P));const B=i("state");n("state",B&&m&&(S.find(P=>P.stateName===B)||S.length===0)?B:"")},[m,h])},Ue=(r,n)=>Object.values(r==null?void 0:r[n]).every(i=>i===""||i===0);function $n(r){const{updateList:n,addToQuote:i,isB2BUser:l}=r,C=H(({company:g})=>g.companyInfo.id),h=H(({company:g})=>g.customer.customerGroupId),m=H(({company:g})=>g.companyInfo.status),[S,N]=c.useState(!1),[B,k]=c.useState(!1),[P]=Bn(),x=ue(),a=g=>g.map(D=>{const{variantId:f,newSelectOptionList:q,id:R,name:Q,quantity:o,variants:t=[],basePrice:p,taxPrice:T,calculatedValue:I}=D,E=t.length===1?t[0]:t.find(X=>X.variant_id===f),{image_url:G="",sku:J}=E;let K;try{K=JSON.stringify(q)}catch(X){K="[]"}const Z=E.bc_calculated_price.tax_exclusive,O=E.bc_calculated_price.tax_inclusive,w=p||Z,re=T||Number(O)-Number(Z);return{node:{basePrice:w,taxPrice:re,optionList:K,id:ut(),primaryImage:G,productId:R,productName:Q,calculatedValue:I,productsSearch:{...D,selectOptions:K},quantity:o,variantSku:J}}}),j=async g=>{const D=a(g),f=g.filter(({sku:q,variantId:R,variants:Q})=>{const t=Q.find(p=>p.variant_id===R||p.variantId===R).sku;return!(q||t)});return f.length>0&&le.error(x("quoteDraft.notification.cantAddProductsNoSku"),{isClose:!0}),f.length===g.length?[]:(i(D),le.success(x("quoteDraft.notification.productSingular"),{isClose:!0}),g)},A=async g=>{const D=g.map(Q=>Q.productId),{productsSearch:f}=await lt({productIds:D,companyId:C,customerGroupId:h}),q=f.map(Q=>{const o=g.find(I=>I.productId===Q.id)||{},{variantId:t,newSelectOptionList:p,quantity:T}=o;return{...Q,variantId:t,newSelectOptionList:p,quantity:T}});await Ze(q);const R=a(q);return i(R),le.success(x("quoteDraft.notification.productPlural"),{isClose:!0}),g},F=g=>(g==null?void 0:g.length)===0?[]:g.map(({option_id:f,id:q})=>({optionId:"attribute[".concat(f,"]"),optionValue:q})),W=async g=>{k(!0);try{const{validProduct:D}=g,f=[];D.forEach(p=>{const{products:T}=p;f.includes(Number(T.productId))||f.push(Number(T.productId))});const q=l?lt:Ut,{productsSearch:R}=await q({productIds:f,companyId:C,customerGroupId:h}),Q=$t(R);let o=!1;const t=[];D.forEach(p=>{const{products:{option:T,variantSku:I,productId:E,productName:G,variantId:J},qty:K}=p,Z=F(T),O=Q.find(X=>Number(X.id)===Number(E)),w=O.variants.find(X=>{var de;return((de=X==null?void 0:X.sku)==null?void 0:de.toUpperCase())===(I==null?void 0:I.toUpperCase())}),re={node:{id:ut(),variantSku:w==null?void 0:w.sku,variantId:J,productsSearch:O,primaryImage:w.image_url||nt,productName:G,quantity:Number(K)||1,optionList:JSON.stringify(Z),productId:E,basePrice:w.bc_calculated_price.as_entered,taxPrice:w.bc_calculated_price.tax_inclusive-w.bc_calculated_price.tax_exclusive}};t.push(re),o=!0}),o=Ht(t),o?(await Ze(t,"2"),yt(t),le.success(x("quoteDraft.notification.productPlural"),{isClose:!0}),n(),N(!1)):le.error(x("quoteDraft.notification.errorRangeProducts"))}catch(D){qt.error(D)}finally{k(!1)}},M=()=>{P&&m===0?le.info(x("quoteDraft.notification.businessAccountPendingActivation")):N(!0)};return e.jsx(et,{children:e.jsx(We,{sx:{p:"16px !important"},children:e.jsxs(In,{title:x("quoteDraft.collapseTitle.addToQuote"),children:[e.jsx(qn,{updateList:n,addToList:j,type:"quote",searchDialogTitle:x("quoteDraft.modalTitle.addToQuote"),addButtonText:x("quoteDraft.searchProduct.addToQuoteButton"),isB2BUser:l}),e.jsx(ct,{}),e.jsx(wn,{updateList:n,quickAddToList:A,level:1,buttonText:x("quoteDraft.button.addProductsToAddToQuote")}),e.jsx(ct,{}),e.jsx(v,{sx:{margin:"20px 0 0"},children:e.jsxs(Le,{variant:"text",onClick:()=>M(),children:[e.jsx(vn,{sx:{marginRight:"8px"}}),x("quoteDraft.button.bulkUploadCSV")]})}),e.jsx(Rt,{isOpen:S,setIsOpen:N,handleAddToList:W,isLoading:B,withModifiers:!0})]})})})}const kt=zn(["email"]),Hn=(r,n,i)=>[{name:"name",label:n("quoteDraft.contactInfo.contactPerson"),required:!0,default:"",fieldType:"text",xs:r?12:6,variant:"filled",size:"small",disabled:!i},{name:"email",label:n("quoteDraft.contactInfo.email"),required:!0,default:"",fieldType:"text",xs:r?12:6,variant:"filled",size:"small",validate:kt,disabled:!i},{name:"phoneNumber",label:n("quoteDraft.contactInfo.phone"),required:!1,default:"",fieldType:"text",xs:r?12:6,variant:"filled",size:"small"},{name:"companyName",label:n("quoteDraft.contactInfo.companyName"),required:!1,default:"",fieldType:"text",xs:r?12:6,variant:"filled",size:"small"}],Wn=({isMobile:r,b3Lang:n,quoteExtraFields:i,referenceNumber:l,recipients:C,handleSaveClick:h})=>{const m=i.map(N=>({...N,xs:r?12:6}));return[{name:"quoteTitle",label:n("quoteDraft.contactInfo.quoteTitle"),required:!1,default:"",fieldType:"text",xs:r?12:6,variant:"filled",size:"small"},{name:"referenceNumber",label:n("quoteDraft.contactInfo.referenceNumber"),required:!1,default:l||"",fieldType:"text",xs:r?12:6,variant:"filled",size:"small"},...m,{name:"ccEmail",label:n("quoteDraft.contactInfo.ccEmail"),required:!1,default:"",fieldType:"multiInputText",xs:r?12:6,variant:"filled",size:"small",isEmail:!0,existValue:C,validate:kt,isEnterTrigger:!0,handleSave:h}]};function Gn({info:r,emailAddress:n,quoteExtraFields:i,referenceNumber:l,extraFieldsDefault:C,recipients:h,handleSaveCCEmail:m},S){const{control:N,getValues:B,setError:k,formState:{errors:P},setValue:x,handleSubmit:a}=vt({mode:"onSubmit"}),A=H(({company:t})=>t.customer.role)===Wt.GUEST,F=H(Gt),[W]=Me(),M=ue();c.useEffect(()=>{r&&JSON.stringify(r)!=="{}"&&Object.keys(r).forEach(t=>{x(t,r&&r[t])}),C.length&&C.forEach(t=>{t.fieldName&&x(t.fieldName,t.value)})},[r,C]);const g=async t=>n===En(t)?!0:(F||k("email",{type:"custom",message:M("quoteDraft.contactInfo.emailExists")}),F),D=async()=>{var I;const t=B(),p=i.map(E=>({fieldName:E.name,fieldValue:E.name?t[E.name]:""})),T=await Mt({extraFields:p});if(T.code!==200){const G=(((I=T.data)==null?void 0:I.errMsg)||T.message||"").split(":");if(G.length>=2){const J=i==null?void 0:i.find(K=>K.name===G[0]);if(J&&J.name)return k(J.name,{type:"manual",message:G[1]}),!1}return!1}return!0},f=t=>{m(t)},q=async()=>{let t=!0;return await a(async p=>{t=await g(p.email)},()=>{t=!1})(),t&&(t=await D()),t&&B()};c.useImperativeHandle(S,()=>({getContactInfoValue:q}));const R=Hn(W,M,A),Q=Wn({isMobile:W,b3Lang:M,quoteExtraFields:i,referenceNumber:l,recipients:h,handleSaveClick:f}),o=[{title:M("quoteDraft.contactInfo.contact"),infos:R},{title:M("quoteDraft.quoteInfo.title"),infos:Q,style:{mt:"20px"}}];return e.jsx(v,{width:"100%",children:o.map(t=>e.jsxs(v,{width:"100%",children:[e.jsx(v,{sx:{fontWeight:400,fontSize:"24px",height:"32px",mb:"20px",...t==null?void 0:t.style},children:t.title}),e.jsx(Tt,{formFields:t.infos,errors:P,control:N,setError:k,getValues:B,setValue:x})]},t.title))})}const Mn=c.forwardRef(Gn),Jn=bt("div")(({marginBottom:r})=>({marginBottom:r,"& > span:not(:last-child)":{marginRight:"4px"}})),Kn=bt("div")(({theme:r})=>({display:"flex",alignItems:"center",justifyContent:"space-between",marginTop:r.spacing(3)}));function Yn(r){const{item:n,onSetAddress:i}=r,l=At(),C=ue();return e.jsx(et,{children:e.jsxs(We,{sx:{color:"#313440",wordBreak:"break-word"},children:[n.label&&e.jsx(L,{variant:"h5",sx:{marginBottom:n.isDefaultShipping===1||n.isDefaultBilling===1?l.spacing(1):l.spacing(3),color:"rgba(0, 0, 0, 0.87)"},children:n.label}),e.jsxs(Jn,{marginBottom:n.isDefaultShipping===1||n.isDefaultBilling===1?l.spacing(3):0,children:[n.isDefaultShipping===1&&e.jsx(dt,{color:"#C4DD6C",textColor:"rgba(0, 0, 0, 0.87)",children:C("quoteDraft.addressItemCard.defaultShipping")}),n.isDefaultBilling===1&&e.jsx(dt,{color:"#C4DD6C",textColor:"rgba(0, 0, 0, 0.87)",children:C("quoteDraft.addressItemCard.defaultBilling")})]}),e.jsx(L,{variant:"body1",children:"".concat(n.firstName," ").concat(n.lastName)}),e.jsx(L,{variant:"body1",children:n.company||""}),e.jsx(L,{variant:"body1",children:n.addressLine1}),e.jsx(L,{variant:"body1",children:n.addressLine2}),e.jsx(L,{variant:"body1",children:"".concat(n.city,", ").concat(n.state," ").concat(n.zipCode,", ").concat(n.country)}),e.jsx(L,{variant:"body1",children:n.phoneNumber}),e.jsx(Kn,{children:e.jsx(Le,{variant:"text",onClick:()=>{i(n)},children:C("quoteDraft.addressItemCard.chooseAddress")})})]})},n.id)}function Xn({isOpen:r,closeModal:n,handleChangeAddress:i,addressList:l=[],type:C}){const h=c.useRef({copyList:[]}),m=ue(),S=H(Ct),[N,B]=c.useState([]);c.useEffect(()=>{if(l.length){const a=l.map(A=>A.node),j=a.filter(A=>A.isShipping===1&&C==="shipping"||A.isBilling===1&&C==="billing");h.current.copyList=S?j:a,B(j)}},[l,C,S]);const k=["address","firstName","lastName","phoneNumber","state","zipCode","country","label","address","addressLine1"],P=a=>{if(!a&&(h!=null&&h.current)){B(h.current.copyList);return}const j=[];k.forEach(A=>{let F=!0;N.forEach(W=>{W[A].includes(a)&&F&&(j.push(W),F=!1)})}),B(j)},x=()=>{n()};return e.jsxs(St,{fullWidth:!0,isOpen:r,handleLeftClick:x,title:m("quoteDraft.chooseAddress.chooseFromSaved"),showRightBtn:!1,maxWidth:"lg",children:[e.jsx(v,{children:e.jsx(_n,{searchBGColor:"rgba(0, 0, 0, 0.06)",placeholder:m("quoteDraft.chooseAddress.searchAddress"),handleChange:a=>{P(a)}})}),e.jsx(v,{sx:{mt:"20px"},children:e.jsx(Ne,{container:!0,spacing:2,children:N.map(a=>e.jsx(Ne,{item:!0,xs:4,children:e.jsx(Yn,{item:a,onSetAddress:i})},a.id))})})]})}function Zn({title:r,addressList:n=[],pr:i=0,pl:l=0,info:C,role:h,accountFormFields:m=[],shippingSameAsBilling:S=!1,type:N,setBillingChange:B},k){const{control:P,getValues:x,formState:{errors:a},setValue:j}=vt({mode:"onSubmit"}),[A]=Me(),F=ue(),[W,M]=c.useState(!1),[g,D]=c.useState(De(m));Un({control:P,setValue:j,getValues:x,setAddress:D,addresses:g});const f=()=>x(),q=t=>{Object.keys(t).forEach(T=>{T!=="company"&&j(T,t[T])})};c.useImperativeHandle(k,()=>({getContactInfoValue:f,setShippingInfoValue:q}));const R=()=>{M(!0)},Q=()=>{M(!1)},o=t=>{const p={label:(t==null?void 0:t.label)||"",firstName:(t==null?void 0:t.firstName)||"",lastName:(t==null?void 0:t.lastName)||"",company:(t==null?void 0:t.company)||"",country:(t==null?void 0:t.countryCode)||"",address:(t==null?void 0:t.addressLine1)||"",apartment:(t==null?void 0:t.addressLine2)||"",city:(t==null?void 0:t.city)||"",state:(t==null?void 0:t.state)||"",zipCode:(t==null?void 0:t.zipCode)||"",phoneNumber:(t==null?void 0:t.phoneNumber)||""};Object.keys(p).forEach(T=>{T!=="company"&&j(T,p[T])}),N==="billing"&&S&&B(!0),Q()};return c.useEffect(()=>{JSON.stringify(C)!=="{}"&&Object.keys(C).forEach(t=>{j(t,C[t])})},[C]),e.jsxs(v,{width:A?"100%":"50%",mt:A?"2rem":"0",pr:i,pl:l,children:[e.jsxs(v,{sx:{display:"flex",mb:"20px"},children:[e.jsx(L,{sx:{fontWeight:400,fontSize:"24px",height:"32px",mr:"16px"},children:r}),Number(h)!==100&&e.jsx(L,{onClick:R,sx:{fontWeight:500,fontSize:"14px",color:"primary.main",display:"flex",alignItems:"flex-end",cursor:"pointer",textTransform:"uppercase"},children:F("quoteDraft.quoteAddress.chooseFromSaved")})]}),e.jsx(Tt,{formFields:g,errors:a,control:P,getValues:x,setValue:j}),e.jsx(Xn,{isOpen:W,handleChangeAddress:o,closeModal:Q,addressList:n,type:N})]})}const xt=c.forwardRef(Zn);function es({isOpen:r=!1,onClose:n,quoteSubmissionResponseInfo:i}){const l=ue(),C=i.message.split("\n");return e.jsx(v,{sx:{"#b2b-dialog-container":{'& [aria-labelledby="alert-dialog-title"]':{width:"500px",maxHeight:"500px"},"& h2":{color:"#313440"},"& h6":{color:"#313440",fontSize:"16px"}}},children:e.jsx(St,{isOpen:r,title:i.title,showLeftBtn:!1,handRightClick:n,isShowBordered:!1,rightSizeBtn:l("quoteDraft.submission.response.button.text"),maxWidth:!1,children:C.map(h=>e.jsx(L,{variant:"subtitle2",sx:{marginTop:"1rem"},children:h}))})})}const ts=r=>{const{global:{blockPendingQuoteNonPurchasableOOS:{isEnableProduct:n}}}=Jt.getState();return n?r.some(l=>!Kt(l.node.basePrice,l)):!1},ht={subtotal:0,shipping:0,tax:0,grandTotal:0},ns=c.forwardRef((r,n)=>{const i=ue(),[l,C]=c.useState({...ht}),[h,m]=c.useState(!1),S=H(({global:a})=>a.showInclusiveTaxPrice),N=H(({quoteInfo:a})=>a.draftQuoteList),B=a=>parseFloat(String(a)),k=c.useCallback(()=>{const a=ts(N);m(a);const j=N.reduce((A,F)=>{const{basePrice:W,taxPrice:M=0,quantity:g}=F.node;let{subtotal:D,grandTotal:f,tax:q}=A;const{shipping:R}=A,Q=$e(Number(W),Number(M));return D+=B(Q*g),q+=B(Number(M)*Number(g)),f=(S?D:D+q)+R,{grandTotal:f,shipping:R,tax:q,subtotal:D}},{...ht});C(j)},[S,N]);c.useEffect(()=>{k()},[k]),c.useImperativeHandle(n,()=>({refreshSummary:()=>k()}));const P=a=>Be(a),x=a=>h?i("quoteDraft.quoteSummary.tbd"):a;return e.jsx(et,{children:e.jsx(We,{children:e.jsxs(v,{children:[e.jsx(L,{variant:"h5",children:i("quoteDraft.quoteSummary.summary")}),e.jsxs(v,{sx:{marginTop:"20px",color:"#212121"},children:[e.jsxs(Ne,{container:!0,justifyContent:"space-between",sx:{margin:"4px 0"},children:[e.jsx(L,{children:i("quoteDraft.quoteSummary.subTotal")}),e.jsx(L,{children:x(P(l.subtotal))})]}),e.jsxs(Ne,{container:!0,justifyContent:"space-between",sx:{margin:"4px 0"},children:[e.jsx(L,{children:i("quoteDraft.quoteSummary.shipping")}),e.jsx(L,{children:i("quoteDraft.quoteSummary.tbd")})]}),e.jsxs(Ne,{container:!0,justifyContent:"space-between",sx:{margin:"4px 0"},children:[e.jsx(L,{children:i("quoteDraft.quoteSummary.tax")}),e.jsx(L,{children:x(P(l.tax))})]}),e.jsxs(Ne,{container:!0,justifyContent:"space-between",sx:{margin:"24px 0 0"},children:[e.jsx(L,{sx:{fontWeight:"bold"},children:i("quoteDraft.quoteSummary.grandTotal")}),e.jsx(L,{sx:{fontWeight:"bold"},children:x(P(l.grandTotal))})]})]})]})})})});function ss({columnItems:r,isCustomRender:n=!1,tableKey:i,renderItem:l,noDataText:C="",tableFixed:h=!1,tableHeaderHide:m=!1,rowsPerPageOptions:S=[10,20,30],itemSpacing:N=2,itemXs:B=4,showCheckbox:k=!1,showSelectAllCheckbox:P=!1,selectedSymbol:x="id",isSelectOtherPageCheckbox:a=!1,showBorder:j=!0,getSelectCheckbox:A,hover:F=!1,labelRowsPerPage:W="",itemIsMobileSpacing:M=2,disableCheckbox:g=!1,onClickRow:D,showPagination:f=!0,showRowsPerPageOptions:q=!0,CollapseComponent:R,applyAllDisableCheckbox:Q=!0,sortDirection:o="asc",sortByFn:t=()=>{},orderBy:p="",pageType:T="",items:I}){const E={offset:0,first:S[0]},[G,J]=c.useState(E),[K,Z]=c.useState(!1),[O,w]=c.useState([]),[re]=Me();c.useEffect(()=>{A&&A(O)},[O,I]);const X=async U=>{J(U)},de={...G,count:I.length},xe=c.useCallback(()=>O.length?I.every(U=>{const $=Re(U)?U.node:U;return O.includes($[x])}):!1,[I,O,x]);c.useEffect(()=>{if(a){const U=xe();Z(U)}},[O,G,a,xe]);const me=()=>{a?(()=>{const Y=xe(),se=[...O];Y?I.forEach(ee=>{const ye=Re(ee)?ee.node:ee,we=se.findIndex(Je=>Je===ye[x]);se.splice(we,1)}):I.forEach(ee=>{const ye=Re(ee)?ee.node:ee;O.includes(ye[x])||se.push(ye[x])}),w(se)})():(()=>{if(O.length===I.length)w([]);else{const Y=[];I.forEach(se=>{const ee=Re(se)?se.node:se;ee&&(T==="shoppingListDetailsTable"?Y.push(ee.quantity>0||!ee.disableCurrentCheckbox?ee[x]:""):Y.push(ee[x]))}),w(Y)}})()},ge=U=>{const $=[...O],Y=$.indexOf(U);Y!==-1?$.splice(Y,1):$.push(U),w($)};return e.jsx(Yt,{hover:F,columnItems:r||[],listItems:I.slice(G.offset,G.offset+G.first),pagination:de,rowsPerPageOptions:S,onPaginationChange:X,isCustomRender:n,isInfiniteScroll:re,renderItem:l,tableFixed:h,tableHeaderHide:m,itemSpacing:N,itemXs:B,noDataText:C,tableKey:i,itemIsMobileSpacing:M,showCheckbox:k,showSelectAllCheckbox:P,disableCheckbox:g,selectedSymbol:x,isSelectOtherPageCheckbox:a,isAllSelect:K,selectCheckbox:O,handleSelectAllItems:me,handleSelectOneItem:ge,showBorder:j,labelRowsPerPage:W,onClickRow:D,showPagination:f,showRowsPerPageOptions:q,CollapseComponent:R,applyAllDisableCheckbox:Q,sortDirection:o,sortByFn:t,orderBy:p})}const as=Ge("img")(()=>({maxWidth:"60px",height:"auto",marginRight:"0.5rem"}));function os(r){const{item:n,onEdit:i,onDelete:l,handleUpdateProductQty:C,idEdit:h,len:m,itemIndex:S}=r,{basePrice:N,quantity:B,id:k,primaryImage:P,productName:x,variantSku:a,productsSearch:j,taxPrice:A=0}=n,F=ue(),W=$e(Number(N),Number(A)),M=W*Number(B),g={...n.productsSearch,selectOptions:n.optionList},D=st(g,{}),f=JSON.parse(n.optionList),q=D.filter(t=>t.valueText),{productUrl:R}=j,Q=He({price:Be(W),productInfo:n,showText:F("quoteDraft.quoteSummary.tbd")}),o=He({price:Be(M),productInfo:n,showText:F("quoteDraft.quoteSummary.tbd")});return e.jsx(v,{width:"100%",sx:{borderTop:"1px solid #D9DCE9",borderBottom:S===m-1?"1px solid #D9DCE9":""},children:e.jsxs(We,{sx:{color:"#313440",display:"flex",pl:0},children:[e.jsx(v,{children:e.jsx(as,{src:P||nt,alt:"Product-img",loading:"lazy"})}),e.jsxs(v,{sx:{flex:1},children:[e.jsx(L,{variant:"body1",color:"#212121",onClick:()=>{const{location:{origin:t}}=window;R&&(window.location.href="".concat(t).concat(R))},sx:{cursor:"pointer"},children:x}),e.jsx(L,{variant:"body1",color:"#616161",children:a}),e.jsx(v,{sx:{margin:"1rem 0"},children:f.length>0&&q.length>0&&e.jsx(v,{children:q.map(t=>e.jsx(L,{sx:{fontSize:"0.75rem",lineHeight:"1.5",color:"#455A64"},children:"".concat(t.valueLabel,": ").concat(t.valueText)},t.valueLabel))})}),e.jsx(L,{sx:{fontSize:"14px"},children:"Price: ".concat(Q)}),e.jsx(gt,{size:"small",type:"number",variant:"filled",label:"qty",disabled:!h,inputProps:{inputMode:"numeric",pattern:"[0-9]*"},value:B,sx:{margin:"1rem 0",width:"60%",maxWidth:"100px","& label":{fontSize:"14px"},"& input":{fontSize:"14px"}},onChange:t=>{C(n,t.target.value)}}),e.jsx(L,{sx:{fontSize:"14px"},children:"Total: ".concat(o)}),e.jsxs(v,{sx:{marginTop:"1rem",textAlign:"end"},id:"shoppingList-actionList-mobile",children:[f.length>0&&h&&e.jsx(It,{sx:{marginRight:"0.5rem",cursor:"pointer",color:"rgba(0, 0, 0, 0.54)"},onClick:()=>{i({...j,quantity:B,selectOptions:n.optionList},k)}}),h&&e.jsx(Pt,{sx:{cursor:"pointer",color:"rgba(0, 0, 0, 0.54)"},onClick:()=>{l(k)}})]})]})]})},n.id)}const rs=Ge("div")(()=>({backgroundColor:"#FFFFFF",padding:"0",width:"100%","& tbody":{"& tr":{"& td":{verticalAlign:"top"},"& td: first-of-type":{verticalAlign:"inherit"}},"& tr: hover":{"& #shoppingList-actionList":{opacity:1}}}})),is=Ge("img")(()=>({maxWidth:"60px",height:"auto",marginRight:"0.5rem"})),cs=Ge(gt)(()=>({"& input":{paddingTop:"12px",paddingRight:"6px"}})),Xe=1e6;function ls(r){const{total:n,items:i,idEdit:l=!0,isB2BUser:C,updateSummary:h}=r,m=ue(),S=Nt(),[N,B]=c.useState(!1),[k,P]=c.useState(!1),[x,a]=c.useState(null),[j,A]=c.useState(""),F=H(({global:o})=>o.blockPendingQuoteNonPurchasableOOS.isEnableProduct),W=async(o,t)=>{const p=await Zt(o,Number(t));S(mt({id:p.id,product:{node:p}})),h()},M=async(o,t)=>{let p=Qn(Number(t));p===Number(t)&&p>=1&&p<=Xe||(Number(t)<1&&(p=1),Number(t)>Xe&&(p=Xe),W(o,p))},g=o=>{S(en(o)),h()},D=()=>{P(!1)},f=(o,t)=>{a(o),A(t),P(!0)},q=o=>o.map(t=>{var $,Y;const{variantId:p,newSelectOptionList:T,id:I,productId:E,name:G,quantity:J,variants:K=[],basePrice:Z,taxPrice:O=0,calculatedNoTaxPrice:w=0,calculatedTaxPrice:re=0}=t;let[X]=K;K.length>1&&(X=($=K.find(se=>se.variant_id===p))!=null?$:X);const{image_url:de="",sku:xe}=X;let me;try{me=JSON.stringify(T)}catch(se){me="[]"}const ge=((Y=X.bc_calculated_price)==null?void 0:Y.tax_exclusive)||0;return{node:{basePrice:Z||ge,taxPrice:O,optionList:me,id:I.toString(),primaryImage:de,productId:E,productName:G,productsSearch:{...t,selectOptions:me},quantity:Number(J),variantSku:xe,calculatedTaxPrice:re,calculatedNoTaxPrice:w,calculatedValue:{}}}}),R=async o=>{await Ze(o);const t=q(o);t.forEach(p=>{const{basePrice:T}=p.node,I=p;I.node.id=j,I.node.basePrice=T}),P(!1),S(mt({id:j,product:t[0]})),h(),le.success(m("quoteDraft.quoteTable.productUpdated"))},Q=[{key:"Product",title:m("quoteDraft.quoteTable.product"),render:o=>{var K,Z,O;const t={...o.productsSearch,selectOptions:o.optionList},p=st(t,{}),T=JSON.parse(o.optionList),I=p.filter(w=>w.valueText),E=jt(o),G=((K=o==null?void 0:o.productsSearch)==null?void 0:K.inventoryTracking)||(o==null?void 0:o.inventoryTracking)||"none";let J=((Z=o==null?void 0:o.productsSearch)==null?void 0:Z.inventoryLevel)||(o==null?void 0:o.inventoryLevel)||0;if(G==="variant"){const w=(O=o==null?void 0:o.productsSearch)==null?void 0:O.variants.find(re=>re.sku===o.variantSku);J=w==null?void 0:w.inventory_level}return e.jsxs(v,{sx:{display:"flex",alignItems:"flex-start"},children:[e.jsx(is,{src:o.primaryImage||nt,alt:"Product-img",loading:"lazy"}),e.jsxs(v,{children:[e.jsx(L,{variant:"body1",color:"#212121",onClick:()=>{const{location:{origin:w}}=window;t!=null&&t.productUrl&&(window.location.href="".concat(w).concat(t==null?void 0:t.productUrl))},sx:{cursor:"pointer"},children:o.productName}),e.jsx(L,{variant:"body1",color:"#616161",children:o.variantSku}),T.length>0&&I.length>0&&e.jsx(v,{children:I.map(w=>e.jsx(L,{sx:{fontSize:"0.75rem",lineHeight:"1.5",color:"#455A64"},children:"".concat(w.valueLabel,": ").concat(w.valueText)},w.valueLabel))}),!F&&(E==null?void 0:E.name)&&e.jsxs(v,{sx:{color:"red"},children:[e.jsxs(v,{sx:{mt:"1rem",display:"flex",alignItems:"center","& svg":{mr:"0.5rem"}},children:[e.jsx(Xt,{color:"error",fontSize:"small"}),(E==null?void 0:E.type)==="oos"?m("quoteDraft.quoteTable.outOfStock.tip"):m("quoteDraft.quoteTable.unavailable.tip")]}),(E==null?void 0:E.type)==="oos"&&e.jsx(v,{children:m("quoteDraft.quoteTable.oosNumber.tip",{qty:J})})]})]})]})},width:"40%"},{key:"Price",title:m("quoteDraft.quoteTable.price"),render:o=>{const{basePrice:t,taxPrice:p}=o,T=$e(Number(t),Number(p));return e.jsx(L,{sx:{padding:"12px 0"},children:He({price:Be(T),productInfo:o,showText:m("quoteDraft.quoteSummary.tbd")})})},width:"15%",style:{textAlign:"right"}},{key:"Qty",title:m("quoteDraft.quoteTable.qty"),render:o=>e.jsx(cs,{size:"small",type:"number",variant:"filled",disabled:!l,value:o.quantity,inputProps:{inputMode:"numeric",pattern:"[0-9]*"},onChange:t=>{W(o,Number(t.target.value))},onBlur:t=>{M(o,Number(t.target.value))},sx:{width:"75%"}}),width:"15%",style:{textAlign:"right"}},{key:"Total",title:m("quoteDraft.quoteTable.total"),render:o=>{const{basePrice:t,quantity:p,taxPrice:T}=o,E=$e(Number(t),Number(T))*Number(p),G=JSON.parse(o.optionList);return e.jsxs(v,{children:[e.jsx(L,{sx:{padding:"12px 0"},children:He({price:Be(E),productInfo:o,showText:m("quoteDraft.quoteSummary.tbd")})}),e.jsxs(v,{sx:{marginTop:"1rem",opacity:0,textAlign:"end"},id:"shoppingList-actionList",children:[G.length>0&&l&&e.jsx(It,{sx:{marginRight:"0.5rem",cursor:"pointer",color:"rgba(0, 0, 0, 0.54)"},onClick:()=>{const{productsSearch:J,id:K,optionList:Z,quantity:O}=o;f({...J,quantity:O,selectOptions:Z},K)}}),l&&e.jsx(Pt,{sx:{cursor:"pointer",color:"rgba(0, 0, 0, 0.54)"},onClick:()=>{const{id:J}=o;g(J)}})]})]})},width:"15%",style:{textAlign:"right"}}];return e.jsxs(rs,{children:[e.jsx(v,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",margin:"0.5rem 0 1rem"},children:e.jsx(L,{sx:{fontSize:"24px"},children:m("quoteDraft.quoteTable.totalProducts",{total:n||0})})}),e.jsx(ss,{columnItems:Q,rowsPerPageOptions:[12,24,36],items:i,isCustomRender:!1,hover:!0,labelRowsPerPage:m("quoteDraft.quoteTable.perPage"),showBorder:!1,itemIsMobileSpacing:0,noDataText:m("quoteDraft.quoteTable.noProducts"),renderItem:(o,t)=>e.jsx(os,{len:n||0,item:o,itemIndex:t,onEdit:f,onDelete:g,handleUpdateProductQty:W,idEdit:l})}),e.jsx(Tn,{isOpen:k,isLoading:N,setIsLoading:B,product:x,onCancel:D,onConfirm:R,isEdit:!0,isB2BUser:C})]})}const us=(r,n)=>[{name:"label",label:n("quoteDraft.config.addressLabel"),required:!1,default:"",fieldType:"text",xs:12,variant:"filled",size:"small"},{name:"firstName",label:n("quoteDraft.config.firstName"),required:!1,default:"",fieldType:"text",xs:r?12:6,variant:"filled",size:"small"},{name:"lastName",label:n("quoteDraft.config.lastName"),required:!1,default:"",fieldType:"text",xs:r?12:6,variant:"filled",size:"small"},{name:"companyName",label:n("quoteDraft.config.company"),required:!1,default:"",fieldType:"text",xs:12,variant:"filled",size:"small"},{name:"country",label:n("quoteDraft.config.country"),required:!1,default:"",fieldType:"dropdown",options:[],xs:12,variant:"filled",size:"small",replaceOptions:{label:"countryName",value:"countryCode"}},{name:"address",label:n("quoteDraft.config.addressLine1"),required:!1,default:"",fieldType:"text",xs:12,variant:"filled",size:"small"},{name:"apartment",label:n("quoteDraft.config.addressLine2"),required:!1,default:"",fieldType:"text",xs:12,variant:"filled",size:"small"},{name:"city",label:n("quoteDraft.config.city"),required:!1,default:"",fieldType:"text",options:[],xs:12,variant:"filled",size:"small"},{name:"state",label:n("quoteDraft.config.state"),required:!1,default:"",fieldType:"text",options:[],xs:r?12:6,variant:"filled",size:"small",replaceOptions:{label:"stateName",value:"stateName"}},{name:"zipCode",label:n("quoteDraft.config.zipCode"),required:!1,default:"",fieldType:"text",options:[],xs:r?12:6,variant:"filled",size:"small"},{name:"phoneNumber",label:n("quoteDraft.config.phoneNumber"),required:!1,default:"",fieldType:"text",xs:12,variant:"filled",size:"small"}],ds={address:"",addressId:0,apartment:"",city:"",country:"",firstName:"",label:"",lastName:"",phoneNumber:"",state:"",zipCode:"",companyName:""},ms={address:"",addressId:0,apartment:"",city:"",country:"",firstName:"",label:"",lastName:"",phoneNumber:"",state:"",zipCode:"",companyName:""};function Vs({setOpenPage:r}){const{state:{countriesList:n,openAPPParams:i}}=c.useContext(tt),l=H(Ct),C=H(({company:s})=>s.companyInfo.id),h=H(({company:s})=>s.companyInfo.companyName),m=H(({company:s})=>s.customer),S=H(({company:s})=>s.customer.role),N=Nt(),B=H(({storeConfigs:s})=>s.currencies.enteredInclusiveTax),k=H(({quoteInfo:s})=>s.draftQuoteList),P=H(({b2bFeatures:s})=>s.masqueradeCompany.id),x=H(({b2bFeatures:s})=>s.masqueradeCompany.companyName),a=H(({quoteInfo:s})=>s.draftQuoteInfo),j=H(tn),A=H(({global:s})=>s.quoteSubmissionResponse),{selectCompanyHierarchyId:F}=H(({company:s})=>s.companyHierarchyInfo),W=H(({global:s})=>s.blockPendingQuoteNonPurchasableOOS.isEnableProduct),{state:{portalStyle:{backgroundColor:M="#FEF9F5"}}}=c.useContext(nn),g=c.useMemo(()=>l?sn(pt.quotesCreateActionsPermission,Number(F)):!0,[l,F]),D=Vn(),f=ue(),[q]=Me(),[R,Q]=c.useState(!1),[o,t]=c.useState(!1),[p,T]=c.useState([]),[I,E]=c.useState(!1),[G,J]=c.useState(!1),[K,Z]=c.useState(!1),[O,w]=c.useState(""),[re,X]=c.useState(""),[de,xe]=c.useState([]),me=c.useRef(null),[ge]=bn({level:cn.COMPANY_SUBSIDIARIES,code:pt.getAddressesPermission,containOrEqual:"equal"});Rn();const U=c.useRef(null),$=c.useRef(null),Y=c.useRef(null);c.useEffect(()=>{(async()=>{var pe,ne,Ee,je,qe,ve,Qe,Ae,fe,Ce,Fe,ze,_e,Te,Oe,Se,Ie,V,u,ie,Pe,Ve,ke,he;Q(!0);const d=ce=>{const ae={...ce};ae.contactInfo={name:"".concat(m.firstName," ").concat(m.lastName),email:m.emailAddress,companyName:h||x||"",phoneNumber:m.phoneNumber},N(Ke(ae))},z=De(a);try{if(l){const ae=C||P;let oe=[];const _=async te=>{const{addresses:{edges:be}}=await Cn(te);return be};F?F&&ge&&(oe=await _(Number(F))):oe=await _(Number(ae));const y=oe.find(te=>{var be;return((be=te==null?void 0:te.node)==null?void 0:be.isDefaultShipping)===1}),b=oe.find(te=>{var be;return((be=te==null?void 0:te.node)==null?void 0:be.isDefaultBilling)===1});if(y&&Ue(z,"shippingAddress")){const te={label:((pe=y==null?void 0:y.node)==null?void 0:pe.label)||"",firstName:((ne=y==null?void 0:y.node)==null?void 0:ne.firstName)||"",lastName:((Ee=y==null?void 0:y.node)==null?void 0:Ee.lastName)||"",companyName:((je=y==null?void 0:y.node)==null?void 0:je.company)||"",country:((qe=y==null?void 0:y.node)==null?void 0:qe.countryCode)||"",address:((ve=y==null?void 0:y.node)==null?void 0:ve.addressLine1)||"",apartment:((Qe=y==null?void 0:y.node)==null?void 0:Qe.addressLine2)||"",city:((Ae=y==null?void 0:y.node)==null?void 0:Ae.city)||"",state:((fe=y==null?void 0:y.node)==null?void 0:fe.state)||"",zipCode:((Ce=y==null?void 0:y.node)==null?void 0:Ce.zipCode)||"",phoneNumber:((Fe=y==null?void 0:y.node)==null?void 0:Fe.phoneNumber)||"",addressId:(ze=y==null?void 0:y.node)!=null&&ze.id?Number(y.node.id):0};z.shippingAddress=te}if(b&&(!(z!=null&&z.billingAddress)||Ue(z,"billingAddress"))){const te={label:((_e=b==null?void 0:b.node)==null?void 0:_e.label)||"",firstName:((Te=b==null?void 0:b.node)==null?void 0:Te.firstName)||"",lastName:((Oe=b==null?void 0:b.node)==null?void 0:Oe.lastName)||"",companyName:((Se=b==null?void 0:b.node)==null?void 0:Se.company)||"",country:((Ie=b==null?void 0:b.node)==null?void 0:Ie.countryCode)||"",address:((V=b==null?void 0:b.node)==null?void 0:V.addressLine1)||"",apartment:((u=b==null?void 0:b.node)==null?void 0:u.addressLine2)||"",city:((ie=b==null?void 0:b.node)==null?void 0:ie.city)||"",state:((Pe=b==null?void 0:b.node)==null?void 0:Pe.state)||"",zipCode:((Ve=b==null?void 0:b.node)==null?void 0:Ve.zipCode)||"",phoneNumber:((ke=b==null?void 0:b.node)==null?void 0:ke.phoneNumber)||"",addressId:(he=b==null?void 0:b.node)!=null&&he.id?Number(b.node.id):0};z.billingAddress=te}T(oe)}else if(S!==100){const{customerAddresses:{edges:ae=[]}}=await Sn(),oe=ae.map(_=>({node:gn(_.node)}));T(oe)}const ce=await Ln();if(ce.length){xe(ce);const ae=z.extraFields,oe=ce==null?void 0:ce.map(_=>{var b;const y=((b=ae==null?void 0:ae.find(te=>te.fieldName===_.name))==null?void 0:b.value)||(_==null?void 0:_.default);return{id:Number(_.id),fieldName:_.name,value:y||""}});z.extraFields=oe}z&&(!(z!=null&&z.contactInfo)||Ue(z,"contactInfo"))&&Number(S)!==100?d(z):z&&N(Ke(z))}finally{const ce=m.b2bId||m.id||0;N(rn(Number(ce))),Q(!1)}})()},[F,ge]);const se=c.useMemo(()=>{const s=a.contactInfo||{};return{info:{quoteTitle:(s==null?void 0:s.quoteTitle)||"",referenceNumber:(a==null?void 0:a.referenceNumber)||""},extraFields:a.extraFields||[],recipients:a.recipients||[]}},[a]),ee=()=>{const s={shippingAddress:ds,billingAddress:ms};return $!=null&&$.current&&(s.billingAddress=$.current.getContactInfoValue()),Y!=null&&Y.current&&(s.shippingAddress=Y.current.getContactInfoValue()),s},ye=async s=>{N(pn(s))},we=async s=>{if(U!=null&&U.current){const d=await U.current.getContactInfoValue();if(!d)return!1;const z=(s==null?void 0:s.recipients)||[];d.ccEmail.trim().length&&(s.recipients=An(Fn(z,[d.ccEmail]))),s.contactInfo={name:d==null?void 0:d.name,email:d==null?void 0:d.email,companyName:(d==null?void 0:d.companyName)||"",phoneNumber:d==null?void 0:d.phoneNumber,quoteTitle:d==null?void 0:d.quoteTitle},s.referenceNumber=(d==null?void 0:d.referenceNumber)||"";const pe=de.map(ne=>({id:Number(ne.id),fieldName:ne.name,value:ne.name?d[ne.name]:""}));return s.extraFields=pe,!0}return!1},Je=async()=>{const s=De(a);if(U!=null&&U.current&&!await we(s))return;const{shippingAddress:d,billingAddress:z}=ee();s.shippingAddress=d,s.billingAddress=z,Object.keys(s.contactInfo).every(ne=>ne==="phoneNumber"||ne==="companyName"||ne==="quoteTitle"?!0:!!s.contactInfo[ne])&&(N(Ke(s)),t(!1))},Dt=()=>{t(!0)},at=us(q,f),ot=()=>{var s;(s=me.current)==null||s.refreshSummary()},Lt=s=>{yt(s)},Bt=s=>S===100?[]:s.map(d=>({fileUrl:d.fileUrl,fileName:d.fileName,fileType:d.fileType,fileSize:d.fileSize})),wt=()=>{N(fn()),N(xn()),ft.delete("cartToQuoteId")},rt=(s,d)=>{const z=s||O,pe=d||re;z&&(wt(),D("/quoteDetail/".concat(z,"?date=").concat(pe),{state:{to:"draft"}}))},it=async()=>{Q(!0);try{const s=De(a);if(o&&(U!=null&&U.current)&&!await we(s))return;const d=(s==null?void 0:s.contactInfo)||{},z=(d==null?void 0:d.quoteTitle)||"";"quoteTitle"in d&&delete d.quoteTitle;const pe=Object.keys(d).every(V=>V==="phoneNumber"||V==="companyName"?!0:d&&!!d[V]);if(Ue(a,"contactInfo")||!pe){le.error(f("quoteDraft.addQuoteInfo"));return}if(!k||k.length===0){le.error(f("quoteDraft.submit"));return}if(!W&&k.some(u=>{var ie;return(ie=jt(u))==null?void 0:ie.name})){le.error(f("quoteDraft.submit.errorTip"));return}const Ee=((s==null?void 0:s.note)||"").trim().replace(/[\r\n]/g,"\\n"),je=V=>{const u=De(V),ie=n==null?void 0:n.find(Pe=>Pe.countryCode===u.country);return ie&&(u.country=ie.countryName),u.address=(V==null?void 0:V.address)||"",u.apartment=(V==null?void 0:V.apartment)||"",u},{shippingAddress:qe,billingAddress:ve}=$!=null&&$.current?ee():s,Qe=qe?je(qe):{},Ae=ve?je(ve):{};let fe=0,Ce=0;const Fe=V=>typeof V=="string"&&V.includes("-")?"".concat(new Date(V).getTime()/1e3):V,ze=k.map(V=>{var ae,oe;const{node:u}=V,ie={...u.productsSearch,selectOptions:(u==null?void 0:u.optionList)||""},Ve=st(ie,{}).map(_=>({optionId:_.optionId,optionValue:_.fieldType==="date"?Fe(_.optionValue):_.optionValue,optionLabel:"".concat(_.valueText),optionName:_.valueLabel,type:(_==null?void 0:_.fieldOriginType)||_.fieldType})).filter(_=>!!_.optionName)||[],ke=(ae=u==null?void 0:u.productsSearch)==null?void 0:ae.variants;let he;return Array.isArray(ke)&&(he=ke.find(_=>_.sku===u.variantSku)),fe+=Number((u==null?void 0:u.basePrice)||0)*Number((u==null?void 0:u.quantity)||0),Ce+=Number((u==null?void 0:u.taxPrice)||0)*Number((u==null?void 0:u.quantity)||0),{productId:(oe=u==null?void 0:u.productsSearch)==null?void 0:oe.id,sku:u.variantSku,basePrice:Number((u==null?void 0:u.basePrice)||0).toFixed(j.decimal_places),discount:"0.00",offeredPrice:Number((u==null?void 0:u.basePrice)||0).toFixed(j.decimal_places),quantity:u.quantity,variantId:he==null?void 0:he.variant_id,imageUrl:u.primaryImage,productName:u.productName,options:Ve}}),_e=Bt((a==null?void 0:a.fileInfo)||[]),Te={message:Ee,legalTerms:"",totalAmount:B?fe.toFixed(j.decimal_places):(fe+Ce).toFixed(j.decimal_places),grandTotal:fe.toFixed(j.decimal_places),subtotal:fe.toFixed(j.decimal_places),companyId:l?F||C||P:"",storeHash:un,quoteTitle:z,discount:"0.00",channelId:ln,userEmail:m.emailAddress,shippingAddress:Qe,billingAddress:Ae,contactInfo:d,productList:ze,fileList:_e,taxTotal:Ce.toFixed(j.decimal_places),currency:{currencyExchangeRate:j.currency_exchange_rate,token:j.token,location:j.token_location,decimalToken:j.decimal_token,decimalPlaces:j.decimal_places,thousandsToken:j.thousands_token,currencyCode:j.currency_code},referenceNumber:"".concat(s.referenceNumber)||"",extraFields:s.extraFields||[],recipients:s.recipients||[]},Oe=Number(S)===99?Nn:jn;if(!Ot("on-quote-create",Te))throw new Error;const{quoteCreate:{quote:{id:Se,createdAt:Ie}}}=await Oe(Te);if(w(Se),X(Ie),Se){const V=ft.get("cartToQuoteId"),u=dn(V);await mn(u)}A.value==="0"?rt(Se,Ie):Z(!0)}catch(s){qt.error(s)}finally{Q(!1)}},Et=()=>{Z(!1),rt()},Qt=()=>{let s=Number(S)===100?f("quoteDraft.button.back"):f("quoteDraft.button.backToQuoteLists");return(i==null?void 0:i.quoteBtn)==="open"?s=f("quoteDraft.button.back"):(i==null?void 0:i.quoteBtn)==="add"&&(s=f("quoteDraft.button.backToProduct")),s};return c.useEffect(()=>{if(G&&I&&$.current){const s=$.current.getContactInfoValue();Y.current&&Y.current.setShippingInfoValue(s)}},[G,I]),e.jsxs(an,{isSpinning:R,children:[e.jsxs(v,{sx:{mb:"60px",width:"100%"},children:[e.jsx(v,{sx:{marginBottom:"10px",width:"fit-content",displayPrint:"none"},children:e.jsxs(v,{sx:{color:"primary.main",cursor:"pointer",display:"flex",alignItems:"center"},onClick:()=>{i!=null&&i.quoteBtn||Number(S)===100?(D("/"),r({isOpen:!1,openUrl:""})):D("/quotes")},children:[e.jsx(On,{fontSize:"small",sx:{fontSize:"12px",marginRight:"0.5rem"}}),e.jsx("p",{style:{margin:"0"},children:Qt()})]})}),e.jsxs(v,{sx:{display:"flex",justifyContent:"space-between"},children:[e.jsxs(v,{sx:{display:"flex",mb:"24px",flexDirection:q?"column":"row",alignItems:q?"flex-start":"center"},children:[e.jsx(L,{component:"h3",sx:{fontSize:"34px",mr:"1rem",mb:q?"1rem":"0",color:on(M)},children:f("quoteDraft.title.Quote")}),e.jsx(yn,{code:"0"})]}),g&&e.jsx(v,{children:q?e.jsx(v,{sx:{position:"fixed",left:0,bottom:0,background:"#FFF",width:"100%",display:"flex",p:"8px 0",zIndex:100,justifyContent:"center"},children:e.jsx(Le,{variant:"contained",size:"small",sx:{height:"38px",width:"90%"},onClick:it,children:f("quoteDraft.button.submit")})}):e.jsx(Le,{variant:"contained",size:"small",sx:{padding:"8px 22px",alignSelf:"center",marginBottom:"24px"},onClick:it,children:f("quoteDraft.button.submit")})})]}),e.jsxs(v,{children:[!o&&e.jsx(Pn,{quoteAndExtraFieldsInfo:se,status:"Draft",contactInfo:a==null?void 0:a.contactInfo,shippingAddress:a==null?void 0:a.shippingAddress,billingAddress:(a==null?void 0:a.billingAddress)||{},handleEditInfoClick:Dt}),o&&e.jsxs(Ye,{flexDirection:"column",children:[e.jsx(Mn,{emailAddress:m.emailAddress,info:a==null?void 0:a.contactInfo,referenceNumber:(a==null?void 0:a.referenceNumber)||"",quoteExtraFields:de,extraFieldsDefault:a.extraFields||[],recipients:(a==null?void 0:a.recipients)||[],handleSaveCCEmail:ye,ref:U}),e.jsxs(v,{sx:{display:"flex",mt:q?0:"3rem",flexDirection:q?"column":"row"},children:[e.jsx(xt,{title:f("quoteDraft.section.billing"),info:a==null?void 0:a.billingAddress,addressList:p,pr:q?0:"8px",ref:$,role:S,accountFormFields:at,shippingSameAsBilling:I,type:"billing",setBillingChange:J}),e.jsx(xt,{title:f("quoteDraft.section.shipping"),info:a==null?void 0:a.shippingAddress,addressList:p,pl:q?0:"8px",ref:Y,role:S,accountFormFields:at,shippingSameAsBilling:I,type:"shipping",setBillingChange:J})]}),e.jsx(Ft,{label:f("quoteDraft.checkbox.sameAddressShippingAndBilling"),control:e.jsx(zt,{checked:I,onChange:s=>{if(E(s.target.checked),$.current){const d=$.current.getContactInfoValue();Y.current&&s.target.checked&&Y.current.setShippingInfoValue(d)}}}),sx:{mt:2}}),e.jsx(Le,{sx:{mt:"20px",mb:"15px"},onClick:Je,variant:"outlined",children:f("quoteDraft.button.saveInfo")})]})]}),e.jsxs(v,{sx:{mt:"20px",display:"flex",flexDirection:q?"column":"row",alignItems:"flex-start"},children:[e.jsx(Ye,{flexDirection:"column",xs:{flexBasis:q?"100%":"680px",flexGrow:2,marginRight:"20px",marginBottom:"20px",boxShadow:"0px 2px 1px -1px rgba(0, 0, 0, 0.2), 0px 1px 1px rgba(0, 0, 0, 0.14), 0px 1px 3px rgba(0, 0, 0, 0.12)",borderRadius:"4px"},children:e.jsx(ls,{updateSummary:ot,total:k.length,items:k,isB2BUser:l})}),e.jsx(Ye,{flexDirection:"column",xs:{flexBasis:q?"100%":"340px",marginBottom:"20px",backgroundColor:"transparent",padding:0,flexGrow:1},children:e.jsxs(_t,{spacing:2,sx:{width:"100%"},children:[e.jsx(ns,{ref:me}),e.jsx($n,{updateList:ot,addToQuote:Lt,isB2BUser:l}),e.jsx(kn,{quoteStatus:"Draft"}),S!==100&&e.jsx(Dn,{status:0})]})})]})]}),e.jsx(es,{isOpen:K,onClose:Et,quoteSubmissionResponseInfo:A})]})}export{Vs as default};
//# sourceMappingURL=index-DVbf6F3w.js.map
