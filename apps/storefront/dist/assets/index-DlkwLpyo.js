import{j as c,B as h,ai as U}from"./mui-BLXOPN2Y.js";import{r as y}from"./reactVendor-BTcQ-GDs.js";import{u as V}from"./lang-DZEhsX8V.js";import{t as L}from"./lodashEs-DKEtmQJE.js";import{j as T,C as z,ac as D,ad as M,u,t as S,ae as W,B as A,af as $,ag as G}from"./react-setup-Dk2lMx-W.js";import"./load-functions-adwiw1MZ.js";import"./base-BCVDEF8S.js";import{c as H,a as J}from"./users-BXLfwXk2.js";import{g as K,a as O}from"./accountSetting-D25-Ib2V.js";import{d,g as Q}from"./config-1L-KDVt7.js";import{v as X}from"./validatorRules-BRQ7DvFQ.js";import{u as Y}from"./router-DEI8QtBD.js";import"./intl-CKipw3rV.js";import"./eCache-BdHG5F0B.js";import"./redux-D7_Lh1Zo.js";import"./toolkit-C5fVsw89.js";import"../index.COFs9ak5.js";import"./global-D7Yn0gGb.js";import"./muiIcon-DcrdeM0-.js";import"./dateFns-CXOS6Mtj.js";import"./dropzone-BOmS2zFM.js";const Z=()=>[{name:"company",fieldId:"field_company",label:"Company",required:!1,default:"",fieldType:"text",xs:12,variant:"filled",size:"small"},{name:"role",fieldId:"field_role",label:"Role",required:!1,default:"",fieldType:"text",xs:12,variant:"filled",size:"small"}],aa=()=>[{name:"currentPassword",fieldId:"field_current_password",label:"Current Password",required:!1,default:"",fieldType:"password",xs:12,variant:"filled",size:"small"},{name:"password",fieldId:"field_password",label:"Password",required:!1,default:"",fieldType:"password",xs:12,variant:"filled",size:"small"},{name:"confirmPassword",fieldId:"field_confirm_password",label:"Confirm Password",required:!1,default:"",fieldType:"password",xs:12,variant:"filled",size:"small"}],_=X(["email"]),ea=(a,i,n,s)=>{const r=(a==null?void 0:a.extraFields)||[];return i.forEach(e=>{const l=e;d((e==null?void 0:e.name)||"")==="first_name"&&(l.default=a.firstName),d((e==null?void 0:e.name)||"")==="last_name"&&(l.default=a.lastName),d((e==null?void 0:e.name)||"")==="phone"&&(l.default=a.phoneNumber),d((e==null?void 0:e.name)||"")==="email"&&(l.default=a.email,l.validate=_)}),r.length>0&&r.forEach(e=>{const l=e,t=i.find(f=>d((f==null?void 0:f.name)||"")===l.fieldName);t&&(t.default=l.fieldValue)}),n.forEach(e=>{const l=e;e.name==="role"?(l.default=a.companyRoleName,l.disabled=!0):e.name==="company"&&(l.default=a.company,l.disabled=!0)}),s.forEach(e=>{const l=((a==null?void 0:a.formFields)||[]).find(f=>f.name===e.bcLabel),t=e;l&&(t.default=l.value)}),[...i,...n,...s]},sa=(a,i,n)=>(i.forEach(s=>{const r=s;d((s==null?void 0:s.name)||"")==="first_name"&&(r.default=a.firstName),d((s==null?void 0:s.name)||"")==="last_name"&&(r.default=a.lastName),d((s==null?void 0:s.name)||"")==="phone"&&(r.default=a.phoneNumber),d((s==null?void 0:s.name)||"")==="email"&&(r.default=a.email,r.validate=_),d((s==null?void 0:s.name)||"")==="company"&&(r.default=a.company)}),n.forEach(s=>{const r=((a==null?void 0:a.formFields)||[]).find(l=>l.name===s.bcLabel),e=s;r&&(e.default=r.value)}),[...i,...n]);function la(){const a=u(S),i=u(({company:o})=>o.companyInfo.id),n=u(({company:o})=>o.customer),s=u(({company:o})=>o.customer.role),r=u(({b2bFeatures:o})=>o.masqueradeCompany.id),e=u(({b2bFeatures:o})=>o.masqueradeCompany.isAgenting),l=Number(s===3&&e?r:i),t=!a||s===3&&!e;return{isBCUser:t,companyId:l,customer:n,validateEmailValue:async o=>{if(n.emailAddress===L(o))return!0;const x={email:o,channelId:G},{isValid:m}=t?await H(x):await J(x);return m},emailValidation:o=>!(o.email!==n.emailAddress&&!o.currentPassword),passwordValidation:o=>o.password===o.confirmPassword}}function ga(){const{isBCUser:a,companyId:i}=la(),[n,s]=T("sf-isFinishUpdate",!1,sessionStorage),{state:{portalStyle:{backgroundColor:r="#FEF9F5"}}}=y.useContext(z),e=V(),l=Y(),[t,f]=y.useState(!1),[F,C]=y.useState(!1),[o,x]=y.useState([]);return y.useEffect(()=>{(async()=>{try{f(!0);const N=a?K:O,j=a?{}:{companyId:i},k=a?"customerAccountSettings":"accountSettings",q=await W(a?1:2),w=Q(q.accountFormFields||[]),I=((w==null?void 0:w.contactInformation)||[]).filter(p=>p.fieldId!=="field_email_marketing_newsletter"),{additionalInformation:v=[]}=w,{[k]:E}=await N(j),P=a?sa(E,I,v):ea(E,I,Z(),v),R=aa(),b=[...P,...R].find(p=>p.name==="role");b!=null&&b.fieldType&&(b.fieldType="text");const{data:g=[]}=await A.get("/api/v3/io/sales-staffs","B2BEditionRest",{companyId:i});if(g.length>0){const p=await Promise.all(g.map(B=>A.get("/api/v3/io/sales-staffs/".concat(B.id),"B2BEditionRest")));x(p.map(B=>B.data))}}finally{n&&($.success(e("accountSettings.notification.detailsUpdated")),s(!1)),f(!1),C(!0)}})()},[]),c.jsx(D,{isSpinning:t,background:r,children:F&&c.jsx(h,{mt:4,children:o.length===0?c.jsx(M,{variant:"outlined",fullWidth:!0,onClick:()=>l("/quote"),children:"Request Sales Assistance"}):c.jsx(U,{direction:"row",children:o.map(m=>c.jsxs(h,{sx:{p:2,m:2,border:"1px solid #ddd",borderRadius:"8px",backgroundColor:"#fff"},children:[c.jsx(h,{fontWeight:"bold",children:m.name}),c.jsxs(h,{children:["Email: ",m.email]}),c.jsxs(h,{children:["Phone: ",m.phoneNumber]})]},m.id))})})})}export{ga as default};
//# sourceMappingURL=index-DlkwLpyo.js.map
