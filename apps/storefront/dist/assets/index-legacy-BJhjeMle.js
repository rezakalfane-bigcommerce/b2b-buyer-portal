System.register(["./mui-legacy-CSHs1xoY.js","./reactVendor-legacy-CtYIj4Ma.js","./lang-legacy-DzjbYnyQ.js","./B3Filter-legacy-BEROEqGA.js","./react-setup-legacy-drlPxekq.js","./load-functions-legacy-D4REYUJ_.js","./base-legacy-D2P4nFX7.js","./QuoteStatus-legacy-BO6mbslm.js","./useSort-legacy-CfCrn6Eb.js","./router-legacy-s4T0V6vG.js","./intl-legacy-B7uNycgM.js","./eCache-legacy-CW-H9Ud9.js","./B3FilterMore-legacy-DMCxdSH1.js","./form-legacy-CAo5v63e.js","./B3CustomForm-legacy-LwY9NVZ0.js","./lodashEs-legacy-5FC1NR51.js","./muiIcon-legacy-B9QnU93P.js","./dateFns-legacy-BcrsSUH8.js","./B3FilterSearch-legacy-BKkHq57Z.js","./redux-legacy-D5ZHjMNV.js","./toolkit-legacy-uWyLsHZ1.js","../index-legacy.Dey7ot32.js","./global-legacy-B1EgakWG.js","./dropzone-legacy-30_HfosJ.js"],(function(e,t){"use strict";var a,s,r,l,o,u,n,d,i,c,m,p,y,b,g,q,x,f,A,h,C,j,B,N,k,R,P,I,L;return{setters:[e=>{a=e.y,s=e.j,r=e.K,l=e.ad,o=e.w,u=e.B,n=e.T},e=>{d=e.r},e=>{i=e.u},e=>{c=e.B},e=>{m=e.a5,p=e.bg,y=e.aM,b=e.au,g=e.aw,q=e.a,x=e.G,f=e.ac,A=e.ak,h=e.u,C=e.t,j=e.bf,B=e.bJ,N=e.ag},null,null,e=>{k=e.Q,R=e.o,P=e.p},e=>{I=e.u},e=>{L=e.u},null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){e("default",(function(){const{getAvailableFilters:e,draftQuoteListLength:t,customer:a,getQuotesList:r}=function(){const e=h((({company:e})=>e.companyInfo.id)),t=h((({company:e})=>e.customer)),a=h(C),s=h((({quoteInfo:e})=>e.draftQuoteList.length)),r=h((({b2bFeatures:e})=>e.masqueradeCompany.id)),l=i(),o=e||r,u=e=>a?R({...e,channelId:N}):P({...e,channelId:N}),n=()=>[{name:"status",label:l("quotes.quoteStatus"),required:!1,default:"",fieldType:"dropdown",options:E.map((({idLangCustomLabel:e,...t})=>({customLabel:l(e),...t}))),replaceOptions:{label:"customLabel",value:"statusCode"},xs:12,variant:"filled",size:"small"}],d=async()=>{const e=await B(Number(o),2),t=e?.createdByUser?.results?.createdBy.map((e=>({createdBy:e.email?`${e.name} (${e.email})`:`${e.name}`})))||[],a=e?.createdByUser?.results?.salesRep.map((e=>({salesRep:`${e.salesRep||e.salesRepEmail}`})))||[];return[...n(),{name:"createdBy",label:l("quotes.createdBy"),required:!1,default:"",fieldType:"dropdown",options:t,replaceOptions:{label:"createdBy",value:"createdBy"},xs:12,variant:"filled",size:"small"},{name:"salesRep",label:l("quotes.salesRep"),required:!1,default:"",fieldType:"dropdown",options:a,replaceOptions:{label:"salesRep",value:"salesRep"},xs:12,variant:"filled",size:"small"}]},c=async()=>a?d():n();return{companyId:o,isB2BUser:a,draftQuoteListLength:s,customer:t,getQuotesList:u,getAvailableFilters:c}}(),l=Q(),o={q:"",orderBy:`-${D[F]}`,createdBy:"",salesRep:"",status:"",dateCreatedBeginAt:"",dateCreatedEndAt:""},[n,m]=d.useState(o),[p,y]=d.useState(!1),[b,g]=d.useState([]),[j,k,S]=I(D,F,n,m),T=L(),v=i(),[U]=q(),{state:{openAPPParams:V},dispatch:z}=d.useContext(x);d.useEffect((()=>{e().then((e=>g(e))),V.quoteBtn&&z({type:"common",payload:{openAPPParams:{quoteBtn:"",shoppingListBtn:""}}})}),[]);const K=(e,t)=>{0===Number(t)?T("/quoteDraft"):T(`/quoteDetail/${e.id}?date=${e.createdAt}`)},M=d.useCallback((async e=>{const{edges:s=[],totalCount:l}=await r(e);if(0===e.offset&&t){const e=$(),t={node:{quoteNumber:"—",quoteTitle:"—",createdAt:"—",salesRepEmail:"—",createdBy:`${a.firstName} ${a.lastName}`,updatedAt:"—",expiredAt:"—",totalAmount:e?.grandTotal,status:0,taxTotal:e?.tax}},{status:r,createdBy:l,salesRep:o,dateCreatedBeginAt:u,dateCreatedEndAt:d}=n,i=!(r||o||u||d);if(l&&i){const e=/^[^(]+/.exec(l);(e?.length?e[0].trim():"")===t.node.createdBy&&s.unshift(t)}else i&&s.unshift(t)}return{edges:s,totalCount:l}}),[r,t,a.firstName,a.lastName,n]);return s.jsx(f,{isSpinning:p,children:s.jsxs(u,{sx:{display:"flex",flexDirection:"column",flex:1},children:[s.jsx(c,{filterMoreInfo:b,startPicker:{isEnabled:!0,label:v("quotes.from"),defaultValue:n?.dateCreatedBeginAt||"",pickerKey:"start"},endPicker:{isEnabled:!0,label:v("quotes.to"),defaultValue:n?.dateCreatedEndAt||"",pickerKey:"end"},handleChange:(e,t)=>{"search"===e&&m({...n,q:t})},handleFilterChange:e=>{const t={createdBy:e?.createdBy||"",status:e?.status||"",salesRep:e?.salesRep||"",dateCreatedBeginAt:e?.startValue||"",dateCreatedEndAt:e?.endValue||""};m({...n,...t})}}),s.jsx(A,{columnItems:l,rowsPerPageOptions:[10,20,30],getRequestList:M,searchParams:n,isCustomRender:!1,requestLoading:y,tableKey:"quoteNumber",sortDirection:k,orderBy:S,sortByFn:j,labelRowsPerPage:v(U?"quotes.cardsPerPage":"quotes.quotesPerPage"),renderItem:e=>s.jsx(w,{item:e,goToDetail:K}),onClickRow:e=>{K(e,Number(e.status))},hover:!0})]})})}));const t={subtotal:0,shipping:0,tax:0,grandTotal:0},{decimal_places:S=2}=y(),T=e=>parseFloat(e.toFixed(S)),$=()=>{const{draftQuoteList:e}=m.getState().quoteInfo,{showInclusiveTaxPrice:a}=m.getState().global;return e.reduce(((e,t)=>{const{basePrice:s,taxPrice:r=0,quantity:l,additionalCalculatedPrices:o=[]}=t.node;let{subtotal:u,grandTotal:n,tax:d}=e;const{shipping:i}=e;let c=0,m=0;return o.forEach((e=>{c+=e.additionalCalculatedPriceTax,m+=e.additionalCalculatedPrice})),u+=T(p(Number(s)+m,Number(r))*l),d+=T((Number(r)+c)*l),n=a?u+i:u+i+d,{grandTotal:n,shipping:i,tax:d,subtotal:u}}),{...t})},v=o("div")({display:"flex",flexDirection:"column",alignItems:"start",marginBottom:"1rem"});function w(e){const{item:t,goToDetail:o}=e,d=a(),c=i(),m=d.palette.primary.main,p=[{key:"quoteTitle",title:c("quotes.quoteItemCard.title")},{key:"salesRepEmail",title:c("quotes.quoteItemCard.salesRep")},{key:"createdBy",title:c("quotes.quoteItemCard.createdBy")},{key:"createdAt",title:c("quotes.quoteItemCard.dateCreated"),render:()=>`${0!==Number(t.status)?b(Number(t.createdAt)):t.createdAt}`},{key:"updatedAt",title:c("quotes.quoteItemCard.lastUpdate"),render:()=>`${0!==Number(t.status)?b(Number(t.updatedAt)):t.updatedAt}`},{key:"expiredAt",title:c("quotes.quoteItemCard.expirationDate"),render:()=>`${0!==Number(t.status)?b(Number(t.expiredAt)):t.expiredAt}`},{key:"totalAmount",title:c("quotes.quoteItemCard.subtotal"),render:()=>{const{totalAmount:e}=t;return g(Number(e))}}];return s.jsx(r,{children:s.jsxs(l,{sx:{color:"rgba(0, 0, 0, 0.6)"},children:[s.jsxs(v,{children:[s.jsx(u,{sx:{display:"flex",alignItems:"center",mb:"1rem"},children:s.jsx(n,{variant:"h6",sx:{color:"rgba(0, 0, 0, 0.87)"},children:t.quoteNumber})}),s.jsx(u,{children:s.jsx(k,{code:t.status})})]}),p.map((e=>s.jsxs(u,{sx:{display:"flex"},children:[s.jsx(n,{sx:{fontWeight:"bold",color:"rgba(0, 0, 0, 0.87)",mr:"5px",whiteSpace:"nowrap"},children:`${e.title}:`}),s.jsx(n,{sx:{color:"black",wordBreak:"break-all"},children:e?.render?e.render():t[e.key]})]},e.key))),s.jsx(u,{onClick:()=>o(t,Number(t.status)),sx:{mt:"1rem",pl:0,color:m||"#1976D2",cursor:"pointer",fontWeight:"bold",display:"inline-block"},children:c("quotes.quoteItemCard.view")})]})})}const E=[{idLangCustomLabel:"quotes.open",statusCode:1},{idLangCustomLabel:"quotes.ordered",statusCode:4},{idLangCustomLabel:"quotes.expired",statusCode:5}],F="quoteNumber",D={quoteNumber:"quoteNumber",quoteTitle:"quoteTitle",salesRep:"salesRep",createdBy:"createdBy",createdAt:"createdAt",updatedAt:"updatedAt",expiredAt:"expiredAt",status:"status"},Q=()=>{const e=i();return d.useMemo((()=>[{key:"quoteNumber",title:e("quotes.quoteNumber"),isSortable:!0},{key:"quoteTitle",title:e("quotes.title"),isSortable:!0},{key:"salesRep",title:e("quotes.salesRep"),render:e=>`${e.salesRep||e.salesRepEmail}`,isSortable:!0},{key:"createdBy",title:e("quotes.createdBy"),isSortable:!0},{key:"createdAt",title:e("quotes.dateCreated"),render:e=>`${0!==Number(e.status)?b(Number(e.createdAt)):e.createdAt}`,isSortable:!0},{key:"updatedAt",title:e("quotes.lastUpdate"),render:e=>`${0!==Number(e.status)?b(Number(e.updatedAt)):e.updatedAt}`,isSortable:!0},{key:"expiredAt",title:e("quotes.expirationDate"),render:e=>`${0!==Number(e.status)?b(Number(e.expiredAt)):e.expiredAt}`,isSortable:!0},{key:"totalAmount",title:e("quotes.subtotal"),render:e=>{const{totalAmount:t,currency:a}=e,s=a;return j(Number(t),{currency:s,isConversionRate:!1,useCurrentCurrency:!!a})},style:{textAlign:"right"}},{key:"status",title:e("quotes.status"),render:e=>s.jsx(k,{code:e.status}),isSortable:!0}]),[e])}}}}));
//# sourceMappingURL=index-legacy-BJhjeMle.js.map
