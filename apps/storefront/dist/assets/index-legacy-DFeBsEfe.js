System.register(["./mui-legacy-nJi-LPwx.js","./reactVendor-legacy-CtYIj4Ma.js","./load-functions-legacy-Cd9k4nWw.js","./react-setup-legacy-DuBzGPOI.js","./lang-legacy-1f-gtWXv.js","./base-legacy-D2P4nFX7.js","./b2bGetVariantImageByVariantInfo-legacy-DOFINwoC.js","./B3FilterMore-legacy-D080M85H.js","./lodashEs-legacy-5FC1NR51.js","./useSort-legacy-CfCrn6Eb.js","./B3FilterSearch-legacy-CRbD-f_e.js","./B3LinkTipContent-legacy-CpZX40OQ.js","./b3TriggerCartNumber-legacy-CXlx3yUO.js","./CreateShoppingList-legacy-CfKsV72Z.js","./OrderShoppingList-legacy-CJtozxI6.js","./router-legacy-s4T0V6vG.js","./muiIcon-legacy-CbXEHT38.js","./SearchProduct-legacy-BG_tbJPL.js","./useBlockPendingAccountViewPrice-legacy-DO2Hc-4y.js","./form-legacy-CAo5v63e.js","./B3CustomForm-legacy-CZbiJ61c.js","./intl-legacy-B7uNycgM.js","./eCache-legacy-CW-H9Ud9.js","../index-legacy.CUzweyJF.js","./global-legacy-B1EgakWG.js","./redux-legacy-D5ZHjMNV.js","./toolkit-legacy-uWyLsHZ1.js","./dateFns-legacy-Bs-ooDPO.js","./dropzone-legacy-C0uLCPXC.js","./useB2BCallback-legacy-BNykb3hy.js","./b3ShoppingList-legacy-DMMzTiDZ.js"],(function(e,t){"use strict";var r,s,n,a,i,o,d,u,c,l,p,h,x,m,g,y,f,k,b,P,j,S,v,I,C,q,N,w,O,A,L,T,E,B,Q,V,D,$,_,F,z,R,M,U,W,G,K,H,Y,J,Z,X,ee,te,re,se,ne,ae,ie,oe,de,ue,ce,le,pe,he,xe,me;return{setters:[e=>{r=e.j,s=e.B,n=e.ae,a=e.s,i=e.T,o=e.f,d=e.ac,u=e.G,c=e.X,l=e.Y,p=e.d,h=e.L,x=e.ah,m=e.a0},e=>{g=e.r},null,e=>{y=e.a5,f=e.B,k=e.aN,b=e.aw,P=e.au,j=e.u,S=e.t,v=e.a,I=e.aY,C=e.ac,q=e.ak,N=e.aZ,w=e.a_,O=e.a$,A=e.b0,L=e.af,T=e.b1,E=e.G,B=e.a0,Q=e.ad,V=e.aS,D=e.a1,$=e.b2,_=e.b3,F=e.b4,z=e.b5,R=e.b6,M=e.aO,U=e.aP,W=e.b7,G=e.aQ,K=e.aR,H=e.b8},e=>{Y=e.u},e=>{J=e.b},e=>{Z=e.b},e=>{X=e.d,ee=e.B,te=e.a},e=>{re=e.e},e=>{se=e.u},e=>{ne=e.B},e=>{ae=e.s},e=>{ie=e.b},e=>{oe=e.default},e=>{de=e.default},e=>{ue=e.u},e=>{ce=e.d},e=>{le=e.S,pe=e.d},e=>{he=e.u},e=>{xe=e.u},e=>{me=e.B},null,null,null,null,null,null,null,null,null,null],execute:function(){e("default",(function(){const e=j(S),t=j((({b2bFeatures:e})=>e.masqueradeCompany.isAgenting)),[n]=v(),[a,i]=g.useState(!1),[o,d]=g.useState([]),{purchasabilityPermission:c}=j(B),l=!e||c;return r.jsxs(s,{sx:{width:"100%"},children:[r.jsx(s,{sx:{display:"flex",justifyContent:"center"},children:r.jsxs(u,{sx:{m:0,width:"100%"},container:!0,spacing:2,children:[r.jsx(u,{item:!0,xs:n?12:8,sx:{backgroundColor:"#ffffff",boxShadow:"0px 2px 1px -1px rgba(0, 0, 0, 0.2), 0px 1px 1px rgba(0, 0, 0, 0.14), 0px 1px 3px rgba(0, 0, 0, 0.12)",borderRadius:"4px",pr:"16px"},children:r.jsx(Ce,{setCheckedArr:d,setIsRequestLoading:i,isRequestLoading:a})}),r.jsx(u,{item:!0,xs:n?12:4,sx:{pt:n?"16px":"0px !important",pl:n?"0px !important":"16px"},children:l&&r.jsx(Ae,{isB2BUser:e})})]})}),r.jsx(s,{sx:{position:"fixed",bottom:0,left:0,width:"100%",zIndex:"999"},children:r.jsx(we,{checkedArr:o,isAgenting:t,setIsRequestLoading:i,isB2BUser:e})})]})}));const t=(e,t,r)=>{const{global:{showInclusiveTaxPrice:s}}=y.getState(),n=e.find((e=>Number(e.variant_id)===t||r===e.sku));if(n&&!re(n)){const e=n.bc_calculated_price;return Number(s?e.tax_inclusive:e.tax_exclusive)}return!1},ge=e=>`{\n  orderedProducts (\n    q: "${e.q||""}"\n    first: ${e.first}\n    offset: ${e.offset}\n    beginDateAt: "${e.beginDateAt}"\n    endDateAt: "${e.endDateAt}"\n    orderBy: "${e?.orderBy||""}"\n  ){\n    totalCount,\n    pageInfo{\n      hasNextPage,\n      hasPreviousPage,\n    },\n    edges{\n      node {\n        id,\n        createdAt,\n        updatedAt,\n        productName,\n        productBrandName,\n        variantSku,\n        productId,\n        variantId,\n        optionList,\n        orderedTimes,\n        firstOrderedAt,\n        lastOrderedAt,\n        lastOrderedItems,\n        sku,\n        lastOrdered,\n        imageUrl,\n        baseSku,\n        basePrice,\n        discount,\n        tax,\n        enteredInclusive,\n        productUrl,\n        optionSelections,\n      }\n    }\n  }\n}`,ye=e=>f.graphqlB2B({query:ge(e)}),fe=e=>f.graphqlB2B({query:ge(e)}),ke=a("img")((()=>({maxWidth:"60px",height:"auto",marginRight:"0.5rem"})));function be(e){const{item:t,checkBox:a,handleUpdateProductQty:d}=e,u=Y(),{quantity:c,imageUrl:l,productName:p,variantSku:h,optionList:x,basePrice:m,lastOrderedAt:g,variantId:y,productsSearch:f}=t,j=Number(m)*Number(c),S=f.variants||[],v=Z(S,{variantId:y})||l;return r.jsx(s,{sx:{borderTop:"1px solid #D9DCE9"},children:r.jsxs(n,{sx:{color:"#313440",display:"flex",pl:0},children:[r.jsx(s,{children:a&&a()}),r.jsx(s,{children:r.jsx(ke,{src:v||k,alt:"Product-img",loading:"lazy"})}),r.jsxs(s,{sx:{flex:1},children:[r.jsx(i,{variant:"body1",color:"#212121",children:p}),r.jsx(i,{variant:"body1",color:"#616161",children:h}),r.jsx(s,{sx:{margin:"1rem 0"},children:x.length>0&&r.jsx(s,{children:x.map((e=>r.jsx(i,{sx:{fontSize:"0.75rem",lineHeight:"1.5",color:"#455A64"},children:`${e.display_name}: ${e.display_value}`},e.display_name)))})}),r.jsx(i,{sx:{fontSize:"14px"},children:u("purchasedProducts.quickOrderCard.price",{price:b(j)})}),r.jsx(s,{sx:{"& label":{zIndex:0}},children:r.jsx(o,{size:"small",type:"number",variant:"filled",label:"Qty",inputProps:{inputMode:"numeric",pattern:"[0-9]*"},value:c,sx:{margin:"1rem 0",width:"60%",maxWidth:"100px","& label":{fontSize:"14px"},"& input":{fontSize:"14px"}},onChange:e=>{d(t.id,e.target.value)}})}),r.jsx(i,{sx:{fontSize:"14px"},children:u("purchasedProducts.quickOrderCard.lastOrdered",{lastOrderedAt:P(g)})})]})]})},t.id)}const Pe=a("img")((()=>({maxWidth:"60px",height:"auto",marginRight:"0.5rem"}))),je=a(s)((()=>({display:"flex",flexDirection:"column",width:"100%","& tbody":{"& tr":{"& td":{verticalAlign:"top"},"& td: first-of-type":{paddingTop:"25px"}}}}))),Se=a(o)((()=>({"& input":{paddingTop:"12px",paddingRight:"6px"}}))),ve="lastOrderedAt",Ie={product:"productName",lastOrderedAt:"lastOrderedAt"};function Ce({setIsRequestLoading:e,setCheckedArr:n,isRequestLoading:a}){const o=g.useRef(null),d=j(S),u=j((({company:e})=>e.companyInfo.id)),c=j((({company:e})=>e.customer.customerGroupId)),[l,p]=g.useState({q:"",beginDateAt:X(90),endDateAt:X(0),orderBy:`-${Ie[ve]}`}),[h,x,m]=se(Ie,ve,l,p),[y,f]=g.useState(0),[T]=v(),E=Y(),{currency_code:B}=j(I),Q=(e,t)=>{if(""!==t&&Number(t)<=0)return;const r=o.current?.getList()||[],s=o.current?.getCacheList()||[],n=r?.map((r=>{const{node:s}=r;return s?.id===e&&(s.quantity=Number(t)||""),r})),a=s?.map((r=>{const{node:s}=r;return s?.id===e&&(s.quantity=Number(t)||""),r}));o.current?.setList([...n]),o.current?.setCacheAllList([...a])},V=(e,t)=>{const{productsSearch:{isPriceHidden:r}}=t;return r?"":N({price:e,productInfo:t,showText:r?"":e,forcedSkip:!0})},D=e=>{const t=o.current?.getCacheList()||[];let r=e.quantity;if(t.length>0){const s=t.find((t=>t.node.variantId===e.variantId&&t.node.productId===e.productId&&t.node.id===e.id));s&&s.node&&(r=s.node.quantity||r)}return r},$=[{key:"product",title:E("purchasedProducts.product"),render:e=>{const{optionList:t,productsSearch:n,variantId:a}=e,o=n.variants||[],d=Z(o,{variantId:a})||e.imageUrl;return r.jsxs(s,{sx:{display:"flex",alignItems:"flex-start"},children:[r.jsx(Pe,{src:d||k,alt:"Product-img",loading:"lazy"}),r.jsxs(s,{children:[r.jsx(i,{variant:"body1",color:"#212121",children:e.productName}),r.jsx(i,{variant:"body1",color:"#616161",children:e.variantSku}),t.length>0&&r.jsx(s,{children:t.map((e=>r.jsx(i,{sx:{fontSize:"0.75rem",lineHeight:"1.5",color:"#455A64"},children:`${e.display_name}: ${e.display_value}`},e.id)))})]})]})},width:"40%",isSortable:!0},{key:"price",title:E("purchasedProducts.price"),render:e=>{const{productsSearch:{variants:s},variantId:n,basePrice:a}=e;let o=Number(a);s?.length&&(o=t(s,Number(n))||Number(a));const d=D(e),u=(o||Number(a))*Number(d);return r.jsx(i,{sx:{padding:"12px 0"},children:`${V(b(u),e)}`})},width:"15%",style:{textAlign:"right"}},{key:"qty",title:E("purchasedProducts.qty"),render:e=>{const t=D(e);return r.jsx(Se,{size:"small",type:"number",variant:"filled",value:t,inputProps:{inputMode:"numeric",pattern:"[0-9]*"},onChange:t=>{Q(e.id,t.target.value)}})},width:"15%",style:{textAlign:"right"}},{key:"lastOrderedAt",title:E("purchasedProducts.lastOrdered"),render:e=>r.jsx(s,{children:r.jsx(i,{sx:{padding:"12px 0"},children:`${P(Number(e.lastOrderedAt))}`})}),width:"15%",style:{textAlign:"right"},isSortable:!0}];return r.jsx(C,{isSpinning:a,children:r.jsxs(je,{children:[r.jsx(i,{sx:{fontSize:"24px",height:"50px"},children:E("purchasedProducts.totalProducts",{total:y})}),r.jsxs(s,{sx:{marginBottom:"5px",display:"flex","& label":{zIndex:0}},children:[r.jsxs(s,{sx:{width:T?"100%":"40%",mr:"20px",display:"flex",justifyContent:T?"space-between":"flex-start"},children:[r.jsx(ne,{h:"48px",searchBGColor:"rgba(0, 0, 0, 0.06)",handleChange:e=>{(async e=>{p({...l,q:e})})(e)}}),T&&r.jsx(s,{sx:{display:"flex",alignItems:"center"},children:r.jsx(ee,{filterMoreInfo:[],startPicker:{isEnabled:!0,label:E("purchasedProducts.from"),defaultValue:l?.beginDateAt||"",pickerKey:"start"},endPicker:{isEnabled:!0,label:E("purchasedProducts.to"),defaultValue:l?.endDateAt||"",pickerKey:"end"},isShowMore:!0,onChange:e=>{const t={...l};t.beginDateAt=e.startValue,t.endDateAt=e.endValue,p(t)}})})]}),!T&&r.jsx(te,{handleChange:(e,t)=>{const r={...l};"start"===e?r.beginDateAt=t||X(90):r.endDateAt=t||X(0),p(r)},xs:{mt:0,height:"50px"},startPicker:{isEnabled:!0,label:E("purchasedProducts.from"),defaultValue:X(90),pickerKey:"start"},endPicker:{isEnabled:!0,label:E("purchasedProducts.to"),defaultValue:X(),pickerKey:"end"},customWidth:"58%"})]}),r.jsx(q,{ref:o,columnItems:$,rowsPerPageOptions:[12,24,36],getRequestList:async e=>{const{orderedProducts:{edges:t,totalCount:r}}=d?await ye(e):await fe(e),s=await(async e=>{if(e.length>0){const r=[];e.forEach((e=>{const{node:t}=e;t.quantity=1,r.includes(t.productId)||r.push(t.productId)}));const s=d?w:O;try{const{productsSearch:t}=await s({productIds:r,currencyCode:B,companyId:u,customerGroupId:c}),n=A(t);return e.forEach((e=>{const{node:t}=e,r=n.find((e=>{const{id:r}=e;return Number(t.productId)===Number(r)}));t.productsSearch=r||{}})),e}catch(t){L.error(t)}}return[]})(t);return f(r),{edges:s,totalCount:r}},searchParams:l,isCustomRender:!1,showCheckbox:!0,showSelectAllCheckbox:!0,disableCheckbox:!1,hover:!0,labelRowsPerPage:E("purchasedProducts.itemsPerPage"),showBorder:!1,requestLoading:e,getSelectCheckbox:e=>{if(e.length>0){const t=o.current?.getCacheList()||[],r=e.reduce(((e,r)=>{const s=t.find((e=>{const{node:t}=e;return t.id===r}));return s&&e.push(s),e}),[]);n([...r])}else n([])},itemIsMobileSpacing:0,isSelectOtherPageCheckbox:!0,noDataText:E("purchasedProducts.noProductsFound"),sortDirection:x,orderBy:m,sortByFn:h,renderItem:(e,t,s)=>r.jsx(be,{item:e,checkBox:s,handleUpdateProductQty:Q})})]})})}const qe=async()=>{const{data:{site:{cart:e}}}=await T();if(e){const{lineItems:t}=e;return Object.keys(t).reduce(((e,r)=>(t[r].forEach((t=>{e.push(t)})),e)),[])}return[]},Ne=async(e,t)=>{const r=await qe();return e.reduce(((e,t)=>{const{node:s}=t,n=r.find((e=>e.sku===s?.sku&&Number(e?.variantEntityId||0)===Number(s?.variantId||0)))?.quantity||0;return e.push({...s?.productsSearch,variantId:s?.variantId,quantity:(s?.quantity||0)+n}),e}),[]).every((e=>((e,t)=>{const{variantId:r,variants:s,inventoryLevel:n,inventoryTracking:a,orderQuantityMaximum:i,orderQuantityMinimum:o,quantity:d,sku:u}=e,c=y.getState().global?.blockPendingQuoteNonPurchasableOOS?.isEnableProduct||!1,l="none"!==a;let p=!1,h=n,x=u;const m=s.find((e=>Number(e.variant_id)===Number(r)));return m&&(p=m.purchasing_disabled,h="variant"===a?m.inventory_level:h,x=m.sku||u),p&&!c?(L.error(t("purchasedProducts.quickOrderPad.notPurchaseableSku",{notPurchaseSku:x})),{isVerify:!1,type:"notPurchaseableSku"}):l&&Number(d)>Number(h)?(L.error(t("purchasedProducts.quickOrderPad.insufficientStockSku",{sku:x}),{isClose:!0}),{isVerify:!1,type:"insufficientStockSku"}):Number(o)>0&&Number(d)<o?(L.error(t("purchasedProducts.quickOrderPad.minQuantityMessage",{minQuantity:o,sku:x}),{isClose:!0}),{isVerify:!1,type:"minQuantity"}):Number(i)>0&&Number(d)>Number(i)?(L.error(t("purchasedProducts.quickOrderPad.maxQuantityMessage",{maxQuantity:i,sku:x}),{isClose:!0}),{isVerify:!1,type:"maxQuantity"}):{isVerify:!0}})(e,t).isVerify))};function we(e){const{checkedArr:n,isAgenting:a,setIsRequestLoading:o,isB2BUser:h}=e,{state:{productQuoteEnabled:x=!1,shoppingListEnabled:m=!1}}=g.useContext(E),y=Y(),f=j((e=>e.company.companyInfo.id)),{currency_code:P}=j(I),{purchasabilityPermission:S}=j(B),C=!h||S,q=d("(min-width:1775px)"),[N]=v(),T=g.useRef(null),[W,G]=g.useState(!1),[K,H]=g.useState(0),[Z,X]=g.useState(!1),[ee,te]=g.useState(!1),[re,se]=g.useState(!1),ne=j((e=>e.company.customer.customerGroupId)),le=ue(),pe=N?{alignItems:"flex-start",flexDirection:"column"}:{alignItems:"center"},he=()=>{G(!1)},xe=e=>0===e?.length?[]:e.map((({product_option_id:e,value:t})=>({optionId:`attribute[${e}]`,optionValue:t}))),me=e=>r.jsxs(s,{sx:{display:"flex",alignItems:"center"},children:[r.jsx(s,{sx:{mr:"15px"},children:y("purchasedProducts.footer.productsAddedToShoppingList")}),r.jsx(p,{onClick:()=>(e=>{le(`/shoppingList/${e}`)})(e),variant:"text",sx:{color:"#ffffff",padding:0},children:"view shopping list"})]}),ge=e=>{X(!1),te(!1)},ye=()=>{te(!1),X(!0)},fe=()=>{he(),ye(),X(!0)},ke=[{name:y("purchasedProducts.footer.addToCart"),key:"add-selected-to-cart",handleClick:async()=>{o(!0),he();try{const e=[];if(n.forEach((t=>{const{node:r}=t;e.includes(Number(r.productId))||e.push(Number(r.productId))})),0===e.length)return void L.error(y("purchasedProducts.footer.selectOneItemToAdd"));if(!(await Ne(n,y)))return;const t=f,r=h?w:O,{productsSearch:s}=await r({productIds:e,companyId:t,customerGroupId:ne}),a=(e=>{const t=[];return n.forEach((r=>{const{node:s}=r,n=e.find((e=>Number(s.productId)===e.id));if(n){const{variants:e}=n;if(e.length>0){const r=e.find((e=>s.variantSku===e.sku&&Number(s.variantId)===Number(e.variant_id)));if(r){const{optionList:e,quantity:n}=s,a=e.map((e=>({optionId:e.product_option_id,optionValue:e.value})));t.push({optionSelections:a,allOptions:e,productId:parseInt(r.product_id,10)||0,quantity:n,variantId:parseInt(r.variant_id,10)||0})}}}})),t})(s||[]),i=await V(a);i&&!i.errors?L.success("",{jsx:ae({message:y("purchasedProducts.footer.productsAdded"),link:D,linkText:y("purchasedProducts.footer.viewCart"),isOutLink:!0,isCustomEvent:!0}),isClose:!0}):i&&i.errors?L.error(i.errors[0].message,{isClose:!0}):L.error("Error has occurred",{isClose:!0})}finally{ie(),o(!1)}},isDisabled:!C},{name:y("purchasedProducts.footer.addToQuote"),key:"add-selected-to-quote",handleClick:async()=>{o(!0),he();try{const e=n.filter((e=>{const{node:{variantSku:t}}=e;return""!==t&&null!=t})),t=n.filter((e=>{const{node:{variantSku:t}}=e;return!t}));if(t.length>0&&L.error(y("purchasedProducts.footer.cantAddProductsNoSku"),{isClose:!0}),t.length===n.length)return;const r=[];e.forEach((e=>{const{node:t}=e;r.includes(Number(t.productId))||r.push(Number(t.productId))}));const s=h?w:O,{productsSearch:a}=await s({productIds:r,companyId:f,customerGroupId:ne,currencyCode:P}),i=A(a);let o=!1,d="",u=!0;const c=[];if(e.forEach((e=>{const{node:{basePrice:t,optionList:r,variantSku:s,productId:n,productName:a,quantity:l,variantId:p,tax:h}}=e,x=xe(r),m=i.find((e=>Number(e.id)===Number(n))),g=m?.variants.find((e=>e.sku===s));g||(d=y("purchasedProducts.footer.notFoundSku",{sku:s}),u=!1);const f={node:{id:$(),variantSku:g?.sku||s,variantId:p,productsSearch:m,primaryImage:g?.image_url||k,productName:a,quantity:Number(l)||1,optionList:JSON.stringify(x),productId:n,basePrice:t,tax:h}};c.push(f),o=!0})),o=_(c),!u)return void L.error("",{jsx:ae({message:d,link:"",linkText:"",isOutLink:!1}),isClose:!0});o?(await F(c,"2"),z(c),L.success("",{jsx:ae({message:y("purchasedProducts.footer.productsAddedToQuote"),link:"/quoteDraft",linkText:y("purchasedProducts.footer.viewQuote"),isOutLink:!1}),isClose:!0})):L.error("",{jsx:ae({message:y("purchasedProducts.footer.productsLimit"),link:"/quoteDraft",linkText:y("purchasedProducts.footer.viewQuote"),isOutLink:!1}),isClose:!0})}catch(e){J.error(e)}finally{o(!1)}},isDisabled:!x},{name:y("purchasedProducts.footer.addSelectedProductsToShoppingList"),key:"add-selected-to-shoppingList",handleClick:fe,isDisabled:!m}];g.useEffect((()=>{if(n.length>0){let e=0;n.forEach((r=>{const{node:{variantId:s,productsSearch:{variants:n},quantity:a,basePrice:i}}=r;if(n?.length){const r=t(n,Number(s))||Number(i||0);e+=r*Number(a)}else e+=Number(i||0)*Number(a)})),H(1e3*e/1e3)}else H(0)}),[n]);let be={display:N?"initial":"flex",flexBasis:"100%"};return q&&(be={display:"flex",flexGrow:1,maxWidth:1775,margin:"auto"}),r.jsxs(r.Fragment,{children:[C||x||m?r.jsx(u,{sx:{position:"fixed",bottom:N&&a?"52px":0,left:0,backgroundColor:"#fff",width:"100%",padding:N?"0 0 1rem 0":"16px 0 16px",height:N?"8rem":"auto",marginLeft:0,display:"flex",flexWrap:"nowrap",zIndex:"1000"},container:!0,spacing:2,children:r.jsxs(u,{item:N,sx:be,children:[r.jsx(s,{sx:{width:263,display:N?"none":"block"}}),r.jsxs(s,{sx:{flex:1,display:"flex",alignItems:"center",paddingLeft:N?0:"50px",paddingRight:N?0:"80px"},children:[r.jsxs(s,{sx:{width:N?"100%":"calc(66.6667% + 32px)",display:"flex",zIndex:"999",justifyContent:"space-between",...pe},children:[r.jsx(i,{sx:{color:"#000000",fontSize:"16px",fontWeight:"400"},children:y("purchasedProducts.footer.selectedProducts",{quantity:n.length})}),r.jsxs(s,{sx:{display:"flex",alignItems:"center",flexWrap:N?"wrap":"nowrap",width:N?"100%":"auto"},children:[r.jsx(i,{variant:"h6",sx:{fontSize:"16px",fontWeight:"700",color:"#000000"},children:y("purchasedProducts.footer.subtotal",{subtotal:b(K)})}),r.jsxs(s,{sx:{display:"flex",alignItems:"center",marginTop:N?"0.5rem":0,marginLeft:N?0:"20px",width:N?"100%":"auto"},children:[r.jsx(Q,{variant:"contained",ref:T,onClick:()=>{0===n.length?L.error(y("purchasedProducts.error.selectOneItem")):G(!0)},sx:{marginRight:N?"1rem":0,width:N?"100%":"auto"},endIcon:r.jsx(ce,{}),children:y("purchasedProducts.footer.addSelectedTo")}),r.jsx(c,{id:"basic-menu",anchorEl:T.current,open:W,onClose:he,MenuListProps:{"aria-labelledby":"basic-button"},children:ke.length>0&&ke.map((e=>e.isDisabled?null:r.jsx(l,{onClick:()=>{e.handleClick()},children:e.name},e.key)))})]})]})]}),r.jsx(s,{sx:{width:"33.3333%",display:N?"none":"block"}})]})]})}):null,r.jsx(de,{isOpen:Z,dialogTitle:y("purchasedProducts.footer.addToShoppingList"),onClose:ge,onConfirm:async e=>{se(!0);try{const t=[];n.forEach((e=>{const{node:r}=e;t.includes(Number(r.productId))||t.push(Number(r.productId))}));const r=[];n.forEach((e=>{const{node:{optionList:t,productId:s,quantity:n,variantId:a,productsSearch:i}}=e,o=xe(t),d=R(o,i);r.push({productId:Number(s),variantId:Number(a),quantity:Number(n),optionList:d})}));const s=h?M:U;await s({shoppingListId:Number(e),items:r}),L.success(y("purchasedProducts.footer.productsAddedToShoppingList"),{jsx:()=>me(e),isClose:!0}),ge()}catch(t){J.error(t)}finally{se(!1)}},onCreate:()=>{X(!1),te(!0)},isLoading:re,setLoading:se}),r.jsx(oe,{open:ee,onChange:fe,onClose:ye})]})}function Oe(e){const t=Y(),{updateList:n=(()=>{}),quickAddToList:a,level:o=3,buttonText:d=t("purchasedProducts.quickAdd.addProductToList")}=e,c=j(S),l=j((({company:e})=>e.companyInfo.status)),[p,h]=g.useState(o),[x,m]=g.useState([]),[y,f]=g.useState(!1),k=(e,t)=>{new Array(e).fill(1).forEach(((e,r)=>t(r)))};g.useEffect((()=>{let e=[];k(p,(r=>{e=[...e,...W(r,t)]})),m(e)}),[p]);const[b]=he(),{control:P,handleSubmit:v,getValues:I,formState:{errors:q},setError:N,setValue:w}=xe({mode:"all"}),O=e=>{const r={};let s=!0;return k(p,(n=>{const a=e[`sku-${n}`],i=e[`qty-${n}`];if(s=!1!==((e,r,s)=>{if(!r&&!s)return!0;let n=!0;const a=parseInt(s,10)||0;return r||(N(`sku-${e}`,{type:"manual",message:t("global.validate.required",{label:t("purchasedProducts.quickAdd.sku")})}),n=!1),s?a<=0&&(N(`qty-${e}`,{type:"manual",message:"incorrect number"}),n=!1):(N(`qty-${e}`,{type:"manual",message:t("global.validate.required",{label:t("purchasedProducts.quickAdd.qty")})}),n=!1),n})(n,a,i)&&s,s&&a){const e=parseInt(i,10)||0;r[a]=r[a]?r[a]+e:e}})),{skuValue:r,isValid:s,skus:Object.keys(r)}},A=(e,t,r,s)=>{t.forEach((t=>{const n=Object.keys(e).find((r=>e[r]===t))||"";n&&N(n.replace("sku",r),{type:"manual",message:s})}))},T=()=>{b&&0===l?L.info("Your business account is pending approval. This feature is currently disabled."):v((async e=>{try{f(!0);const{skuValue:r,isValid:s,skus:i}=O(e);if(!s||i.length<=0)return;const o=await(async e=>{const t=c?G:K;try{const{variantSku:r}=await t({skus:e},!0);return r}catch(r){return[]}})(i),{notFoundSku:d,notPurchaseSku:u,productItems:l,passSku:p,notStockSku:h,orderLimitSku:x}=await(async(e,t,r)=>{const s=[],n=[],a=[],i=[],o=[],d=[],u=await qe();return r.forEach((r=>{const c=(e||[]).find((e=>e.variantSku.toUpperCase()===r.toUpperCase()));if(!c)return void s.push(r);const{productId:l,variantId:p,option:h,purchasingDisabled:x="1",stock:m,isStock:g,maxQuantity:y,minQuantity:f,variantSku:k}=c,b=u.find((e=>e.sku===k&&Number(e?.variantEntityId||0)===Number(p||0)))?.quantity||0,P=t[r]||0,j=t[r]+b||0;if("1"===x)return void n.push(r);if("1"===g&&P>Number(m))return void o.push({sku:r,stock:Number(m)});if(0!==y&&0!==f&&j>0&&(j>y||j<f))return void d.push({sku:r,min:j<f?f:0,max:j>y?y:0});const S=(h||[]).reduce(((e,t)=>{try{const r="string"==typeof t?JSON.parse(t):t;return e.push({optionId:`attribute[${r.option_id}]`,optionValue:`${r.id}`}),e}catch(r){return e}}),[]);i.push(r),a.push({...c,newSelectOptionList:S,productId:parseInt(l,10)||0,quantity:P,variantId:parseInt(p,10)||0})})),{notFoundSku:s,notPurchaseSku:n,notStockSku:o,productItems:a,passSku:i,orderLimitSku:d}})(o,r,i);if(d.length>0&&(A(e,d,"sku",""),L.error(t("purchasedProducts.quickAdd.notFoundSku",{notFoundSku:d.join(",")}),{isClose:!0})),u.length>0&&(A(e,u,"sku",""),L.error(t("purchasedProducts.quickAdd.notPurchaseableSku",{notPurchaseSku:u.join(",")}),{isClose:!0})),h.length>0){const r=h.map((e=>e.sku));h.forEach((t=>{const{sku:r,stock:s}=t;A(e,[r],"qty",`${s} in stock`)})),L.error(t("purchasedProducts.quickAdd.insufficientStockSku",{stockSku:r.join(",")}),{isClose:!0})}x.length>0&&x.forEach((r=>{const{min:s,max:n,sku:a}=r,i=0===s?n:s;A(e,[a],"qty",`${0===s?"Max":"Min"} is ${i}`);const o=0===s?"maximum":"minimum";L.error(t("purchasedProducts.quickAdd.purchaseQuantityLimitMessage",{typeText:o,limit:i,sku:a}),{isClose:!0})})),l.length>0&&(await a(l),((e,t)=>{t.forEach((t=>{const r=Object.keys(e).find((r=>e[r]===t))||"";r&&(w(r,""),w(r.replace("sku","qty"),""))}))})(e,p),n())}finally{f(!1)}}))()};return r.jsx(C,{isSpinning:y,spinningHeight:"auto",children:r.jsxs(s,{sx:{width:"100%"},children:[r.jsxs(u,{container:!0,sx:{margin:"16px 0"},children:[r.jsx(u,{item:!0,sx:{flex:1,display:"flex",alignItems:"center"},children:r.jsx(i,{sx:{color:"#000"},variant:"body1",children:t("purchasedProducts.quickAdd.title")})}),r.jsx(u,{item:!0,children:r.jsx(Q,{variant:"text",sx:{textTransform:"initial",ml:"-8px"},onClick:()=>{h(p+o)},children:t("purchasedProducts.quickAdd.showMoreRowsButton")})})]}),r.jsx(s,{onKeyDown:e=>{"Enter"===e.key&&T()},sx:{"& label":{zIndex:0}},children:r.jsx(me,{formFields:x,errors:q,control:P,getValues:I,setValue:w})}),r.jsx(Q,{variant:"outlined",fullWidth:!0,disabled:y,onClick:T,sx:{margin:"20px 0"},children:r.jsx(C,{isSpinning:y,tip:"",size:16,children:r.jsx(s,{sx:{flex:1,textAlign:"center"},children:d})})})]})})}function Ae(e){const{isB2BUser:t}=e,[a]=v(),o=Y(),[d,u]=g.useState(!1),[c,l]=g.useState([]),[p,y]=g.useState("Add to cart"),[f,k]=g.useState(!1),[b]=he(),P=j((({company:e})=>e.companyInfo.status)),S=async e=>{const t=await V(e);return t&&t.errors?L.error(t.errors[0].message,{isClose:!0}):L.success("",{jsx:ae({message:o("purchasedProducts.quickOrderPad.productsAdded"),link:D,linkText:o("purchasedProducts.quickOrderPad.viewCart"),isOutLink:!0,isCustomEvent:!0}),isClose:!0}),ie(),t};return g.useEffect((()=>{c?.length>0&&y(o("purchasedProducts.quickOrderPad.addNProductsToCart",{quantity:c.length}))}),[c]),r.jsxs(h,{sx:{marginBottom:a?"8.5rem":"50px"},children:[r.jsx(n,{children:r.jsxs(s,{children:[r.jsx(i,{variant:"h5",sx:{marginBottom:"1rem"},children:o("purchasedProducts.quickOrderPad.quickOrderPad")}),r.jsx(le,{addToList:async e=>{const t=e.map((e=>({node:{...e,productsSearch:e}}))),r=await Ne(t,o);try{r&&await S(e)}catch(s){J.error(s)}return e},searchDialogTitle:o("purchasedProducts.quickOrderPad.quickOrderPad"),type:"quickOrder",addButtonText:o("purchasedProducts.quickOrderPad.addToCart"),isB2BUser:t}),r.jsx(x,{}),r.jsx(Oe,{quickAddToList:S,buttonText:o("purchasedProducts.quickOrderPad.addProductsToCart")}),r.jsx(x,{}),r.jsx(s,{sx:{margin:"20px 0 0"},children:r.jsxs(Q,{variant:"text",onClick:()=>{b&&0===P?L.info(o("purchasedProducts.quickOrderPad.addNProductsToCart")):u(!0)},children:[r.jsx(pe,{sx:{marginRight:"8px"}}),o("purchasedProducts.quickOrderPad.bulkUploadCSV")]})})]})}),r.jsx(H,{isOpen:d,setIsOpen:u,handleAddToList:async e=>{k(!0);try{const{stockErrorFile:t,validProduct:s}=e,{notPurchaseSku:n,productItems:a,limitProduct:i,minLimitQuantity:d,maxLimitQuantity:c,outOfStock:l}=(e=>{const t=[],r=[],s=[],n=[],a=[],i=[];return e.forEach((e=>{const{products:o,qty:d}=e,{option:u,isStock:c,stock:l,purchasingDisabled:p,maxQuantity:h,minQuantity:x,variantSku:m,variantId:g,productId:y,modifiers:f}=o;if("1"===p||p)return void t.push(m);if("1"===c&&0===l)return void i.push(m);if("1"===c&&l>0&&l<Number(d))return void s.push({variantSku:m,AvailableAmount:l});if(Number(x)>0&&Number(d)<Number(x))return void n.push({variantSku:m,minQuantity:x});if(Number(h)>0&&Number(d)>Number(h))return void a.push({variantSku:m,maxQuantity:h});const k=u.map((e=>({optionId:e.option_id,optionValue:e.id})));r.push({productId:parseInt(y,10)||0,variantId:parseInt(g,10)||0,quantity:Number(d),optionSelections:k,allOptions:f})})),{notPurchaseSku:t,productItems:r,limitProduct:s,minLimitQuantity:n,maxLimitQuantity:a,outOfStock:i}})(s);a.length>0&&((e=>{e&&!e.errors?L.success("",{jsx:ae({message:o("purchasedProducts.quickOrderPad.productsAdded"),link:D,linkText:o("purchasedProducts.quickOrderPad.viewCart"),isOutLink:!0,isCustomEvent:!0}),isClose:!0}):L.error("Error has occurred",{isClose:!0})})(await V(a)),ie()),i.length>0&&i.forEach((e=>{L.warning("",{jsx:()=>(e=>r.jsxs(r.Fragment,{children:[r.jsx("p",{style:{margin:0},children:o("purchasedProducts.quickOrderPad.notEnoughStock",{variantSku:e.variantSku})}),r.jsx("p",{style:{margin:0},children:o("purchasedProducts.quickOrderPad.availableAmount",{availableAmount:e.AvailableAmount})})]}))(e)})})),n.length>0&&L.error(o("purchasedProducts.quickOrderPad.notPurchaseableSku",{notPurchaseSku:n.join(",")}),{isClose:!0}),l.length>0&&t&&L.error("",{jsx:()=>((e,t)=>r.jsxs(r.Fragment,{children:[r.jsx("p",{style:{margin:0},children:o("purchasedProducts.quickOrderPad.outOfStockSku",{outOfStock:e.join(",")})}),r.jsx(m,{href:t,sx:{color:"#FFFFFF"},children:o("purchasedProducts.quickOrderPad.downloadErrorsCSV")})]}))(l,t),isClose:!0}),d.length>0&&d.forEach((e=>{L.error(o("purchasedProducts.quickOrderPad.minQuantityMessage",{minQuantity:e.minQuantity,sku:e.variantSku}),{isClose:!0})})),c.length>0&&c.forEach((e=>{L.error(o("purchasedProducts.quickOrderPad.maxQuantityMessage",{maxQuantity:e.maxQuantity,sku:e.variantSku}),{isClose:!0})})),u(!1)}finally{k(!1)}},setProductData:l,addBtnText:p,isLoading:f,isToCart:!0})]})}}}}));
//# sourceMappingURL=index-legacy-DFeBsEfe.js.map
