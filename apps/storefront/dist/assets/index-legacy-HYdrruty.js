System.register(["./mui-legacy-CLOaLEk9.js","./reactVendor-legacy-CtYIj4Ma.js","./form-legacy-CAo5v63e.js","./lang-legacy-TODaA4m_.js","./lodashEs-legacy-5FC1NR51.js","./react-setup-legacy-0xe2iPqH.js","./B3CustomForm-legacy-B_8DkWdD.js","./load-functions-legacy-PJaV-5hU.js","./base-legacy-D2P4nFX7.js","./users-legacy-CSdOP61H.js","./accountSetting-legacy-V_ZdRjiy.js","./config-legacy-B3SYjuZx.js","./validatorRules-legacy-CitKbB1g.js","./router-legacy-s4T0V6vG.js","./intl-legacy-B7uNycgM.js","./eCache-legacy-CW-H9Ud9.js","./redux-legacy-D5ZHjMNV.js","./toolkit-legacy-uWyLsHZ1.js","../index-legacy.BB7DfOW7.js","./global-legacy-B1EgakWG.js","./muiIcon-legacy-D-EcFXKh.js","./dateFns-legacy-C2RUCIEF.js","./dropzone-legacy-CIQbZZBD.js"],(function(e,a){"use strict";var t,o,n,l,s,i,r,m,d,c,u,f,p,g,y,b,w,h,F,S,_,j,x,N,v,M,I,E,C,P;return{setters:[e=>{t=e.j,o=e.B},e=>{n=e.r},e=>{l=e.u},e=>{s=e.u},e=>{i=e.t},e=>{r=e.j,m=e.C,d=e.a,c=e.ac,u=e.a8,f=e.ad,p=e.k,g=e.u,y=e.t,b=e.ae,w=e.af,h=e.X,F=e.ag},e=>{S=e.B},null,null,e=>{_=e.c,j=e.a},e=>{x=e.g,N=e.a,v=e.u,M=e.b},e=>{I=e.d,E=e.g},e=>{C=e.v},e=>{P=e.u},null,null,null,null,null,null,null,null,null],execute:function(){e("default",(function(){const{isBCUser:e,companyId:C,customer:k,validateEmailValue:q,emailValidation:O,passwordValidation:z}=function(){const e=g(y),a=g((({company:e})=>e.companyInfo.id)),t=g((({company:e})=>e.customer)),o=g((({company:e})=>e.customer.role)),n=g((({b2bFeatures:e})=>e.masqueradeCompany.id)),l=g((({b2bFeatures:e})=>e.masqueradeCompany.isAgenting)),s=Number(3===o&&l?n:a),r=!e||3===o&&!l,m=async e=>{if(t.emailAddress===i(e))return!0;const a={email:e,channelId:F},{isValid:o}=r?await _(a):await j(a);return o},d=e=>!(e.email!==t.emailAddress&&!e.currentPassword),c=e=>e.password===e.confirmPassword;return{isBCUser:r,companyId:s,customer:t,validateEmailValue:m,emailValidation:d,passwordValidation:c}}(),{control:A,handleSubmit:U,getValues:J,formState:{errors:H},setValue:X,setError:Z}=l({mode:"onSubmit"}),[$,D]=r("sf-isFinishUpdate",!1,sessionStorage),{state:{portalStyle:{backgroundColor:G="#FEF9F5"}}}=n.useContext(m),K=s(),[Q]=d(),W=P(),[Y,ee]=n.useState([]),[ae,te]=n.useState([]),[oe,ne]=n.useState([]),[le,se]=n.useState(!1),[ie,re]=n.useState({}),[me,de]=n.useState(!1);n.useEffect((()=>{(async()=>{try{se(!0);const t=e?x:N,o=e?{}:{companyId:C},n=e?"customerAccountSettings":"accountSettings",l=await b(e?1:2),s=E(l.accountFormFields||[]),i=(s?.contactInformation||[]).filter((e=>"field_email_marketing_newsletter"!==e.fieldId)),{additionalInformation:r=[]}=s,{[n]:m}=await t(o),d=e?T(m,i,r):L(m,i,a(),r),c=V(),u=[...d,...c],f=u.find((e=>"role"===e.name));f?.fieldType&&(f.fieldType="text"),ee(u),re(m),te(i),ne(r)}finally{$&&(w.success(K("accountSettings.notification.detailsUpdated")),D(!1)),se(!1),de(!0)}})()}),[]);const ce=n.useMemo((()=>{const e={field_first_name:K("accountSettings.form.firstName"),field_last_name:K("accountSettings.form.lastName"),field_email:K("accountSettings.form.email"),field_phone_number:K("accountSettings.form.phoneNumber"),field_company:K("accountSettings.form.company"),field_role:K("accountSettings.form.role"),field_current_password:K("accountSettings.form.currentPassword"),field_password:K("accountSettings.form.password"),field_confirm_password:K("accountSettings.form.confirmPassword")};return Y.map((a=>({...a,label:e[a.fieldId??""]??a.label})))}),[Y,K]);return t.jsx(c,{isSpinning:le,background:G,children:t.jsxs(o,{sx:{width:Q?"100%":"35%",minHeight:Q?"800px":"300px","& input, & .MuiFormControl-root .MuiTextField-root, & .MuiSelect-select.MuiSelect-filled, & .MuiTextField-root .MuiInputBase-multiline":{bgcolor:u("#FFFFFF",.87),borderRadius:"4px",borderBottomLeftRadius:"0",borderBottomRightRadius:"0"},"& .MuiButtonBase-root.MuiCheckbox-root:not(.Mui-checked), & .MuiRadio-root:not(.Mui-checked)":{color:u(p(G),.6)},"& .MuiTypography-root.MuiTypography-body1.MuiFormControlLabel-label, & .MuiFormControl-root .MuiFormLabel-root:not(.Mui-focused)":{color:u(p(G),.87)},"& .MuiInputLabel-root.MuiInputLabel-formControl:not(.Mui-focused)":{color:u(p("#FFFFFF"),.6)}},children:[t.jsx(S,{formFields:ce,errors:H,control:A,getValues:J,setValue:X}),t.jsx(f,{sx:{mt:"28px",mb:Q?"20px":"0",width:"100%",visibility:me?"visible":"hidden"},onClick:()=>{U((async a=>{se(!0);try{const t=await q(a.email);t||Z("email",{type:"custom",message:K("accountSettings.notification.emailExists")});const o=O(a);o||w.error(K("accountSettings.notification.updateEmailPassword"));const n=z(a);if(n||(Z("confirmPassword",{type:"manual",message:K("global.registerComplete.passwordMatchPrompt")}),Z("password",{type:"manual",message:K("global.registerComplete.passwordMatchPrompt")})),t&&o&&n){const t=(e?R:B)(a,ie,ae,oe);if(t&&(e||(t.companyId=C,t.extraFields=((e,a)=>a.filter((e=>e.custom&&1===e.groupId)).map((a=>({fieldName:I(a?.name||""),fieldValue:e[a.name]}))))(a,Y)),""===t.newPassword&&""===t.confirmPassword&&(delete t.newPassword,delete t.confirmPassword)),!t)return void w.success(K("accountSettings.notification.noEdits"));const o=e?v:M;await o(t),a.password&&a.currentPassword||k.emailAddress!==i(a.email)?W("/login?loginFlag=loggedOutLogin"):(h.clear(),D(!0),window.location.reload())}}finally{se(!1)}}))()},variant:"contained",children:K("accountSettings.button.saveUpdates")})]})})}));const a=()=>[{name:"company",fieldId:"field_company",label:"Company",required:!1,default:"",fieldType:"text",xs:12,variant:"filled",size:"small"},{name:"role",fieldId:"field_role",label:"Role",required:!1,default:"",fieldType:"text",xs:12,variant:"filled",size:"small"}],V=()=>[{name:"currentPassword",fieldId:"field_current_password",label:"Current Password",required:!1,default:"",fieldType:"password",xs:12,variant:"filled",size:"small"},{name:"password",fieldId:"field_password",label:"Password",required:!1,default:"",fieldType:"password",xs:12,variant:"filled",size:"small"},{name:"confirmPassword",fieldId:"field_confirm_password",label:"Confirm Password",required:!1,default:"",fieldType:"password",xs:12,variant:"filled",size:"small"}],k=C(["email"]),L=(e,a,t,o)=>{const n=e?.extraFields||[];return a.forEach((a=>{const t=a;"first_name"===I(a?.name||"")&&(t.default=e.firstName),"last_name"===I(a?.name||"")&&(t.default=e.lastName),"phone"===I(a?.name||"")&&(t.default=e.phoneNumber),"email"===I(a?.name||"")&&(t.default=e.email,t.validate=k)})),n.length>0&&n.forEach((e=>{const t=e,o=a.find((e=>I(e?.name||"")===t.fieldName));o&&(o.default=t.fieldValue)})),t.forEach((a=>{const t=a;"role"===a.name?(t.default=e.companyRoleName,t.disabled=!0):"company"===a.name&&(t.default=e.company,t.disabled=!0)})),o.forEach((a=>{const t=(e?.formFields||[]).find((e=>e.name===a.bcLabel));t&&(a.default=t.value)})),[...a,...t,...o]},T=(e,a,t)=>(a.forEach((a=>{const t=a;"first_name"===I(a?.name||"")&&(t.default=e.firstName),"last_name"===I(a?.name||"")&&(t.default=e.lastName),"phone"===I(a?.name||"")&&(t.default=e.phoneNumber),"email"===I(a?.name||"")&&(t.default=e.email,t.validate=k),"company"===I(a?.name||"")&&(t.default=e.company)})),t.forEach((a=>{const t=(e?.formFields||[]).find((e=>e.name===a.bcLabel));t&&(a.default=t.value)})),[...a,...t]),B=(e,a,t,o)=>{const n=a?.extraFields||[],l={formFields:[]};let s=!0,i=!0,r=!1;if(Object.keys(e).forEach((m=>{t.forEach((t=>{if(m===t.name&&(i=!1,"first_name"===I(t.name)&&(a.firstName!==e[t.name]&&(s=!1),l.firstName=e[t.name]),"last_name"===I(t.name)&&(a.lastName!==e[t.name]&&(s=!1),l.lastName=e[t.name]),"phone"===I(t.name)&&(a.phoneNumber!==e[t.name]&&(s=!1),l.phoneNumber=e[t.name]),"email"===I(t.name)&&(a.email!==e[t.name]&&(s=!1),l.email=e[t.name]),t.custom)){const a=n.find((e=>e.fieldName===I(t?.name||"")));a?.fieldValue!==e[t.name]&&(r=!0)}})),r&&(s=!1),i&&o.forEach((t=>{if(t.fieldId===m&&l?.formFields){const{name:o}=t;l.formFields.push({name:t?.bcLabel||"",value:e[m]}),i=!1;const n=(a?.formFields||[]).find((e=>e.name===t.bcLabel));n&&JSON.stringify(n.value)!==JSON.stringify(e[m])&&(s=!1),!a?.formFields?.length&&o&&e[o]&&(s=!1)}})),i&&("password"===m?(l.newPassword=e[m],e[m]&&(s=!1)):l[m]=e[m]),i=!0})),delete l.company,delete l.role,!s)return l},R=(e,a,t,o)=>{const n={formFields:[]};let l=!0,s=!0;if(Object.keys(e).forEach((i=>{t.forEach((t=>{i===t.name&&(s=!1,"first_name"===I(t.name)&&(a.firstName!==e[t.name]&&(l=!1),n.firstName=e[t.name]),"last_name"===I(t.name)&&(a.lastName!==e[t.name]&&(l=!1),n.lastName=e[t.name]),"phone"===I(t.name)&&(a.phoneNumber!==e[t.name]&&(l=!1),n.phoneNumber=e[t.name]),"email"===I(t.name)&&(a.email!==e[t.name]&&(l=!1),n.email=e[t.name]),"company"===I(t.name)&&(a.company!==e[t.name]&&(l=!1),n.company=e[t.name]))})),s&&o.forEach((t=>{if(t.fieldId===i&&n?.formFields){n.formFields.push({name:t?.bcLabel||"",value:e[i]}),s=!1;const o=(a?.formFields||[]).find((e=>e.name===t.bcLabel));o&&JSON.stringify(o.value)!==JSON.stringify(e[i])&&(l=!1)}})),s&&("password"===i?(n.newPassword=e[i],e[i]&&(l=!1)):n[i]=e[i]),s=!0})),!l)return n}}}}));
//# sourceMappingURL=index-legacy-HYdrruty.js.map
