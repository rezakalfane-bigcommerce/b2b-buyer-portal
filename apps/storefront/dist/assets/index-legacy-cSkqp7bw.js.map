{"version":3,"file":"index-legacy-cSkqp7bw.js","sources":["../../src/pages/InvoicePayment/index.tsx"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { useB3Lang } from '@b3/lang';\nimport { Box } from '@mui/material';\n\nimport { Loading } from '@/components';\nimport B3Dialog from '@/components/B3Dialog';\nimport { getInvoiceDetail } from '@/shared/service/b2b';\nimport { useAppSelector } from '@/store';\nimport { snackbar } from '@/utils';\n\nimport { gotoInvoiceCheckoutUrl } from '../Invoice/utils/payment';\n\nfunction Payment() {\n  const platform = useAppSelector(({ global }) => global.storeInfo.platform);\n  const B2BToken = useAppSelector(({ company }) => company.tokens.B2BToken);\n\n  const [loading, setLoading] = useState<boolean>(false);\n\n  const [open, setOpen] = useState<boolean>(false);\n\n  const params = useParams();\n\n  const navigate = useNavigate();\n\n  const b3Lang = useB3Lang();\n\n  useEffect(() => {\n    const init = async () => {\n      setLoading(true);\n\n      if (!B2BToken) {\n        setOpen(true);\n        setLoading(false);\n        return;\n      }\n\n      if (!params?.id) {\n        snackbar.error(b3Lang('payment.errorInvoiceCantBeBlank'));\n      }\n\n      if (params?.id) {\n        try {\n          const {\n            invoice: {\n              openBalance: { code = '', value = '' },\n            },\n          } = await getInvoiceDetail(Number(params.id));\n\n          if (!code || !value) {\n            snackbar.error(b3Lang('payment.errorOpenBalanceIsIncorrect'));\n          }\n\n          const data = {\n            lineItems: [\n              {\n                invoiceId: Number(params.id),\n                amount: value,\n              },\n            ],\n            currency: code,\n          };\n\n          await gotoInvoiceCheckoutUrl(data, platform, true);\n        } catch (error: unknown) {\n          snackbar.error(\n            (error as CustomFieldItems)?.message || b3Lang('payment.invoiceDoesNotExist'),\n          );\n        } finally {\n          setLoading(false);\n        }\n      }\n    };\n\n    init();\n    // disabling b3Lang due to rendering issues within b3Lang\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [platform, params.id]);\n\n  const handleConfirm = () => {\n    navigate('/login');\n  };\n\n  return (\n    <Box>\n      {loading && <Loading backColor=\"#FFFFFF\" />}\n      <B3Dialog\n        isOpen={open}\n        fullWidth\n        title=\"\"\n        rightSizeBtn=\"ok\"\n        showLeftBtn={false}\n        handRightClick={handleConfirm}\n      >\n        <Box\n          sx={{\n            height: '200px',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            flexDirection: 'column',\n          }}\n        >\n          <Box>\n            <Box\n              sx={{\n                mb: '10px',\n              }}\n            >\n              {b3Lang('payment.firstLoginToPay')}\n            </Box>\n            <Box>{b3Lang('payment.clickToLandingPage')}</Box>\n          </Box>\n        </Box>\n      </B3Dialog>\n    </Box>\n  );\n}\n\nexport default Payment;\n"],"names":["platform","useAppSelector","global","storeInfo","B2BToken","company","tokens","loading","setLoading","useState","open","setOpen","params","useParams","navigate","useNavigate","b3Lang","useB3Lang","useEffect","async","id","snackbar","error","invoice","openBalance","code","value","getInvoiceDetail","Number","data","lineItems","invoiceId","amount","currency","gotoInvoiceCheckoutUrl","message","init","Box","children","jsx","Loading","backColor","B3Dialog","isOpen","fullWidth","title","rightSizeBtn","showLeftBtn","handRightClick","handleConfirm","sx","height","display","alignItems","justifyContent","flexDirection","mb"],"mappings":"m3BAaA,WACQ,MAAAA,EAAWC,GAAe,EAAGC,YAAaA,EAAOC,UAAUH,WAC3DI,EAAWH,GAAe,EAAGI,aAAcA,EAAQC,OAAOF,YAEzDG,EAASC,GAAcC,EAAAA,UAAkB,IAEzCC,EAAMC,GAAWF,EAAAA,UAAkB,GAEpCG,EAASC,IAETC,EAAWC,IAEXC,EAASC,IA0Df,OAxDAC,EAAAA,WAAU,KACKC,WAGX,GAFAX,GAAW,IAENJ,EAGH,OAFAO,GAAQ,QACRH,GAAW,GAQb,GAJKI,GAAQQ,IACFC,EAAAC,MAAMN,EAAO,oCAGpBJ,GAAQQ,GACN,IACI,MACJG,SACEC,aAAaC,KAAEA,EAAO,GAAAC,MAAIA,EAAQ,YAE5BC,EAAiBC,OAAOhB,EAAOQ,KAEpCK,GAASC,GACHL,EAAAC,MAAMN,EAAO,wCAGxB,MAAMa,EAAO,CACXC,UAAW,CACT,CACEC,UAAWH,OAAOhB,EAAOQ,IACzBY,OAAQN,IAGZO,SAAUR,SAGNS,EAAuBL,EAAM7B,GAAU,SACtCsB,GACED,EAAAC,MACNA,GAA4Ba,SAAWnB,EAAO,+BACjD,CACA,QACAR,GAAW,EAAK,CAClB,EAIC4B,EAAA,GAGJ,CAACpC,EAAUY,EAAOQ,YAOlBiB,EACE,CAAAC,SAAA,CAAW/B,GAAAgC,EAAAA,IAACC,EAAQ,CAAAC,UAAU,YAC/BF,EAAAA,IAACG,EAAA,CACCC,OAAQjC,EACRkC,WAAS,EACTC,MAAM,GACNC,aAAa,KACbC,aAAa,EACbC,eAbgBC,KACpBnC,EAAS,SAAQ,EAcbwB,SAAAC,EAAAA,IAACF,EAAA,CACCa,GAAI,CACFC,OAAQ,QACRC,QAAS,OACTC,WAAY,SACZC,eAAgB,SAChBC,cAAe,UAGjBjB,gBAACD,EACC,CAAAC,SAAA,CAAAC,EAAAA,IAACF,EAAA,CACCa,GAAI,CACFM,GAAI,QAGLlB,WAAO,6BAETC,EAAAA,IAAAF,EAAA,CAAKC,SAAOtB,EAAA,yCAMzB"}