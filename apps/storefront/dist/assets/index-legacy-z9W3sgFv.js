System.register(["./mui-legacy-nJi-LPwx.js","./reactVendor-legacy-CtYIj4Ma.js","./router-legacy-s4T0V6vG.js","./useB2BCallback-legacy-BNykb3hy.js","./lang-legacy-1f-gtWXv.js","./B3Card-legacy-Bh2X3ddZ.js","./react-setup-legacy-DuBzGPOI.js","./base-legacy-D2P4nFX7.js","./load-functions-legacy-Cd9k4nWw.js","./b3Login-legacy-D_6Vhl-R.js","./login-legacy-DtKWtQeV.js","./config-legacy-U0EmomC_.js","./form-legacy-CAo5v63e.js","./B3CustomForm-legacy-CZbiJ61c.js","./styled-legacy-BL-c24Os.js","./intl-legacy-B7uNycgM.js","./eCache-legacy-CW-H9Ud9.js","./redux-legacy-D5ZHjMNV.js","./toolkit-legacy-uWyLsHZ1.js","./lodashEs-legacy-5FC1NR51.js","../index-legacy.CUzweyJF.js","./global-legacy-B1EgakWG.js","./muiIcon-legacy-CbXEHT38.js","./dateFns-legacy-Bs-ooDPO.js","./dropzone-legacy-C0uLCPXC.js","./validatorRules-legacy-CEy9rryY.js"],(function(e,t){"use strict";var n,o,a,s,r,i,l,c,d,g,u,x,m,p,y,f,h,j,b,w,T,C,B,F,k,H,I,v,S,A,L,P,R,E,D,_,q,O,V,U,z,N,M,W,G,J,K,Z,Q,X,Y,$,ee,te,ne,oe,ae;return{setters:[e=>{n=e.j,o=e.B,a=e.z,s=e.T,r=e.d,i=e.a0,l=e.a1,c=e.a6},e=>{d=e.r},e=>{g=e.u,u=e.d,x=e.L},e=>{m=e.d},e=>{p=e.u},e=>{y=e.B},e=>{f=e.u,h=e.aC,j=e.a5,b=e.aD,w=e.aA,T=e.n,C=e.aE,B=e.k,F=e.a,k=e.I,H=e.i,I=e.o,v=e.aF,S=e.G,A=e.C,L=e.af,P=e.ac,R=e.aG,E=e.e,D=e.ag,_=e.aH,q=e.J,O=e.aI,V=e.K,U=e.aJ,z=e.aj,N=e.P,M=e.aK,W=e.aL},e=>{G=e.b},null,e=>{J=e.l},e=>{K=e.b,Z=e.a,Q=e.c},e=>{X=e.a,Y=e.i,$=e.l,ee=e.b},e=>{te=e.u},e=>{ne=e.B},e=>{oe=e.a,ae=e.L},null,null,null,null,null,null,null,null,null,null,null],execute:function(){function t(e){const{html:t,sx:a}=e;return n.jsx(o,{sx:{...a},dangerouslySetInnerHTML:{__html:t}})}e("default",(function(e){return"catalyst"===v?n.jsx(le,{}):n.jsx(ue,{...e})}));const se=()=>K().then((e=>{if("success"!==e.data.logout.result)throw new Error("Failed to logout")})),re=()=>{const e=f((({b2bFeatures:e})=>e.masqueradeCompany.isAgenting)),t=f((({b2bFeatures:e})=>e.masqueradeCompany.id));return d.useCallback((async()=>{e&&T(Number(t))}),[e,t])},ie=()=>{const{selectCompanyHierarchyId:e}=f((({company:e})=>e.companyHierarchyInfo));return d.useCallback((async()=>{e&&await C()}),[e])};function le(){const e=g(),t=re(),o=ie(),a=f(h),s=f((({company:e})=>e.tokens.B2BToken)),[r]=u(),i=r.get("loginFlag");return d.useEffect((()=>{const e=setTimeout((()=>{window.location.href="/login"}),3e3);return()=>{clearTimeout(e)}}),[s]),d.useEffect((()=>{"loggedOutLogin"!==i&&s?a&&e("/orders"):Promise.all([se(),t(),o()]).catch((()=>{e("/orders")})).then((()=>{window.sessionStorage.clear(),j.dispatch(b()),window.b2b.callbacks.dispatchEvent("on-logout")}))}),[o,t,a,i,e,s]),n.jsx(w,{})}function ce(e){const{loginBtn:t,handleLoginSubmit:l,backgroundColor:c}=e,d=p(),g=a(),{control:u,handleSubmit:m,getValues:y,formState:{errors:f},setValue:h}=te({mode:"onSubmit"}),j=e=>{l(e)},b=X(d,m(j));return n.jsxs(o,{sx:{display:"flex",flexDirection:"column"},children:[n.jsx(s,{variant:"h5",sx:{margin:"20px 0",display:"flex",justifyContent:"center",alignItems:"center"},children:d("login.loginText.signInHeader")}),n.jsx(o,{sx:{width:"100%","& input":{bgcolor:"#F5F5F5",borderRadius:"4px",borderBottomLeftRadius:"0",borderBottomRightRadius:"0"}},children:n.jsxs("form",{onSubmit:m(j),children:[n.jsx(ne,{formFields:b,errors:f,control:u,getValues:y,setValue:h}),n.jsxs(o,{sx:{display:"flex",justifyContent:"flex-start ",alignItems:"center",mt:2,gap:2},children:[n.jsx(r,{type:"submit",variant:"contained",sx:{backgroundColor:g.palette.primary.main},children:t}),n.jsx(i,{component:x,color:B(c),to:"/forgotPassword",children:d("login.loginText.forgotPasswordText")})]})]})})]})}function de(e){const{widgetBodyText:s,createAccountButtonText:i}=e,l=a(),[c]=F();return n.jsxs(o,{sx:{padding:c?"16px":"20px",borderRadius:"4px",mt:c?"0":"-25px"},children:[n.jsx(t,{sx:{minHeight:"250px","& .panel":{".panel-title":{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",fontWeight:400,fontSize:"24px"}}},html:s}),n.jsx(o,{sx:{marginTop:"5px"},children:n.jsx(r,{component:x,to:"/register",variant:"contained",sx:{ml:c?0:1,backgroundColor:l.palette.primary.main},children:i})})]})}const ge=()=>{const e=(()=>{const e=f((({b2bFeatures:e})=>e.masqueradeCompany.isAgenting)),t=f((({b2bFeatures:e})=>e.masqueradeCompany.id)),n=H();return d.useCallback((async()=>{e&&(await T(Number(t)),n(I()))}),[t,n,e])})(),t=(()=>{const{selectCompanyHierarchyId:e}=f((({company:e})=>e.companyHierarchyInfo));return d.useCallback((async()=>{e&&await C()}),[e])})();return async()=>{try{const{result:n}=(await K()).data.logout;if("success"!==n)return;await Promise.all([t(),e()])}catch(n){G.error(n)}finally{window.sessionStorage.clear(),k(),m("on-logout")}}};function ue(e){const{setOpenPage:a}=e,s=H(),r=ge(),i=f(h),x=f((({quoteInfo:e})=>e.quoteDetailToCheckoutUrl)),[j,b]=d.useState(!0),[w]=F(),[T,C]=d.useState(!0),[B,k]=d.useState(),[I,v]=d.useState({emailAddress:"",password:""}),K=g(),X=p(),[te,ne]=u(),{state:{isCheckout:se,logo:re,registerEnabled:ie}}=d.useContext(S),{state:{loginPageButton:le,loginPageDisplay:ue,loginPageHtml:xe,portalStyle:{backgroundColor:me="FEF9F5"}}}=d.useContext(A),{createAccountButtonText:pe,primaryButtonColor:ye,signInButtonText:fe}=le,{displayStoreLogo:he,pageTitle:je}=ue,{bottomHtmlRegionEnabled:be,bottomHtmlRegionHtml:we,createAccountPanelHtml:Te,topHtmlRegionEnabled:Ce,topHtmlRegionHtml:Be}=xe,Fe={loginTitle:je||X("login.button.signIn"),loginBtn:fe||X("login.button.signInUppercase"),createAccountButtonText:pe||X("login.button.createAccount"),btnColor:ye||"",widgetHeadText:Ce?Be:void 0,widgetBodyText:Te||R,widgetFooterText:be?we:void 0,logo:he?re:void 0};d.useEffect((()=>{(async()=>{try{const e=te.get("loginFlag"),t="false"!==te.get("showTip");if(C(t),Y(e)&&k(e),"invoiceErrorTip"===e){const{tip:t}=$[e];L.error(X(t))}"loggedOutLogin"===e&&i&&await r(),b(!1)}finally{b(!1)}})()}),[X,i,r,te]);const ke=async e=>{const t=await W(e);k(t?"resetPassword":"accountIncorrect")},He=ie?"100%":"50%",Ie=ie?"50%":"auto",ve=B&&((e,t="")=>{const{tip:n,alertType:o}=$[e];return{message:X(n,{email:t}),severity:o}})(B,I?.emailAddress);return n.jsx(y,{setOpenPage:a,children:n.jsx(oe,{paddings:w?"0":"20px 20px",children:n.jsx(P,{isSpinning:j,tip:X("global.tips.loading"),background:"transparent",children:n.jsx(o,{sx:{display:"flex",flexDirection:"column",width:"100%",minHeight:"400px",minWidth:"343px"},children:Fe&&n.jsxs(n.Fragment,{children:[B&&T&&n.jsx(o,{sx:{padding:w?0:"0 5%",margin:"30px 0 0 0"},children:ve&&n.jsx(l,{severity:ve.severity,variant:"filled",children:ve.message})}),x&&n.jsx(l,{severity:"error",variant:"filled",children:X("login.loginText.quoteDetailToCheckoutUrl")}),Fe.logo&&n.jsx(o,{sx:{margin:"20px 0",minHeight:"150px"},children:n.jsx(ae,{children:n.jsx(c,{sx:{maxWidth:w?"70%":"250px"},onClick:()=>{window.location.href="/"},children:n.jsx("img",{src:Fe.logo,alt:X("login.registerLogo"),loading:"lazy"})})})}),Fe.widgetHeadText&&n.jsx(t,{sx:{minHeight:"48px",width:ie||w?"100%":"50%"},html:Fe.widgetHeadText}),n.jsx(o,{sx:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},children:n.jsx(o,{sx:{bgcolor:"#FFFFFF",borderRadius:"4px",margin:"20px 0",display:"flex",flexDirection:"column",justifyContent:"center",width:w?"auto":He},children:n.jsxs(o,{sx:{mb:"20px",display:"flex",flexDirection:w?"column":"row",justifyContent:"center",width:w?"auto":"100%"},children:[n.jsx(o,{sx:{width:w?"auto":Ie,paddingRight:w?0:"2%",ml:"16px",mr:w?"16px":"",pb:ie?"":"36px"},children:n.jsx(ce,{loginBtn:Fe.loginBtn,handleLoginSubmit:async e=>{if(b(!0),v(e),ne((e=>(e.delete("loginFlag"),e))),se)try{const t=await ee(e);400===t.status&&"reset_password_before_login"===t.type?k("resetPassword"):"invalid_login"===t.type?k("accountIncorrect"):window.location.href=E}catch(t){G.error(t),await ke(e.emailAddress)}finally{b(!1)}else try{const t={email:e.emailAddress,password:e.password,storeHash:_,channelId:D};if(await(async(e,t)=>{const{errors:n}=await Q({email:e,pass:t});if(n?.[0]){const{message:t}=n[0];if("Reset password"===t)return ke(e),!0}return!1})(e.emailAddress,e.password))return;const{login:{result:{token:n,storefrontLoginToken:o},errors:a}}=await Z({loginData:t});if(s(q(n)),O(o),m("on-login",{storefrontToken:o}),a?.[0]||!n){if(a?.[0]){const{message:e}=a[0];if("Operation cannot be performed as the storefront channel is not live"===e)return k("accountPrelaunch"),void b(!1)}ke(e.emailAddress)}else{const e=await V(n);if(x)return void K(x);if(e?.userType===U.MULTIPLE_B2C&&e?.role===z.SUPER_ADMIN)return void K("/dashboard");if(!J(K))return;e?.userType===U.B2C&&K(N.ORDERS);const t=M(Number(e?.role));K(t)}}catch(t){L.error(X("login.loginTipInfo.accountIncorrect"))}finally{b(!1)}},backgroundColor:me})}),ie&&n.jsx(o,{sx:{flex:"1",paddingLeft:w?0:"2%"},children:n.jsx(de,{createAccountButtonText:Fe.createAccountButtonText,widgetBodyText:Fe.widgetBodyText})})]})})}),Fe.widgetFooterText&&n.jsx(t,{sx:{minHeight:"48px",width:ie||w?"100%":"50%"},html:Fe.widgetFooterText})]})})})})})}}}}));
//# sourceMappingURL=index-legacy-z9W3sgFv.js.map
